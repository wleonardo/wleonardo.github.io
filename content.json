[{"title":"ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰","date":"2018-05-06T10:21:08.000Z","path":"2018/05/06/middleware/","text":"åœ¨æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ï¼Œè¶Šæ¥è¶Šå¤šçœ‹åˆ°äº†ä¸­é—´ä»¶è¿™ä¸ªè¯ï¼Œä¾‹å¦‚Koaï¼Œreduxç­‰ã€‚è¿™é‡Œå°±å¤§æ¦‚è®°å½•ä¸€ä¸‹Koaå’Œreduxä¸­é—´ä»¶çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥ä»ä¸­çœ‹åˆ°ä¸­é—´ä»¶çš„å®ç°æ–¹å¼éƒ½æ˜¯å¤§åŒå°å¼‚ï¼ŒåŸºæœ¬éƒ½æ˜¯å®ç°äº†æ´‹è‘±æ¨¡å‹ã€‚ å¯¹äºä¸­é—´ä»¶æˆ‘ä»¬éœ€è¦äº†è§£çš„æ˜¯ ä¸­é—´ä»¶æ˜¯å¦‚ä½•å­˜å‚¨çš„ ä¸­é—´ä»¶æ˜¯å¦‚ä½•æ‰§è¡Œçš„ Koaä½œä¸ºTJå¤§ç¥çš„ä½œå“ï¼ŒçœŸä¸æ„§æ˜¯å·ç§°åŸºäº Node.js å¹³å°çš„ä¸‹ä¸€ä»£ web å¼€å‘æ¡†æ¶ï¼Œå…¶ä¸­å¯¹äºä¸­é—´ä»¶çš„å®ç°ï¼Œgenerator/yield,è¿˜æ˜¯await/async,å¯¹äºå›è°ƒåœ°ç‹±çš„å¤„ç†ï¼Œéƒ½æ˜¯ç»™åæ¥çš„å¼€å‘è€…å¾ˆå¤§çš„å½±å“ã€‚ Koa 1çš„ä¸­é—´ä»¶å­˜å‚¨123456789101112131415161718192021222324252627282930/** * https://github.com/Koajs/Koa/blob/1.6.0/lib/application.js */ ... var app = Application.prototype; function Application() &#123; if (!(this instanceof Application)) return new Application; this.env = process.env.NODE_ENV || &apos;development&apos;; this.subdomainOffset = 2; this.middleware = []; this.proxy = false; this.context = Object.create(context); this.request = Object.create(request); this.response = Object.create(response);&#125;...app.use = function(fn)&#123; if (!this.experimental) &#123; // es7 async functions are not allowed, // so we have to make sure that `fn` is a generator function assert(fn &amp;&amp; &apos;GeneratorFunction&apos; == fn.constructor.name, &apos;app.use() requires a generator function&apos;); &#125; debug(&apos;use %s&apos;, fn._name || fn.name || &apos;-&apos;); this.middleware.push(fn); return this;&#125;; å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æˆ‘ä»¬é€šè¿‡app.useåŠ å…¥çš„ä¸­é—´ä»¶ï¼Œä¿å­˜åœ¨ä¸€ä¸ªmiddlewareçš„æ•°ç»„ä¸­ã€‚ æ‰§è¡Œ123456789101112131415161718192021222324252627282930/** * https://github.com/Koajs/Koa/blob/1.6.0/lib/application.js */app.listen = function()&#123; debug(&apos;listen&apos;); var server = http.createServer(this.callback()); return server.listen.apply(server, arguments);&#125;;// åˆ é™¤äº†ä¸€äº›è­¦å‘Šä»£ç app.callback = function()&#123; ... var fn = this.experimental ? compose_es7(this.middleware) : co.wrap(compose(this.middleware)); var self = this; ... return function handleRequest(req, res)&#123; var ctx = self.createContext(req, res); self.handleRequest(ctx, fn); &#125;&#125;;app.handleRequest = function(ctx, fnMiddleware)&#123; ctx.res.statusCode = 404; onFinished(ctx.res, ctx.onerror); fnMiddleware.call(ctx).then(function handleResponse() &#123; respond.call(ctx); &#125;).catch(ctx.onerror);&#125;; å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°middlewareæ•°ç»„ç»è¿‡ä¸€äº›å¤„ç†ï¼Œç”Ÿæˆäº†fnï¼Œç„¶åé€šè¿‡fnMiddleware.call(ctx)ä¼ å…¥ctxæ¥å¤„ç†ï¼Œç„¶åå°±å°†ctxä¼ ç»™äº†respond,æ‰€ä»¥è¿™é‡Œçš„fnMiddlewareå°±æ˜¯æˆ‘ä»¬éœ€è¦å»äº†è§£çš„å†…å®¹ã€‚ è¿™é‡Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦æ˜¯this.experimentalæ¥è·å–æ˜¯å¦ä½¿ç”¨äº†async/awaitï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨Koa1ä¸­ä¸åšè¯¦ç»†ä»‹ç»ã€‚æˆ‘ä»¬ä¸»è¦æ˜¯æ¥çœ‹ä¸€ä¸‹co.wrap(compose(this.middleware))ã€‚ è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹compose()12345678910111213141516171819/** * è¿™é‡Œä½¿ç”¨äº†Koa1@1.6.0 package.jsonä¸­çš„Koa-composeçš„ç‰ˆæœ¬ * https://github.com/Koajs/compose/blob/2.3.0/index.js */function compose(middleware)&#123; return function *(next)&#123; if (!next) next = noop(); var i = middleware.length; while (i--) &#123; next = middleware[i].call(this, next); &#125; return yield *next; &#125;&#125;function *noop()&#123;&#125; co.wrap(compose(this.middleware))å°±å˜æˆäº†å¦‚ä¸‹çš„æ ·å­ 1234567891011co.wrap(function *(next)&#123; if (!next) next = noop(); var i = middleware.length; while (i--) &#123; next = middleware[i].call(this, next); &#125; return yield *next;&#125;) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œå¯¹middlewareè¿›è¡Œäº†å€’åºéå†ã€‚next = middleware[i].call(this, next);å¯ä»¥å†™ä¸ºç±»ä¼¼ä¸‹é¢è¿™ä¸ªä»£ç ç»“æ„ 12345678910111213function *middleware1() &#123; ... yield function *next1() &#123; ... yield function *next2() &#123; ... ... ... &#125; ... &#125; ...&#125; ç„¶ånext = middleware[i].call(this, next);å…¶å®æ¯ä¸€ä¸ªnextå°±æ˜¯ä¸€ä¸ªmiddlewareï¼Œæ‰€ä»¥ä¹Ÿå°±å¯ä»¥å˜æˆ12345678910111213function *middleware1() &#123; ... yield function *middleware2() &#123; ... yield function *middleware() &#123; ... ... ... &#125; ... &#125; ...&#125; ç„¶åæˆ‘ä»¬å°±è·å¾—äº†ä¸‹é¢è¿™ä¸ªä»£ç  12345678910111213141516171819co.wrap(function *(next)&#123; next = function *middleware1() &#123; ... yield function *middleware2() &#123; ... yield (function *middleware3() &#123; ... yield function *() &#123; // noop // NO next yield ! &#125; ... &#125; ... &#125; ... &#125; return yield *next;&#125;) è‡³æ­¤æˆ‘ä»¬æ¥çœ‹ä¸€çœ¼æ´‹è‘±æ¨¡å‹, æ˜¯ä¸æ˜¯å’Œæˆ‘ä»¬ä¸Šé¢çš„ä»£ç ç»“æ„å¾ˆæƒ³ã€‚ ç°åœ¨æˆ‘ä»¬æœ‰äº†æ´‹è‘±æ¨¡å‹å¼çš„ä¸­é—´èŠ‚ä»£ç ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰§è¡Œå®ƒã€‚æ¥ä¸‹æ¥å°±æ˜¯co.wrap,è¿™é‡Œæˆ‘ä»¬å°±ä¸è¯¦ç»†è¯´æ˜äº†ï¼Œcoæ¡†æ¶å°±æ˜¯ä¸€ä¸ªé€šè¿‡Promiseæ¥è®©generatorè‡ªæ‰§è¡Œçš„æ¡†æ¶ï¼Œå®ç°äº†ç±»ä¼¼async/awaitçš„åŠŸèƒ½ï¼ˆå…¶å®åº”è¯¥è¯´async/awaitçš„å®ç°æ–¹å¼å°±æ˜¯Promiseå’Œgeneratorï¼‰ã€‚ è¿™é‡Œæä¸€ä¸ªæœ€åyield *nextï¼Œæ˜¯\bè®©codeå¯ä»¥å°‘æ‰§è¡Œä¸€äº›ï¼Œå› ä¸ºå¦‚æœä½¿ç”¨yield nextï¼Œä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç„¶åcoæ¥æ‰§è¡Œè¿™ä¸ªè¿­ä»£å™¨ï¼Œè€Œyield *åˆ™æ˜¯ç›¸å½“äºå°†generatoré‡Œé¢çš„å†…å®¹å†™åœ¨å½“å‰å‡½æ•°ä¸­ï¼Œè¯¦ç»†å¯ä»¥è§yield* \bå…³äºKoa1å¯ä»¥çœ‹æˆ‘çš„æ—©ä¸€äº›å†™çš„å¦ä¸€ç¯‡Koaä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰å®ç°æ¢ç´¢ Koa 2çš„ä¸­é—´ä»¶å­˜å‚¨123456789101112131415161718192021222324252627282930/** * https://github.com/Koajs/Koa/blob/1.6.0/lib/application.js */ ... constructor() &#123; super(); this.proxy = false; this.middleware = []; this.subdomainOffset = 2; this.env = process.env.NODE_ENV || &apos;development&apos;; this.context = Object.create(context); this.request = Object.create(request); this.response = Object.create(response); &#125;... use(fn) &#123; if (typeof fn !== &apos;function&apos;) throw new TypeError(&apos;middleware must be a function!&apos;); if (isGeneratorFunction(fn)) &#123; deprecate(&apos;Support for generators will be removed in v3. &apos; + &apos;See the documentation for examples of how to convert old middleware &apos; + &apos;https://github.com/Koajs/Koa/blob/master/docs/migration.md&apos;); fn = convert(fn); &#125; debug(&apos;use %s&apos;, fn._name || fn.name || &apos;-&apos;); this.middleware.push(fn); return this; &#125; Koa2å¯¹äºmiddlewareçš„\bå­˜å‚¨å’ŒKoa1åŸºæœ¬ä¸€æ¨¡ä¸€æ ·ï¼Œ\bä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ æ‰§è¡Œ1234567891011121314151617181920212223242526callback() &#123; const fn = compose(this.middleware); if (!this.listeners(&apos;error&apos;).length) this.on(&apos;error&apos;, this.onerror); const handleRequest = (req, res) =&gt; &#123; const ctx = this.createContext(req, res); return this.handleRequest(ctx, fn); &#125;; return handleRequest; &#125; /** * Handle request in callback. * * @api private */ handleRequest(ctx, fnMiddleware) &#123; const res = ctx.res; res.statusCode = 404; const onerror = err =&gt; ctx.onerror(err); const handleResponse = () =&gt; respond(ctx); onFinished(res, onerror); return fnMiddleware(ctx).then(handleResponse).catch(onerror); è¿™é‡Œä¸»è¦å°±æ˜¯ä¸¤è¡Œä»£ç \u001c123const fn = compose(this.middleware);// fnMiddleware === fnfnMiddleware(ctx).then(handleResponse).catch(onerror); Koa2çš„ä»£ç ä¼¼ä¹æ¯”Koa1è¦ç®€ä»‹ä¸€äº›äº†ï¼Œ\båœ¨é»˜è®¤ä½¿ç”¨await/asyncä¹‹åï¼Œ\bå°‘äº†coçš„ä½¿ç”¨ã€‚ ä»fnMiddleware(ctx).then(handleResponse).catch(onerror);æˆ‘ä»¬å¯ä»¥çŸ¥é“fnMiddlewareè¿”å›äº†ä¸€ä¸ªPromise,ç„¶åæ‰§è¡Œäº†è¿™ä¸ªPromiseï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸»è¦çŸ¥é“\bcomposeåšäº†ä»€ä¹ˆå°±å¥½ã€‚ 12345678910111213141516171819202122232425/** * https://github.com/Koajs/compose/blob/4.0.0/index.js */function compose (middleware) &#123; ... return function (context, next) &#123; // last called middleware # let index = -1 return dispatch(0) function dispatch (i) &#123; if (i &lt;= index) return Promise.reject(new Error(&apos;next() called multiple times&apos;)) index = i let fn = middleware[i] if (i === middleware.length) fn = next if (!fn) return Promise.resolve() try &#123; return Promise.resolve(fn(context, function next () &#123; return dispatch(i + 1) &#125;)) &#125; catch (err) &#123; return Promise.reject(err) &#125; &#125; &#125;&#125; çœ‹èµ·æ¥è¿™æ®µä»£ç æ¯”Koa1çš„composeç¨å¾®å¤æ‚äº†äº›ï¼Œå…¶å®å·®ä¸å¤šï¼Œ\bä¸»è¦çš„ä»£ç \bå…¶å®ä¹Ÿå°±ä¸¤ä¸ª 12345678910111213function compose (middleware) &#123; ... return function (context, next) &#123; let index = -1 return dispatch(0) function dispatch (i) &#123; let fn = middleware[i] return Promise.resolve(fn(context, function next () &#123; return dispatch(i + 1) &#125;)) &#125; &#125;&#125; ç›¸æ¯”äºKoa1éå†middlewareæ•°ç»„ï¼ŒKoa2æ”¹ä¸ºäº†é€’å½’ã€‚åŒä¸Šé¢ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•°\bå†™ä¸ºå¦‚ä¸‹ç»“æ„ 1234567891011async function middleware1() &#123; ... await (async function middleware2() &#123; ... await (async function middleware3() &#123; ... &#125;); ... &#125;); ...&#125; å› ä¸ºasyncå‡½æ•°çš„è‡ªæ‰§è¡Œï¼Œæ‰€ä»¥ç›´æ¥è¿è¡Œè¯¥å‡½æ•°å°±å¯ä»¥äº†ã€‚ å¯ä»¥çœ‹åˆ°Koa1\u001cä¸Koa2çš„ä¸­é—´ä»¶çš„å®ç°æ–¹å¼åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸€ä¸ªæ˜¯åŸºäºgenerator/yieldï¼Œ ä¸€ä¸ªæ˜¯åŸºäºasync/awaitã€‚ Reduxç›¸æ¯”äºKoaçš„ä¸­é—´ä»¶çš„å…·ä½“å®ç°ï¼ŒReduxç›¸å¯¹ç¨å¤æ‚ä¸€äº›ã€‚ æœ¬äººå¯¹äºReduxåŸºæœ¬æ²¡æœ‰ä½¿ç”¨ï¼Œåªæ˜¯å†™è¿‡ä¸€äº›ç®€å•çš„demoï¼Œçœ‹è¿‡ä¸€éƒ¨åˆ†çš„æºç ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¯·æŒ‡æ­£ å­˜å‚¨æˆ‘ä»¬åœ¨ä½¿ç”¨Reduxçš„æ—¶å€™å¯èƒ½ä¼šè¿™ä¹ˆå†™12345678910111213141516// å¥½é«˜é˜¶çš„å‡½æ•°å•Šconst logger = store =&gt; next =&gt; action =&gt; &#123; console.group(action.type) console.info(&apos;dispatching&apos;, action) let result = next(action) console.log(&apos;next state&apos;, store.getState()) console.groupEnd(action.type) return result&#125;let store = createStore( todoApp, applyMiddleware( logger )) æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰¾åˆ°applyMiddlewareçš„æºç ã€‚ 1234567891011121314151617181920212223export default function applyMiddleware(...middlewares) &#123; return createStore =&gt; (...args) =&gt; &#123; const store = createStore(...args) let dispatch = () =&gt; &#123; throw new Error( `Dispatching while constructing your middleware is not allowed. ` + `Other middleware would not be applied to this dispatch.` ) &#125; const middlewareAPI = &#123; getState: store.getState, dispatch: (...args) =&gt; dispatch(...args) &#125; const chain = middlewares.map(middleware =&gt; middleware(middlewareAPI)) dispatch = compose(...chain)(store.dispatch) return &#123; ...store, dispatch &#125; &#125;&#125; Reduxæ²¡æœ‰å•ç‹¬ä¿å­˜middlewareçš„åœ°æ–¹ï¼Œä½†æ˜¯é€šè¿‡å±•å¼€ç¬¦çš„...middlewaresï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“è‡³å°‘ä¸€å¼€å§‹çš„middlewaresæ˜¯ä¸€ä¸ªæ•°ç»„çš„å½¢å¼ã€‚ æ‰§è¡Œæ‰§è¡Œçš„ä»£ç ï¼Œè¿˜æ˜¯ä¸Šé¢é‚£æ®µä»£ç ç‰‡æ®µã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°applyMiddleware()ä¸­ï¼Œå¯¹ä¼ å…¥çš„middlewaresåšäº†ç®€å•çš„å°è£…ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æ¯ä¸ªmiddlewareåœ¨æ‰§è¡Œçš„æ—¶å€™å¯ä»¥æ‹¿åˆ°å½“å‰çš„ä¸€äº›ç¯å¢ƒå’Œä¸€äº›å¿…è¦çš„æ¥å£å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯ä¸Šé¢é‚£ä¸ªé«˜é˜¶å‡½æ•°loggeræ‰€éœ€è¦çš„ä¸‰ä¸ªå‚æ•°store,next,actionã€‚ ä¸€å¼€å§‹æ˜¯middlewares.map(middleware =&gt; middleware(middlewareAPI))ï¼Œè€ŒmiddlewareAPIä¼ å…¥äº†getStateå’Œdispatchæ¥å£ï¼ˆdispatchæ¥å£æš‚æ—¶æ²¡æœ‰ç”¨ï¼‰ã€‚è¿™ä¸€æ­¥å°±å®ç°äº†ä¸Šé¢é«˜é˜¶å‡½æ•°loggeræ‰€éœ€è¦çš„å‚æ•°storeã€‚ ç„¶åæ˜¯æˆ‘ä»¬çœ‹åˆ°å¥½å¤šæ¬¡çš„composeå‡½æ•°ï¼Œæˆ‘ä»¬æ‰¾åˆ°composeå‡½æ•°çš„å®ç°ã€‚ 1234567891011export default function compose(...funcs) &#123; if (funcs.length === 0) &#123; return arg =&gt; arg &#125; if (funcs.length === 1) &#123; return funcs[0] &#125; return funcs.reduce((a, b) =&gt; (...args) =&gt; a(b(...args)))&#125; æˆ‘ä»¬çœ‹åˆ°composeå¯¹ä¼ å…¥çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œé€šè¿‡Array.reduceå‡½æ•°å¤„ç†äº†ä¸€ä¸‹ã€‚æœ€ç»ˆçš„å‡½æ•°åº”è¯¥å¤§æ¦‚ç±»ä¼¼ä¸‹é¢è¿™ä¸ªæ ¼å¼ 12345678910// åŠ å…¥å‡½æ•°ånextæ–¹ä¾¿åé¢ç†è§£function chain(...args) &#123; return () =&gt; &#123; return a(function next(...args) &#123; return b(function next(...args) &#123; return c(...args); &#125;) &#125;) &#125;&#125; è¿™é‡Œå·²ç»å†æ¬¡å‡ºç°äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„æ´‹è‘±æ¨¡å‹ã€‚åŒæ—¶å°†ä¸‹ä¸€ä¸ªç»„ä»¶å·²å‚æ•°ï¼ˆnextï¼‰çš„å½¢å¼ä¼ å…¥å½“å‰çš„ä¸­é—´ä»¶ï¼Œè¿™é‡Œå°±å®Œæˆäº†ä¸Šé¢çš„é«˜é˜¶å‡½æ•°loggeræ‰€éœ€è¦çš„ç¬¬äºŒä¸ªå‚æ•°next,åœ¨ä¸­é—´ä»¶å†…éƒ¨è°ƒç”¨nextå‡½æ•°å°±å¯ä»¥ç»§ç»­ä¸­é—´èŠ‚çš„æµç¨‹ã€‚ æœ€åä¼ å…¥äº†store.dispatchä¹Ÿå°±æ˜¯é«˜é˜¶å‡½æ•°loggeræ‰€éœ€è¦çš„ç¬¬äºŒä¸ªå‚æ•°actionï¼Œè¿™ä¸ªå°±ä¸ç”¨å¤šæ•°äº†ï¼Œå°±æ˜¯å°†æˆ‘ä»¬åˆšåˆšå¾—åˆ°çš„æ´‹è‘±æ ¼å¼çš„å‡½æ•°è°ƒç”¨ä¸€ä¸‹ï¼Œé€šè¿‡é—­åŒ…ä½¿å¾—æ¯ä¸ªä¸­é—´èŠ‚éƒ½å¯ä»¥æ‹¿åˆ°store.dispatchã€‚ è‡³æ­¤ï¼ŒReduxå’ŒKoaçš„ä¸­é—´ä»¶çš„ä»‹ç»å°±å·®ä¸å¤šäº†ï¼Œä¸¤è€…éƒ½æ˜¯ä»¥æ•°ç»„çš„å½¢å¼ä¿å­˜äº†ä¸­é—´ä»¶ï¼Œæ‰§è¡Œçš„æ—¶å€™éƒ½æ˜¯åˆ›å»ºäº†ä¸€ä¸ªç±»ä¼¼æ´‹è‘±æ¨¡å‹çš„å‡½æ•°ç»“æ„ï¼Œä¹Ÿéƒ½æ˜¯å°†ä¸€ä¸ªåŒ…è£¹ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„å‡½æ•°å½“åšnextï¼Œä¼ å…¥å½“å‰ä¸­é—´ä»¶ï¼Œä½¿å¾—å½“å‰ä¸­é—´ä»¶å¯ä»¥é€šè¿‡è°ƒç”¨nextæ¥æ‰§è¡Œæ´‹è‘±æ¨¡å‹ï¼ŒåŒæ—¶åœ¨nextæ‰§è¡Œçš„å‰åéƒ½å¯ä»¥å†™é€»è¾‘ä»£ç ã€‚ä¸åŒçš„æ˜¯Koa1æ˜¯é€šè¿‡éå†ç”Ÿæˆçš„ï¼ŒKoa2æ˜¯é€šè¿‡é€’å½’æ¥ç”Ÿæˆçš„ï¼Œreduxæ˜¯é€šè¿‡reduceæ¥ç”Ÿæˆçš„ï¼ˆå’ŒKoa1çš„éå†ç±»ä¼¼ï¼‰ã€‚ æ‰€ä»¥ä¸­é—´ä»¶å…¶å®éƒ½åŸºæœ¬ç±»ä¼¼ï¼Œæ‰€ä»¥å¥½å¥½çš„ç†è§£äº†ä¸€ç§ä¸­é—´ä»¶çš„å®ç°æ–¹å¼ï¼Œå…¶ä»–çš„å­¦èµ·æ¥å°±å¾ˆå¿«äº†ï¼ˆåªæ˜¯è¡¨ç¤ºå‰ç«¯è¿™ä¸€å—å“¦ï¼‰ã€‚","tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://wangyuekai.com/tags/å‰ç«¯/"}]},{"title":"dom-handle","date":"2018-04-19T13:10:55.000Z","path":"2018/04/19/dom-handle/","text":"å‰ç«¯å¼€å‘å§‹ç»ˆç»•ä¸è¿‡çš„å°±æ˜¯æ“ä½œDOMï¼Œåœ¨ä»¥å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨Jqueryï¼Œzeptoç­‰åº“æ¥æ“ä½œDOMï¼Œä¹‹ååœ¨vueï¼ŒAngularï¼ŒReactç­‰æ¡†æ¶å‡ºç°åï¼Œæˆ‘ä»¬é€šè¿‡æ“ä½œæ•°æ®æ¥æ§åˆ¶DOMï¼ˆç»å¤§å¤šæ•°æ—¶å€™ï¼‰ï¼Œè¶Šæ¥è¶Šå°‘çš„å»ç›´æ¥æ“ä½œDOMï¼Œæ›´ä¸ç”¨è¯´ç”¨åŸç”Ÿçš„JSæ¥æ“ä½œDOMäº†ã€‚ ä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰æ—¶å€™éƒ½ä¸€å®šè¦å¼•å…¥è¿™äº›åº“ï¼Œå¯¹äºåŸºç¡€çš„JSæ“ä½œDOMçš„ä¸€äº›æ–¹æ³•ï¼Œè¿˜æ˜¯è¦æœ‰äº›äº†è§£çš„ã€‚è¿™é‡Œå°±ç®—æ˜¯å›é¡¾ä¸€ä¸‹JSé‚£äº›ç†Ÿæ‚‰å´ä¹Ÿé™Œç”Ÿçš„DOMæ“ä½œå‡½æ•°ã€‚ æŸ¥è¯¢æŒ‰ç…§IDæŸ¥è¯¢ document.getElementById(id) // å…¼å®¹æœ€å¥½ 123456789101112// demo// HTMl&lt;body&gt; &lt;div id=&quot;main&quot;&gt; &lt;div id=&quot;content&quot;&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;// Scriptconst mainDom = document.getElementById(&apos;main&apos;);const contentDom = document.getElementById(&apos;content&apos;); æŒ‰ç…§classæŸ¥è¯¢ element.getElementsByClassName // ie9+ element.querySelectorAll // ie8 éå† // ie7- 12345678910111213141516// demo// HTMl&lt;body&gt; &lt;div id=&quot;main&quot;&gt; &lt;div id=&quot;content&quot;&gt; &lt;p class=&quot;info test&quot;&gt;info1&lt;/p&gt; &lt;p class=&quot;info&quot;&gt;info2&lt;/p&gt; &lt;p class=&quot;info&quot;&gt;info3&lt;/p&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;// Scriptconst mainDom = document.getElementById(&apos;main&apos;);const infoDomList1 = mainDom.querySelectorAll(&apos;.info.test&apos;);const infoDomList2 = mainDom.getElementsByClassName(&apos;info test&apos;); æŒ‰ç…§TagæŸ¥è¯¢ element.getElementsByTagName // ie6+123456789101112131415// demo// HTMl&lt;body&gt; &lt;div id=&quot;main&quot;&gt; &lt;div id=&quot;content&quot;&gt; &lt;p class=&quot;info test&quot;&gt;info1&lt;/p&gt; &lt;p class=&quot;info&quot;&gt;info2&lt;/p&gt; &lt;p class=&quot;info&quot;&gt;info3&lt;/p&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;// Scriptconst divDom = document.getElementsByTagName(&apos;div&apos;);const pDom = divDom[0].getElementsByTagName(&apos;p&apos;); æŒ‰ç…§å±æ€§æŸ¥è¯¢ element.querySelector //ie8+ element.querySelectorAll() //ie8+ querySelectorè¿”å›è¿”å›çš„æ˜¯å•ä¸ªDOMå…ƒç´ ï¼ŒquerySelectorAllè¿”å›NodeList querySelectorçš„è¯­æ³•å¾ˆç±»ä¼¼jqueryé‡Œé¢çš„é€‰æ‹©å™¨ï¼ŒquerySelectorå’ŒquerySelectorAllçš„ä½¿ç”¨æ–¹æ³•æ˜¯ä¸€æ ·ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¸€äº›è¯´æ³•éƒ½æ˜¯é€‚ç”¨äºä¸¤ä¸ªã€‚123456789101112131415// demo// HTMl&lt;body&gt; &lt;div id=&quot;main&quot;&gt; &lt;div id=&quot;content&quot;&gt; &lt;p class=&quot;info test&quot;&gt;info1&lt;/p&gt; &lt;p class=&quot;info&quot;&gt;info2&lt;/p&gt; &lt;p class=&quot;info&quot;&gt;info3&lt;/p&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;// Scriptconst infoDom = document.querySelectorAll(&apos;.info&apos;);const infoDom2 = document.querySelectorAll(&apos;.info:not(.test)&apos;); querySelectorAll å’Œ querySelector åœ¨å­æŸ¥è¯¢ä¸‹å’Œjqueryä¸æ˜¯ä¸€æ ·çš„ï¼Œè¯¦è§DOMå…ƒç´ querySelectorAllå¯èƒ½è®©ä½ æ„å¤–çš„ç‰¹æ€§è¡¨ç°ç®€å•çš„è¯´å°±æ˜¯document.querySelector(&quot;#my-id&quot;).querySelectorAll(&quot;div div&quot;);ï¼Œç›´æ¥æ„Ÿè§‰æ˜¯æŸ¥è¯¢#my-idçš„å­å…ƒç´ ä¸‹ç¬¦åˆdiv divçš„domï¼Œå…¶å®ä¸æ˜¯ï¼Œè€Œæ˜¯#my-idçš„å­å…ƒç´ ä¸­ï¼ŒåŒæ—¶ä¹Ÿç¬¦åˆåœ¨å…¨å±€èŒƒå›´å†…çš„div divçš„domã€‚ è·å–çˆ¶å…ƒç´  element.parentNode // åŸºæœ¬éƒ½å…¼å®¹ è·å–å­å…ƒç´  element.childNodes // åŸºæœ¬éƒ½å…¼å®¹ element.childNodesä¸æ­¢ä¼šè·å–åˆ°DOMï¼Œä¹Ÿä¼šè·å–åˆ°æ–‡å­—ç­‰ï¼Œåªæœ‰å½“nodeType === 1æ—¶æ‰è¡¨ç¤ºDOMã€‚ è·å–å…„å¼ŸèŠ‚ç‚¹è·å–å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹ element.previousSibling //åŸºæœ¬éƒ½å…¼å®¹ è·å–æ‰€æœ‰å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹å°±æ˜¯éå†previousSibling, ç›´åˆ°nullã€‚ Geckoå†…æ ¸çš„æµè§ˆå™¨ä¼šåœ¨æºä»£ç ä¸­æ ‡ç­¾å†…éƒ¨æœ‰ç©ºç™½ç¬¦çš„åœ°æ–¹æ’å…¥ä¸€ä¸ªæ–‡æœ¬ç»“ç‚¹åˆ°æ–‡æ¡£ä¸­.å› æ­¤,ä½¿ç”¨è¯¸å¦‚ Node.firstChild å’Œ Node.previousSibling ä¹‹ç±»çš„æ–¹æ³•å¯èƒ½ä¼šå¼•ç”¨åˆ°ä¸€ä¸ªç©ºç™½ç¬¦æ–‡æœ¬èŠ‚ç‚¹, è€Œä¸æ˜¯ä½¿ç”¨è€…æ‰€é¢„æœŸå¾—åˆ°çš„èŠ‚ç‚¹. è·å–åé¢çš„å…„å¼ŸèŠ‚ç‚¹ element.nextSibling //åŸºæœ¬éƒ½å…¼å®¹ è·å–æ‰€æœ‰å’Œæ³¨æ„ç‚¹éƒ½å’ŒpreviousSiblingä¸€æ · DOMæ“ä½œåˆ›å»ºDOM document.createElement(tagName) æ–°å¢DOMæ·»åŠ åˆ°èŠ‚ç‚¹çš„\b\bå­èŠ‚ç‚¹çš„æœ€å append paranetElement.appendChild(child); æ·»åŠ åˆ°èŠ‚ç‚¹çš„å‰é¢ paranetElement.insertBefore(newElement, Element) é€šè¿‡insertBeforeæ–¹æ³•å¯ä»¥å°†newElementæ’å…¥åˆ°Elementå‰é¢ï¼Œå¦‚æœElementæ˜¯nullåˆ™\bå°†newElementæ’å…¥åˆ°paranetElementçš„å°¾éƒ¨ã€‚ å¦‚æœnewElementæ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨åœ¨æ–‡æ¡£ä¸­çš„DOM,\b insertBeforeåˆ™ä¼šè¡¨ç°ä¸ºç§»åŠ¨è¯¥DOM(å°†ä¼šä¿ç•™æ‰€æœ‰çš„äº‹ä»¶)ã€‚ æ·»åŠ åˆ°èŠ‚ç‚¹çš„åé¢ æ²¡æœ‰è¿™ä¸ª\bå‡½æ•° ğŸ˜¶å¯ä»¥ä½¿ç”¨ insertBefore æ–¹æ³•å’Œ nextSibling æ¥æ¨¡æ‹Ÿå®ƒã€‚ 1parentDiv.insertBefore(sp1, sp2.nextSibling); å¦‚æœsp2æ²¡æœ‰ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™å®ƒè‚¯å®šæ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™sp2.nextSiblingè¿”å›nullï¼Œä¸”sp1è¢«æ’å…¥åˆ°å­èŠ‚ç‚¹åˆ—è¡¨çš„æœ€åé¢ï¼ˆå³sp2åé¢ï¼‰ è¯¦è§Node.insertBefore() ä¿®æ”¹DOMä¿®æ”¹DOMçš„æ–‡æ¡ˆ Element.innerHTML // è·å–æ ‡ç­¾å†…çš„æ‰€æœ‰å†…å®¹Element.innerText // åªè·å–æ ‡ç­¾å†…çš„æ–‡å­—å†…å®¹ï¼Œä¸åŒ…æ‹¬æ ‡ç­¾ ä¿®æ”¹css element.style.cssAttribute ä¿®æ”¹å±æ€§ element.setAttribute() element.removeAttribute() element.className åˆ é™¤DOM paranetElement.removeChild(element) æ¸…ç©ºå­èŠ‚ç‚¹ æ²¡æœ‰ä¸“é—¨çš„å‡½æ•°ï¼Œå¯ä»¥éå†removeChildæ¥å®ç° 1234var element = document.getElementById(&quot;top&quot;);while (element.firstChild) &#123; element.removeChild(element.firstChild);&#125; ç»“å°¾å…³äºDOMçš„æ“ä½œï¼Œå¸¸ç”¨çš„æš‚æ—¶åªæƒ³åˆ°è¿™ä¹ˆå¤šï¼Œä»¥åæƒ³åˆ°äº†ï¼Œå†æ…¢æ…¢è¡¥å……","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"promise-a+","date":"2017-12-28T10:17:46.000Z","path":"2017/12/28/promise-a/","text":"Promise A+ å­¦ä¹  åœ¨jsçš„æœ¬èº«è¢«è®¾è®¡ä¸ºå¼‚æ­¥çš„ï¼Œé‚£ä¹ˆè¿™å°±ç»™ç¼–ç æå‡ºäº†ä¸€ä¸ªè¦æ±‚ï¼Œè¯¥å¦‚ä½•å»ä¼˜é›…çš„ç¼–å†™jsä»£ç ä¸­å¼‚æ­¥çš„ä»£ç ï¼Œæœ€æ—©çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨å›è°ƒæ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ä½†æ˜¯åŒæ—¶ä¹Ÿäº§ç”Ÿäº†å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚ åæ¥åˆ™å‡ºç°äº†Promiseï¼ŒPromiseçš„å‡ºç°å¯ä»¥è¯´å½»åº•æ”¹å˜äº†å¯¹äºå¼‚æ­¥ä»£ç çš„ç¼–å†™æ–¹å¼ã€‚Promiseçš„å½±å“ä¹‹æ·±è¿œï¼Œå¯ä»¥è¯´es6åŠ å…¥äº†Promiseï¼Œkoaä¸­yieldï¼ŒGeneratorä¹Ÿæ˜¯é…åˆäº†Promiseæ‰å®ç°äº†ç±»ä¼¼awaitï¼Œasyncçš„åŠŸèƒ½ã€‚çŸ¥é“ES7ä¸­çœŸæ­£çš„asyncå’Œawaitä¹Ÿæ˜¯åŸºäºPromiseå®ç°çš„ï¼ˆå…¶å®asyncå’Œawaitåªæ˜¯Generatorçš„è¯­æ³•ç³–ï¼‰ã€‚å¯ä»¥è¯´Promiseåœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­å·²ç»æ— å¤„ä¸åœ¨äº†ã€‚ æ‰€ä»¥äº†è§£Promiseçš„è§„èŒƒè¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚å½“ç„¶æœ€å¥½çš„æ˜¯å»çœ‹ä¸€ä¸‹è§„èŒƒçš„åŸæ–‡ã€‚ Promise A+çš„è‹±æ–‡åŸæ–‡ï¼šPromise/A+ä¸‹é¢å¯¹äºåŸæ–‡çš„ç¿»è¯‘ï¼Œæˆ‘å°†ä¼šå¼•ç”¨ä¸€ä¸ªç½‘ä¸Šå·²æœ‰çš„ç¿»è¯‘ç‰ˆæœ¬ã€ç¿»è¯‘ã€‘Promises/A+è§„èŒƒçš„å†…å®¹ï¼Œåœ¨æ­¤æ„Ÿæ¿€ä½œè€…ã€‚ ä¸€ä¸ªå¼€æ”¾ã€å¥å…¨ä¸”é€šç”¨çš„ JavaScript Promise æ ‡å‡†ã€‚ç”±å¼€å‘è€…åˆ¶å®šï¼Œä¾›å¼€å‘è€…å‚è€ƒã€‚ Promise è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœï¼Œä¸ä¹‹è¿›è¡Œäº¤äº’çš„æ–¹å¼ä¸»è¦æ˜¯ then æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ³¨å†Œäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºæ¥æ”¶ promise çš„ç»ˆå€¼æˆ–æœ¬ promise ä¸èƒ½æ‰§è¡Œçš„åŸå› ã€‚ æœ¬è§„èŒƒè¯¦ç»†åˆ—å‡ºäº† then æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ‰€æœ‰éµå¾ª Promises/A+ è§„èŒƒå®ç°çš„ promise å‡å¯ä»¥æœ¬æ ‡å‡†ä½œä¸ºå‚ç…§åŸºç¡€æ¥å®æ–½ then æ–¹æ³•ã€‚å› è€Œæœ¬è§„èŒƒæ˜¯ååˆ†ç¨³å®šçš„ã€‚å°½ç®¡ Promise/A+ ç»„ç»‡æœ‰æ—¶å¯èƒ½ä¼šä¿®è®¢æœ¬è§„èŒƒï¼Œä½†ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†ä¸€äº›ç‰¹æ®Šçš„è¾¹ç•Œæƒ…å†µï¼Œä¸”è¿™äº›æ”¹åŠ¨éƒ½æ˜¯å¾®å°ä¸”å‘ä¸‹å…¼å®¹çš„ã€‚å¦‚æœæˆ‘ä»¬è¦è¿›è¡Œå¤§è§„æ¨¡ä¸å…¼å®¹çš„æ›´æ–°ï¼Œæˆ‘ä»¬ä¸€å®šä¼šåœ¨äº‹å…ˆè¿›è¡Œè°¨æ…åœ°è€ƒè™‘ã€è¯¦å°½çš„æ¢è®¨å’Œä¸¥æ ¼çš„æµ‹è¯•ã€‚ ä»å†å²ä¸Šè¯´ï¼Œæœ¬è§„èŒƒå®é™…ä¸Šæ˜¯æŠŠä¹‹å‰ Promise/A è§„èŒƒ ä¸­çš„å»ºè®®æ˜ç¡®æˆä¸ºäº†è¡Œä¸ºæ ‡å‡†ï¼šæˆ‘ä»¬ä¸€æ–¹é¢æ‰©å±•äº†åŸæœ‰è§„èŒƒçº¦å®šä¿—æˆçš„è¡Œä¸ºï¼Œä¸€æ–¹é¢åˆ å‡äº†åŸè§„èŒƒçš„ä¸€äº›ç‰¹ä¾‹æƒ…å†µå’Œæœ‰é—®é¢˜çš„éƒ¨åˆ†ã€‚ æœ€åï¼Œæ ¸å¿ƒçš„ Promises/A+ è§„èŒƒä¸è®¾è®¡å¦‚ä½•åˆ›å»ºã€è§£å†³å’Œæ‹’ç» promiseï¼Œè€Œæ˜¯ä¸“æ³¨äºæä¾›ä¸€ä¸ªé€šç”¨çš„ then æ–¹æ³•ã€‚ä¸Šè¿°å¯¹äº promises çš„æ“ä½œæ–¹æ³•å°†æ¥åœ¨å…¶ä»–è§„èŒƒä¸­å¯èƒ½ä¼šæåŠã€‚ æœ¯è¯­1.1 Promisepromise æ˜¯ä¸€ä¸ªæ‹¥æœ‰ then æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œå…¶è¡Œä¸ºç¬¦åˆæœ¬è§„èŒƒï¼› 1.2 thenableæ˜¯ä¸€ä¸ªå®šä¹‰äº† then æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œæ–‡ä¸­è¯‘ä½œâ€œæ‹¥æœ‰ then æ–¹æ³•â€ï¼› 1.3 å€¼ï¼ˆvalueï¼‰æŒ‡ä»»ä½• JavaScript çš„åˆæ³•å€¼ï¼ˆåŒ…æ‹¬ undefined , thenable å’Œ promiseï¼‰ï¼› 1.4 å¼‚å¸¸ï¼ˆexceptionï¼‰æ˜¯ä½¿ç”¨ throw è¯­å¥æŠ›å‡ºçš„ä¸€ä¸ªå€¼ã€‚ 1.5 æ®å› ï¼ˆreasonï¼‰è¡¨ç¤ºä¸€ä¸ª promise çš„æ‹’ç»åŸå› ã€‚ è¦æ±‚2.1 Promise çš„çŠ¶æ€ä¸€ä¸ª Promise çš„å½“å‰çŠ¶æ€å¿…é¡»ä¸ºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¸­çš„ä¸€ç§ï¼šç­‰å¾…æ€ï¼ˆPendingï¼‰ã€æ‰§è¡Œæ€ï¼ˆFulfilledï¼‰å’Œæ‹’ç»æ€ï¼ˆRejectedï¼‰ã€‚ 2.1.1 ç­‰å¾…æ€ï¼ˆPendingï¼‰å¤„äºç­‰å¾…æ€æ—¶ï¼Œpromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š å¯ä»¥è¿ç§»è‡³æ‰§è¡Œæ€æˆ–æ‹’ç»æ€ 2.1.2 æ‰§è¡Œæ€ï¼ˆFulfilledï¼‰å¤„äºæ‰§è¡Œæ€æ—¶ï¼Œpromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š ä¸èƒ½è¿ç§»è‡³å…¶ä»–ä»»ä½•çŠ¶æ€ å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç»ˆå€¼ 2.1.3 æ‹’ç»æ€ï¼ˆRejectedï¼‰å¤„äºæ‹’ç»æ€æ—¶ï¼Œpromise éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š ä¸èƒ½è¿ç§»è‡³å…¶ä»–ä»»ä½•çŠ¶æ€ å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸å¯å˜çš„æ®å›  è¿™é‡Œçš„ä¸å¯å˜æŒ‡çš„æ˜¯æ’ç­‰ï¼ˆå³å¯ç”¨ === åˆ¤æ–­ç›¸ç­‰ï¼‰ï¼Œè€Œä¸æ˜¯æ„å‘³ç€æ›´æ·±å±‚æ¬¡çš„ä¸å¯å˜ 2.2 thenæ–¹æ³•ä¸€ä¸ª promise å¿…é¡»æä¾›ä¸€ä¸ª then æ–¹æ³•ä»¥è®¿é—®å…¶å½“å‰å€¼ã€ç»ˆå€¼å’Œæ®å›  promise çš„ then æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š 1promise.then(onFulfilled, onRejected) 2.2.1 onFulfilled å’Œ onRejected éƒ½æ˜¯å¯é€‰å‚æ•°ã€‚2.2.1.1 å¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥2.2.1.2 å¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥2.2.2 å¦‚æœ onFulfilled æ˜¯å‡½æ•°ï¼š2.2.2.1 å½“ promise æ‰§è¡Œç»“æŸåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º promise çš„ç»ˆå€¼ ç±»ä¼¼ onFulfilled(value); 2.2.2.2 åœ¨ promise æ‰§è¡Œç»“æŸå‰å…¶ä¸å¯è¢«è°ƒç”¨123456789101112// è¿™é‡Œçš„onFulfilledä¸ºä¼ªä»£ç ï¼Œè¡¨ç¤ºonFulfilledçš„æ‰§è¡Œå‡½æ•°var onFulfilled = function() &#123; console.log(&quot;onFulfilled&quot;);&#125;var c = new Promise((onFulfilled, onRejected) =&gt; &#123; onFulfilled(&apos;ok&apos;); console.log(&apos;123&apos;);&#125;)&gt; &apos;123&apos;&gt; &apos;onFulfilled&apos; 2.2.2.3 å…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡12345678var c = new Promise((onFulfilled, onRejected) =&gt; &#123; onFulfilled(&apos;ok&apos;); onFulfilled(&apos;ok2&apos;);&#125;);c.then((data) =&gt; &#123; console.log(data); // &apos;ok&apos;&#125;) 2.2.3 å¦‚æœ onRejected æ˜¯å‡½æ•°ï¼š2.2.3.1 å½“ promise è¢«æ‹’ç»æ‰§è¡Œåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º promise çš„æ®å› 2.2.3.2 åœ¨ promise è¢«æ‹’ç»æ‰§è¡Œå‰å…¶ä¸å¯è¢«è°ƒç”¨2.2.3.3 å…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡2.2.4 onFulfilledå’Œ onRejected åªæœ‰åœ¨æ‰§è¡Œç¯å¢ƒå †æ ˆä»…åŒ…å«å¹³å°ä»£ç æ—¶æ‰å¯è¢«è°ƒç”¨2.2.5 onFulfilled å’Œ onRejected å¿…é¡»è¢«ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼ˆå³æ²¡æœ‰ this å€¼ï¼‰2.2.6 then æ–¹æ³•å¯ä»¥è¢«åŒä¸€ä¸ª promise è°ƒç”¨å¤šæ¬¡2.2.6.1 å½“ promise æˆåŠŸæ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰ onFulfilled éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ2.2.6.1 å½“ promise è¢«æ‹’ç»æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰çš„ onRejected éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ2.2.7 then å¿…é¡»è¿”å›ä¸€ä¸ª promise1promise2 = promise1.then(onFulfilled, onRejected); 2.2.7.1 å¦‚æœ onFulfilled æˆ–è€… onRejected è¿”å›ä¸€ä¸ªå€¼ x ï¼Œåˆ™è¿è¡Œä¸‹é¢çš„ Promise è§£å†³è¿‡ç¨‹ï¼š[Resolve]2.2.7.2 å¦‚æœ onFulfilled æˆ–è€… onRejected æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ e ï¼Œåˆ™ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œï¼Œå¹¶è¿”å›æ‹’å›  e2.2.7.3 å¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ä¸” promise1 æˆåŠŸæ‰§è¡Œï¼Œ promise2 å¿…é¡»æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„å€¼2.2.7.4 å¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ä¸” promise1 æ‹’ç»æ‰§è¡Œï¼Œ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„æ®å› 2.3 Promise è§£å†³è¿‡ç¨‹ æ³¨é‡Šï¼šè¿™é‡Œæ˜¯æè¿°çš„æ˜¯Promise.then() æ‰§è¡Œä»¥åè¿”å›ä»€ä¹ˆå†…å®¹ï¼Œå…¶å®Promise.then()ä¸€å®šä¼šè¿”å›ä¸€ä¸ªæ–°çš„Promiseï¼Œä½†æ˜¯å…·ä½“æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œæ˜¯å’Œthené‡Œçš„å›è°ƒå‡½æ•°çš„è¿”å›å€¼æœ‰å…³ï¼Œä¸‹é¢çš„xå°±æ˜¯thençš„å›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚å¯ä»¥å†çœ‹ä¸€çœ¼ä¸Šé¢2.2.7çš„å†…å®¹ Promise è§£å†³è¿‡ç¨‹æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ“ä½œï¼Œå…¶éœ€è¾“å…¥ä¸€ä¸ª promise å’Œä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬è¡¨ç¤ºä¸º [[Resolve]](promise, x)ï¼Œå¦‚æœ x æœ‰ then æ–¹æ³•ä¸”çœ‹ä¸Šå»åƒä¸€ä¸ª Promise ï¼Œè§£å†³ç¨‹åºå³å°è¯•ä½¿ promise æ¥å— x çš„çŠ¶æ€ï¼›å¦åˆ™å…¶ç”¨ x çš„å€¼æ¥æ‰§è¡Œ promise ã€‚ è¿™ç§ thenable çš„ç‰¹æ€§ä½¿å¾— Promise çš„å®ç°æ›´å…·æœ‰é€šç”¨æ€§ï¼šåªè¦å…¶æš´éœ²å‡ºä¸€ä¸ªéµå¾ª Promise/A+ åè®®çš„ then æ–¹æ³•å³å¯ï¼›è¿™åŒæ—¶ä¹Ÿä½¿éµå¾ª Promise/A+ è§„èŒƒçš„å®ç°å¯ä»¥ä¸é‚£äº›ä¸å¤ªè§„èŒƒä½†å¯ç”¨çš„å®ç°èƒ½è‰¯å¥½å…±å­˜ã€‚ è¿è¡Œ [[Resolve]](promise, x)éœ€éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š 2.3.1 x ä¸ promise ç›¸ç­‰å¦‚æœ promise å’Œ x æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œä»¥ TypeError ä¸ºæ®å› æ‹’ç»æ‰§è¡Œ promise123456789101112var p = new Promise(function(resolve, reject) &#123; resolve(123);&#125;);/* thençš„å›è°ƒå‡½æ•°è¿”å›äº†p2, å’Œpromiseæ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ */var p2 = p.then((data) =&gt; &#123; return p2;&#125;);&gt;&gt; Uncaught (in promise) TypeError: Chaining cycle detected for promise #&lt;Promise&gt; 2.3.2 x ä¸º Promiseå¦‚æœ x ä¸º Promise ï¼Œåˆ™ä½¿ promise æ¥å— x çš„çŠ¶æ€ 2.3.2.1 å¦‚æœ x å¤„äºç­‰å¾…æ€ï¼Œ promise éœ€ä¿æŒä¸ºç­‰å¾…æ€ç›´è‡³ x è¢«æ‰§è¡Œæˆ–æ‹’ç»2.3.2.2 å¦‚æœ x å¤„äºæ‰§è¡Œæ€ï¼Œç”¨ç›¸åŒçš„å€¼æ‰§è¡Œ promise2.3.2.3 å¦‚æœ x å¤„äºæ‹’ç»æ€ï¼Œç”¨ç›¸åŒçš„æ®å› æ‹’ç» promise è¿™é‡Œå…¶å®æ˜¯æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯promiseé“¾å¼è°ƒç”¨,è¿™é‡Œå°±ä¸å¤šè§£é‡Šäº† 123456getUserInfo().then((userInfo) =&gt; &#123; return getCompanyInfo();&#125;).then((companyInfo) =&gt; &#123; return getCityInfo();&#125;).then((cityInfo) =&gt; &#123;&#125;) 2.3.3 x ä¸ºå¯¹è±¡æˆ–å‡½æ•°2.3.3.1 æŠŠ x.then èµ‹å€¼ç»™ then è¿™é‡Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡thenï¼Œç±»ä¼¼ var then = x.then;, ä½œç”¨å…¶å®å’Œæˆ‘ä»¬å¹³å¸¸çš„è¿™æ ·åšçš„æ–¹å¼å·®ä¸å¤šï¼Œæ–¹ä¾¿åé¢çš„ä½¿ç”¨ã€‚ 2.3.3.2 å¦‚æœå– x.then çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ e ï¼Œåˆ™ä»¥ e ä¸ºæ®å› æ‹’ç» promise123456789101112131415161718function objFactory() &#123; var obj = &#123;&#125;; Object.defineProperty(obj, &quot;then&quot;, &#123; get: function() &#123; throw Error(&apos;then error&apos;); &#125; &#125;); return obj;&#125;var a = new Promise((resolve) =&gt; &#123; resolve();&#125;);a.then(() =&gt; &#123; return objFactory()&#125;);// Uncaught (in promise) Error: then error 2.3.3.3 å¦‚æœ then æ˜¯å‡½æ•°ï¼Œå°† x ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ this è°ƒç”¨ä¹‹ã€‚ä¼ é€’ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å«åš resolvePromise ï¼Œç¬¬äºŒä¸ªå‚æ•°å«åš rejectPromise:123456// ç±»ä¼¼è¿™ä¸ªä»£ç var then = x.then;if (typeof then === &apos;function&apos;) &#123; then.call(x, resolvePromise, rejectPromise);&#125; 2.3.3.3.1 å¦‚æœ resolvePromise ä»¥å€¼ y ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ [Resolve]1234567891011121314151617181920212223function objFactory() &#123; var obj = &#123;&#125;; Object.defineProperty(obj, &quot;then&quot;, &#123; get: function() &#123; return function(resolvePromise, rejectPromise) &#123; resolvePromise(&apos;resolve_y&apos;); &#125; &#125; &#125;); return obj;&#125;var a = new Promise((resolve) =&gt; &#123; resolve();&#125;);var c = a.then(() =&gt; &#123; return objFactory()&#125;);c.then((data) =&gt; &#123; console.log(data); // &quot;resolve_y&quot;&#125;) 2.3.3.3.2 å¦‚æœ rejectPromise ä»¥æ®å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ®å›  r æ‹’ç» promise123456789101112// ç±»ä¼¼ 2.3.3.3.1function objFactory() &#123; var obj = &#123;&#125;; Object.defineProperty(obj, &quot;then&quot;, &#123; get: function() &#123; return function(resolvePromise, rejectPromise) &#123; rejectPromise(&apos;resolve_y&apos;); &#125; &#125; &#125;); return obj;&#125; 2.3.3.3.3 å¦‚æœ resolvePromise å’Œ rejectPromise å‡è¢«è°ƒç”¨ï¼Œæˆ–è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©ä¸‹çš„è°ƒç”¨ è¿™ä¸ªå°±ä¸ç»™ä¾‹å­äº†ï¼Œè¡¨è¿°ä¹Ÿå¾ˆç›´æ¥äº† 2.3.3.3.4 å¦‚æœè°ƒç”¨ then æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ eï¼š2.3.3.3.4.1 å¦‚æœ resolvePromise æˆ– rejectPromise å·²ç»è¢«è°ƒç”¨ï¼Œåˆ™å¿½ç•¥ä¹‹123456789101112131415161718192021222324function objFactory() &#123; var obj = &#123;&#125;; Object.defineProperty(obj, &quot;then&quot;, &#123; get: function() &#123; return function(resolvePromise, rejectPromise) &#123; resolvePromise(&apos;resolve_y&apos;); console.log(test); &#125; &#125; &#125;); return obj;&#125;var a = new Promise((resolve) =&gt; &#123; resolve();&#125;);var c = a.then(() =&gt; &#123; return objFactory()&#125;);c.then((data) =&gt; &#123; console.log(data); // &quot;resolve_y&quot;&#125;) 2.3.3.3.4.2 å¦åˆ™ä»¥ e ä¸ºæ®å› æ‹’ç» promise12345678910111213141516171819202122function objFactory() &#123; var obj = &#123;&#125;; Object.defineProperty(obj, &quot;then&quot;, &#123; get: function() &#123; return function(resolvePromise, rejectPromise) &#123; console.log(test); resolvePromise(&apos;resolve_y&apos;); &#125; &#125; &#125;); return obj;&#125;var a = new Promise((resolve) =&gt; &#123; resolve();&#125;);var c = a.then(() =&gt; &#123; return objFactory()&#125;);// VM1124:6 Uncaught (in promise) ReferenceError: test is not defined 2.3.3.3.5 å¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise123456789101112131415161718192021function objFactory() &#123; var obj = &#123;&#125;; Object.defineProperty(obj, &quot;then&quot;, &#123; get: function() &#123; return &apos;test&apos;; &#125; &#125;); return obj;&#125;var a = new Promise((resolve) =&gt; &#123; resolve();&#125;);var c = a.then(() =&gt; &#123; return objFactory()&#125;);c.then((data) =&gt; &#123; console.log(data); // object &#123;then: &quot;test&quot;&#125;&#125;) 2.3.3.4 å¦‚æœ x ä¸ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise1234567891011var a = new Promise((resolve) =&gt; &#123; resolve();&#125;);var c = a.then(() =&gt; &#123; return &quot;test&quot;&#125;);c.then((data) =&gt; &#123; console.log(data); // &quot;test&quot;&#125;) æœªå®Œå¾…ç»­","tags":[]},{"title":"charles-https-proxy","date":"2017-11-23T11:55:21.000Z","path":"2017/11/23/charles-https-proxy/","text":"ä½¿ç”¨macä½œä¸ºå¼€å‘å·¥å…·çš„webç›¸å…³çš„å¼€å‘åŒå­¦ï¼Œç›¸ä¿¡éƒ½æœ‰ç”¨è¿‡ä¸€ä¸ªå¾ˆå¥½ç”¨çš„ä»£ç†æˆªåŒ…å·¥å…·â€”charles è¿™ä¸¤å¹´ï¼Œéšç€googleå¯¹httpsçš„å¤§åŠ›æ¨åŠ¨å’Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸è®¤è¯†åˆ°httpså¯¹äºç½‘ç»œå®‰å…¨çš„é‡è¦æ€§ï¼Œè¶Šæ¥è¶Šå¤šçš„é¡¹ç›®å·²ç»ä½¿ç”¨ä¸Šhttpsäº†ã€‚ è¿™ä½¿å¾—ä»¥å‰ç›¸å¯¹æ¯”è¾ƒç®€å•çš„æˆªåŒ…è®¾ç½®æ¥è¯´ï¼Œå¤šäº†ä¸€äº›æ­¥éª¤ã€‚è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹å…³äºiosçš„æˆªåŒ…è®¾ç½®ã€‚å¯¹äºcharlesç«¯çš„è®¾ç½®ï¼Œç›¸å¯¹æ¥è¯´ç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šçš„æ•™ç¨‹äº†ã€‚è¿™è¾¹å°±ç®€å•æä¸€ä¸‹ã€‚ éœ€è¦åœ¨help çš„ SSL Proxying é€‰é¡¹ä¸­ç‚¹å‡»install Charles Root Certificate åœ¨é’¥åŒ™ä¸²ä¸­ç‚¹å‡»æ·»åŠ  è®¾ç½®è¯ä¹¦ä¸ºä¿¡ä»» åœ¨Charlesçš„Proxyä¸­é€‰ä¸­SSL Proxying Settings, åœ¨é‡Œé¢å¢åŠ ä½ éœ€è¦è§£æçš„https æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬iosè®¾å¤‡è¿æ¥ä¸ŠCharlesçš„ä»£ç†ï¼ˆè¿™ä¸ªç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šäº†ï¼‰ ç„¶ååœ¨safariä¸­æ‰“å¼€https://chls.pro/sslï¼Œæ·»åŠ è¯ä¹¦ï¼Œç„¶åä½ å°±å¯ä»¥å†safariä¸­è®¿é—®httpsçš„ç½‘ç«™ï¼Œå¹¶çœ‹åˆ°è¯·æ±‚çš„å…·ä½“ä¿¡æ¯äº†ã€‚ ä½†æ˜¯å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ›´å¤šçš„æ˜¯éœ€è¦æŸ¥çœ‹APPä¸­çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆä½ è¿˜éœ€è¦ä¸‹é¢ä¸€æ­¥ åœ¨ioså¤§äº10.3çš„ç‰ˆæœ¬ä¸­ï¼Œä½ éœ€è¦æ‰“å¼€è®¾ç½®-&gt; é€šç”¨-&gt; å…³äºæœ¬æœº-&gt; è¯ä¹¦ä¿¡ä»»è®¾ç½®ï¼Œåœ¨è¿™é‡Œï¼Œå°†Charlesçš„è¯ä¹¦è®¾ç½®ä¸ºå®Œå…¨ä¿¡ä»»ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨iosè®¾å¤‡ä¸Šçš„ä»»ä½•åœ°æ–¹è®¿é—®çš„httpsè¯·æ±‚éƒ½å¯ä»¥è¢«è§£æçœ‹åˆ°äº†ã€‚ å…·ä½“çš„ä¿¡æ¯å¯ä»¥æŸ¥çœ‹Charlesçš„å®˜æ–¹æ–‡æ¡£","tags":[]},{"title":"requirejså’Œreactçš„åŠ¨æ€æ¨¡å—åŠ è½½","date":"2017-09-25T06:57:06.000Z","path":"2017/09/25/requirejs-async-module-loader/","text":"requirejsæ˜¯å½“å‰æ¯”è¾ƒå¥½çš„AMDè§„èŒƒçš„å®ç°ï¼Œæ‰€æœ‰çš„JSæ–‡ä»¶ä¼šè¢«æ‰“åŒ…æˆä¸€ä¸ªjsæ–‡ä»¶ï¼Œå‡å°‘è¯·æ±‚æ•°é‡ï¼ŒåŒæ—¶æ¯”è¾ƒæ–¹ä¾¿çš„å®ç°äº†SPAçš„æ¨¡å¼ã€‚ä½†æ˜¯éšç€é¡¹ç›®çš„æ¨è¿›ï¼ŒSPAçš„é¦–å±åŠ è½½é—®é¢˜å°±ä¼šè¶Šæ¥è¶Šæ˜æ˜¾ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œwebpackåœ¨v1ç‰ˆæœ¬ä¸­é€šè¿‡require.ensureï¼Œåœ¨v2ç‰ˆæœ¬ä¸­é€šè¿‡dynamic-importsæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡å®ç°æœ€é‡è¦çš„å°±æ˜¯åœ¨ä»£ç è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€åŠ è½½å…¶ä»–çš„jsæ–‡ä»¶ï¼ˆæ¨¡å—ï¼‰ã€‚åœ¨requirejsçš„å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨æ¨¡å—ä¸­ï¼Œä¹Ÿæ˜¯å¯ä»¥éšæ—¶ä½¿ç”¨requireæ¥åŠ è½½æ–°çš„æ¨¡å—ï¼Œå¦‚ä¸‹ 123456789require([&quot;require&quot;, &quot;alpha&quot;, &quot;beta&quot;], function(require, alpha, beta) &#123; setTimeout(function() &#123; require([&quot;omega&quot;], function(omega) &#123; console.log(&quot;load omega finish&quot;); &#125; ); &#125;, 100);&#125;); ä¸è¿‡æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­çœ‹åˆ°äº†å¾ˆå¸¸è§çš„å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿä¼šæœ‰ä¸€äº›å¼‚å¸¸å¤„ç†çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå…ˆä½¿ç”¨promiseå°è£…ä¸€ä¸‹requireçš„æ–‡ä»¶åŠ è½½ 12345678910111213141516171819202122232425/** * [asyncModule description] * @param &#123;[type]&#125; paths [ä¼ å…¥ä¸€ä¸ªæ¨¡å—è·¯å¾„çš„æ•°ç»„] * @return &#123;[type]&#125; [Promise] */function asyncModule(paths) &#123; return new Promise((resolve, reject) =&gt; &#123; if (!(paths instanceof Array)) &#123; reject(&apos;paths should be a array&apos;); return false; &#125; /** * [paths description] * @type &#123;[type]&#125; */ paths = paths.map((path) =&gt; &#123; path = manifest[path] || path; let url = require.toUrl(path).slice(1); return url.slice(0, url.indexOf(&apos;?&apos;)); &#125;); require(paths, function callback(Module) &#123; resolve.apply(this, arguments); &#125;); &#125;);&#125; ä¸Šé¢æœ‰ä¸€æ®µä»£ç æ˜¯pathçš„å¤„ç†ï¼Œä¸»è¦æ˜¯æ­é…requireæ¥å¤„ç†æ¨¡å—çš„è·¯å¾„: 1require.config(&#123; baseUrl: &apos;js/&apos;, waitSeconds: 60&#125;); æˆ‘ä»¬å†é€šè¿‡reactæ¥å°è£…ä¸€ä¸ªâ€æ¨¡å—åŠ è½½å™¨â€: 12345678910111213141516171819202122232425262728define([], () =&gt; class DynamicModuleLoader extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; log: &apos;module loading&apos;, module: undefined &#125;; &#125; componentDidMount() &#123; asyncModule([this.props.module]).then((module) =&gt; &#123; this.setState(&#123; module &#125;); &#125;).catch((e) =&gt; &#123; this.setState(&#123; log: &apos;module load error&apos; &#125;); &#125;); &#125; render() &#123; if (this.state.module) &#123; return &lt;this.state.module &#123;...this.props&#125; /&gt;; &#125; return ( &lt;div data-ilog=&#123;this.state.log&#125; /&gt; ); &#125;&#125;); æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ä»£ç ä¸­ä»¥å¦‚ä¸‹æ–¹å¼ä½¿ç”¨å³å¯ 123456789101112131415161718define([&apos;dynamic-module-loader&apos;], (DynamicModuleLoader) =&gt; class PageHome extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; ... &#125;; &#125; componentDidMount() &#123; &#125; render() &#123; return ( &lt;div&gt; &lt;h1&gt;Home&lt;/h1&gt; &lt;DynamicModuleLoader module=&quot;module1/index.dynamic.js&quot; renderData=&#123;this.props&#125; /&gt; &lt;/div&gt; ); &#125;&#125;); é™¤äº†ä»£ç å±‚é¢çš„ä¿®æ”¹ï¼Œè¿˜éœ€è¦é’ˆå¯¹æ„å»ºå·¥å…·åšä¿®æ”¹, é¦–å…ˆæˆ‘ä»¬å°†éœ€è¦åŠ¨æ€åŠ è½½çš„jsæ–‡ä»¶åŠ ä¸Š.dynamic.jsçš„åç¼€ï¼Œä¸»è¦çš„é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨module1/index.dynamic.jsæ¥åŠ è½½ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘ç‰ˆæœ¬çš„é—®é¢˜ï¼Œæ‰€ä»¥çœŸå®çš„åŠ è½½æ–‡ä»¶çš„è·¯å¾„å¯èƒ½æ˜¯module1/index-f37e86f666.dynamic.js,æ‰€ä»¥éœ€è¦è€ƒè™‘å¼€å‘æ—¶çš„ä¾¿åˆ©å’Œç”Ÿæˆç¯å¢ƒçš„éœ€æ±‚ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†gulpï¼Œ: 1234567891011const gulp = require(&apos;gulp&apos;);const babel = require(&apos;gulp-babel&apos;);const rev = require(&apos;gulp-rev&apos;);gulp.src(`$&#123;PROJECT_PATH&#125;/js/**/*.async.js`) .pipe(babel()) .pipe(uglifyJS()) .pipe(rev()) .pipe(gulp.dest(`$&#123;BUILD_PATH&#125;js/`)) .pipe(rev.manifest()) .pipe(gulp.dest(`$&#123;BUILD_PATH&#125;js/`)); è¿™é‡Œæˆ‘ä»¬é€šè¿‡gulp-revæ¥é‡å‘½åæ¨¡å—ï¼Œå¹¶ä¸”ç”Ÿæˆäº†manifest.jsonã€‚é‚£æˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šé¢function asyncModule()ä¸­æ‹¿åˆ°manifest.json,è·å–å°±å¯ä»¥æŸ¥è¯¢å¾—åˆ°çœŸæ­£çš„æ¨¡å—è·¯å¾„ã€‚ è¿™é‡Œä½ å¯ä»¥é€šè¿‡ajax.getæ¥è·å–manifest.jsonç„¶åä¿å­˜åœ¨å…¨å±€å˜é‡ã€‚ä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡gulp-repalceï¼Œåœ¨æ„å»ºçš„æ—¶å€™ç›´æ¥å°†æ•´ä¸ªjsonæ’å…¥åˆ°ä»£ç ä¸­ï¼Œå°±ä¸éœ€è¦å•ç‹¬åŠ è½½ä¸€ä¸ªjsonäº†ã€‚","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"requirejs","slug":"requirejs","permalink":"http://wangyuekai.com/tags/requirejs/"}]},{"title":"sock5ä»£ç†nodeå®ç°(3)","date":"2017-08-01T12:36:59.000Z","path":"2017/08/01/node-socks-proxy-3/","text":"åœ¨å‰ä¸¤ç¯‡ä¸¤æ¬¡æ¡æ‰‹ä¿¡æ¯ä¹‹åï¼Œæˆ‘ä»¬è¿™æ¬¡ç»ˆäºå¯ä»¥åˆ°è·å–æ•°æ®è¿™ä¸€æ­¥äº†ã€‚ åœ¨å®¢æˆ·ç«¯æ”¶åˆ°æˆ‘ä»¬ä¸Šä¸€ç¯‡æ•°æ®çš„å¯†ç éªŒè¯æˆåŠŸçš„ä¿¡æ¯åï¼Œå®¢æˆ·ç«¯ä¼šå‘æœåŠ¡ç«¯å‘å‡ºéœ€è¦è®¿é—®çš„åœ°å€ï¼Œå®ƒå¯èƒ½æ˜¯IP(Ipv4æˆ–è€…Ipv6)å’Œç«¯å£å·ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯åŸŸåå’Œç«¯å£å·ã€‚ å…·ä½“çš„æ•°æ®æ ¼å¼ç±»ä¼¼ä¸‹é¢ +â€”-+â€”â€“+â€”â€”-+â€”â€”+â€”â€”â€”-+â€”â€”â€”-+|VER | CMD | RSV | ATYP | DST.ADDR | DST.PORT |+â€”-+â€”â€“+â€”â€”-+â€”â€”+â€”â€”â€”-+â€”â€”â€”-+| 1 | 1 | Xâ€™00â€™ | 1 | Variable | 2 |+â€”-+â€”â€“+â€”â€”-+â€”â€”+â€”â€”â€”-+â€”â€”â€”-+ ç¬¬ä¸€ä¸ªå‚æ•°VERè¡¨ç¤ºä½¿ç”¨çš„åè®®ç‰ˆæœ¬å· ç¬¬äºŒä¸ªå‚æ•°CMDè¡¨ç¤ºéœ€è¦ä½¿ç”¨çš„é“¾æ¥æ–¹å¼ 0x01 è¡¨ç¤ºCONNECTï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„httpè¯·æ±‚ 0x02 è¡¨ç¤ºBINDï¼Œæ¯”å¦‚FTPç­‰è¯·æ±‚ 0x03 è¡¨ç¤ºUDPã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°RSVè¡¨ç¤ºå•è¯RESERVEDï¼Œä¹Ÿå°±æ˜¯å­—é¢æ„æ€ä¿ç•™å­—æ®µï¼Œæš‚æ—¶æ²¡æœ‰ç”¨ ç¬¬å››ä¸ªå‚æ•°ATYPè¡¨ç¤ºaddress typeï¼Œå°±æ˜¯ä½¿ç”¨çš„åœ°å€ç±»å‹ 0x01 IP V4åœ°å€ 0x03 åŸŸå 0x04 IP V6åœ°å€ ç¬¬äº”ä¸ªå‚æ•°DST.ADDRï¼Œè¡¨ç¤ºç›®æ ‡ä¸»æœºçš„åœ°å€ ç¬¬å…­ä¸ªå‚æ•°DST.PORTï¼Œè¡¨ç¤ºç›®æ ‡ä¸»æœºçš„ç«¯å£ åœ¨æˆ‘ä»¬æ‹¿åˆ°åœ°å€å’Œç«¯å£åï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è¿æ¥ç›®æ ‡ä¸»æœºï¼Œåœ¨æˆ‘ä»¬è¿æ¥æˆåŠŸåï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ç±»ä¼¼ä¸‹é¢çš„æ•°æ® +â€”-+â€”â€“+â€”â€”-+â€”â€”+â€”â€”â€”-+â€”â€”â€”-+|VER | REP | RSV | ATYP | BND.ADDR | BND.PORT |+â€”-+â€”â€“+â€”â€”-+â€”â€”+â€”â€”â€”-+â€”â€”â€”-+| 1 | 1 | Xâ€™00â€™ | 1 | Variable | 2 |+â€”-+â€”â€“+â€”â€”-+â€”â€”+â€”â€”â€”-+â€”â€”â€”-+ å­—æ®µå†…å®¹å’Œä¸Šé¢åŸºæœ¬ä¸€æ ·BND.ADDRå°±æ˜¯DST.ADDR,BND.PORTå°±æ˜¯DST.PORTã€‚ å”¯ä¸€ä¸åŒçš„å°±æ˜¯REPï¼Œè¿™ä¸ªè¡¨ç¤ºæœåŠ¡ç«¯å»è¿æ¥ç›®æ ‡ä¸»æœºçš„ç»“æœ Xâ€™00â€™ æˆåŠŸ Xâ€™01â€™ æ™®é€šçš„SOCKSæœåŠ¡å™¨è¯·æ±‚å¤±è´¥ Xâ€™02â€™ ç°æœ‰çš„è§„åˆ™ä¸å…è®¸çš„è¿æ¥ Xâ€™03â€™ ç½‘ç»œä¸å¯è¾¾ Xâ€™04â€™ ä¸»æœºä¸å¯è¾¾ Xâ€™05â€™ è¿æ¥è¢«æ‹’ Xâ€™06â€™ TTLè¶…æ—¶ Xâ€™07â€™ ä¸æ”¯æŒçš„å‘½ä»¤ Xâ€™08â€™ ä¸æ”¯æŒçš„åœ°å€ç±»å‹ Xâ€™09â€™ â€“ Xâ€™FFâ€™ æœªå®šä¹‰ å®¢æˆ·ç«¯æ¥ä¸‹æ¥å°±ä¼šæŠŠåŸæ¥çš„è¯·æ±‚å®Œæ•´çš„å‘ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ç›´æ¥è½¬å‘ç»™ç›®æ ‡ä¸»æœºå°±å¥½ï¼Œå…¶å®åœ¨æˆ‘ä»¬æœåŠ¡ç«¯å’Œå®¢æœç«¯ç›¸äº’è®¤è¯å¹¶ä¸”æœåŠ¡ç«¯ä¸ç›®æ ‡ä¸»æœºè¿æ¥ä¸Šä»¥åï¼ŒæœåŠ¡ç«¯æ¥ä¸‹æ¥çš„ä»»åŠ¡å°±ç›¸å½“äºåœ¨å®¢æˆ·ç«¯ä¸ç›®æ ‡ä¸»æœºå……å½“æ¬è¿å·¥çš„èŒè´£ï¼Œåªæ˜¯è´Ÿè´£åŒ…å®¢æˆ·ç«¯çš„è¯·æ±‚å†…å®¹ä¸€æ ·çš„å‘ç»™ç›®æ ‡ä¸»æœºï¼Œå†æŠŠç›®æ ‡ä¸»æœºçš„å†…å®¹å‘ç»™å®¢æˆ·ç«¯ã€‚ ä¸‹é¢æ˜¯å¯¹åº”çš„ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354const net = require(&apos;net&apos;);// ç”¨æ¥è§£æåœ°å€ä¿¡æ¯const ReqInfo = require(&apos;./reqinfo.js&apos;);async function receiveRequest(chunk) &#123; let socket = this; // è·å–åˆ°åœ°å€ä¿¡æ¯ let reqinfo = await ReqInfo(chunk); let resp = new Buffer(chunk.length); // ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªæ•°æ®æ ¼å¼åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯æœ‰ä¸€ä¸ªå­—æ®µä¸ä¸€æ ·è€Œå·²ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿å°±å¤åˆ¶ä¸€ä»½ chunk.copy(resp); resp[0] = 0x05; // ä¸ä»£ç†æœ¬åœ°åœ°å€ if (reqinfo.dest === &apos;127.0.0.1&apos; || reqinfo.dest === &apos;localhost&apos;) &#123; resp[1] = 0x02; socket.write(resp); return false; &#125; try &#123; // å°è¯•è¿æ¥ç›®æ ‡ä¸»å¥ let req = net.createConnection(reqinfo.port, reqinfo.dest, (s) =&gt; &#123; log(&apos;createConnection success&apos;); // è¦åœ¨ä¿è¯è¿æ¥ä¸Šç›®æ ‡æœåŠ¡å™¨è¿”å›æˆåŠŸæ•°æ® resp[1] = 0x00; socket.write(resp); // åœ¨å®¢æˆ·ç«¯æ¥å—åˆ°è¿æ¥ä¸ŠæœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œåˆ™ä¼šå‘é€å®Œæ•´çš„è¯·æ±‚å†…å®¹ï¼Œç›´æ¥è½¬å‘ç»™req socket.pipe(req); req.pipe(socket); &#125;); // è®¾ç½®è¿æ¥ç›®æ ‡ä¸»æœºçš„è¶…æ—¶æ—¶é—´ req.setTimeout(60 * 1000); // è¿æ¥è¶…æ—¶ req.on(&apos;timeout&apos;, () =&gt; &#123; resp[1] = 0x06; socket.write(resp); req.destroyed || req.destroy(); &#125;); // è¿æ¥ç›®æ ‡ä¸»æœºå¤±è´¥ req.on(&apos;error&apos;, () =&gt; &#123; resp[1] = 0x05; socket.write(resp); &#125;); &#125; catch (e) &#123; console.error(&apos;æœªæ•æ‰é”™è¯¯: net.createConnection&apos;); socket.emit(&apos;error&apos;, e); &#125;&#125;module.exports = receiveRequest; ç»†å¿ƒçš„äººè‚¯å®šçœ‹åˆ°äº†ï¼Œæˆ‘è¿™è¾¹ä½¿ç”¨äº†asyncå’Œawaitï¼Œä¸»è¦æ˜¯åœ¨è§£æç›®æ ‡ä¸»æœºåœ°å€æ—¶ç”¨åˆ°äº†ï¼Œä¸»è¦åŸå› æ˜¯å› ä¸ºæˆ‘åœ¨å†™è¿™æ®µä»£ç ï¼Œè°ƒè¯•çš„æ—¶å€™ä¸çŸ¥é“ä¸ºä»€ä¹ˆgoogleå°±æ˜¯è¿æ¥ä¸ä¸Šï¼Œå…¶ä»–çš„ç½‘ç«™éƒ½å¯ä»¥ï¼Œåæ¥å‘ç°åŸæ¥ï¼Œæˆ‘æ‰€åœ¨çš„åœ°æ–¹DNSè¢«åŠ«æŒäº†ï¼Œgoogle.comåŸŸåè¿”å›çš„æ˜¯ç™¾åº¦çš„ipï¼Œç»“æœå› ä¸ºhttpsçš„å®‰å…¨é—®é¢˜(ç›¸å½“äºç»™ç™¾åº¦å‘äº†google.comçš„è¯ä¹¦)ï¼Œå¯¼è‡´ä¸€ç›´è®¿é—®é”™è¯¯ã€‚ æ‰€ä»¥å°±æŠŠDNSæ”¾åœ¨æœåŠ¡ç«¯äº†ï¼ŒDNSçš„è§£ææ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨asyncå’Œawaitæ¥è§£å†³å¼‚æ­¥çš„é—®é¢˜ã€‚ä¸è¿‡è¿™æ ·ä¼šå¢åŠ æœåŠ¡ç«¯çš„å‹åŠ›ï¼Œä¸è¿‡è¿™ä¸ªè®¾ç½®å¯ä»¥åœ¨å®¢æˆ·ç«¯é…ç½®ã€‚å¦å¤–è‚¯å®šä¹Ÿçœ‹åˆ°äº†ï¼Œæˆ‘è¿™é‡Œå¹¶æ²¡æœ‰è´´å‡ºconst ReqInfo = require(&#39;./reqinfo.js&#39;);çš„å…·ä½“ä»£ç ï¼Œå…·ä½“ä»£ç è¯·ç§»æ­¥github socks-proxyçœ‹å§ï¼Œè¿™é‡Œå°±ä¸å…·ä½“è§£é‡Šäº†ã€‚ è‡³æ­¤socks5ä»£ç†çš„æœåŠ¡ç«¯å°±åŸºæœ¬å®Œæˆäº†ï¼Œå½“ç„¶è¿™ä¸ªåªæ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç‰ˆæœ¬ï¼Œè¿˜éœ€è¦å¾ˆå¤šçš„å¼‚å¸¸éœ€è¦å¤„ç†ï¼Œä»…ä¾›å¨±ä¹å§ã€‚ sock5ä»£ç†nodeå®ç°(1)sock5ä»£ç†nodeå®ç°(2)","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"},{"name":"socks","slug":"socks","permalink":"http://wangyuekai.com/tags/socks/"},{"name":"proxy","slug":"proxy","permalink":"http://wangyuekai.com/tags/proxy/"}]},{"title":"sock5ä»£ç†nodeå®ç°(2)","date":"2017-07-31T15:10:17.000Z","path":"2017/07/31/node-socks-proxy-2/","text":"ä¸Šä¸€ç¯‡æˆ‘ä»¬å·²ç»å®Œæˆäº†socks5å®¢æœç«¯å’ŒæœåŠ¡ç«¯çš„ç¬¬ä¸€æ¬¡æ¡æ‰‹è®¤è¯ï¼Œç›¸äº’ç¡®è®¤äº†socksåè®®çš„ç‰ˆæœ¬å·ï¼Œè®¤è¯çš„æ–¹å¼ï¼Œç°åœ¨è®¤è¯æ–¹å¼å®šä¸ºç”¨æˆ·åå’Œå¯†ç è®¤è¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é©¬ä¸Šå°±æ¥è®¤è¯ã€‚ RFCçš„socks5æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰å†™ç”¨æˆ·åå’Œå¯†ç è®¤è¯çš„è®¤è¯ç»†èŠ‚ï¼Œè€Œæ˜¯å†™åœ¨å¦ä¸€ç¯‡æ–‡æ¡£ä¸­ã€‚ å®¢æˆ·ç«¯åœ¨æ¥æ”¶åˆ°ä¸Šä¸€ç¯‡æœ€åå‘å‡ºçš„æ•°æ®åï¼Œä¼šå‘å‡ºä¸‹é¢è¿™ä¸ªæ ¼å¼çš„æ•°æ® +â€”-+â€”â€”+â€”â€”â€”-+â€”â€”+â€”â€”â€”-+|VER | ULEN | UNAME | PLEN | PASSWD |+â€”-+â€”â€”+â€”â€”â€”-+â€”â€”+â€”â€”â€”-+| 1 | 1 | 1 to 255 | 1 | 1 to 255 |+â€”-+â€”â€”+â€”â€”â€”-+â€”â€”+â€”â€”â€”-+ ç¬¬ä¸€ä¸ªå‚æ•°VERè¡¨ç¤ºå½“å‰çš„è´¦å·å¯†ç è®¤è¯çš„åè®®ç‰ˆæœ¬å·ï¼ˆæ³¨æ„è¿™ä¸ªä¸æ˜¯socksçš„ç‰ˆæœ¬å·ï¼‰ï¼Œæš‚æ—¶åªæœ‰0x01ã€‚ ç¬¬äºŒä¸ªå‚æ•°å¸¦ULENä¸ºç”¨æˆ·åçš„é•¿åº¦ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ç”¨æˆ·åæœ€é•¿ä¸º255ä½ã€‚ ç¬¬ä¸‰ç»„å‚æ•°ULENå°±æ˜¯ç”¨æˆ·åï¼Œé•¿åº¦å°±æ˜¯ULENã€‚ ç¬¬å››ä¸ªå‚æ•°PLENä¸ºå¯†ç é•¿åº¦ï¼ŒåŒæ ·æœ€é•¿ä¸º255ä½ã€‚ ç¬¬äº”ç»„å‚æ•°PLENæ˜¯å¯†ç ï¼Œé•¿åº¦ä¸ºPLENã€‚ è€Œæˆ‘ä»¬çš„æœåŠ¡ç«¯éœ€è¦åœ¨è·å–åˆ°è´¦å·å¯†ç åè¿”å›ä»¥ä¸‹æ ¼å¼çš„æ•°æ® +â€”-+â€”â€”â€“+|VER | STATUS |+â€”-+â€”â€”â€“+| 1 | 1 |+â€”-+â€”â€”â€“+ ç¬¬ä¸€ä¸ªå‚æ•°VERè¡¨ç¤ºå½“å‰çš„è´¦å·å¯†ç è®¤è¯çš„åè®®ç‰ˆæœ¬å·ï¼ˆæ³¨æ„è¿™ä¸ªä¸æ˜¯socksçš„ç‰ˆæœ¬å·ï¼‰ï¼Œæš‚æ—¶åªæœ‰0x01ã€‚ ç¬¬äºŒä¸ªå‚æ•°STATUSè¡¨ç¤ºæ˜¯å¦è®¤è¯æˆåŠŸï¼Œå…¶ä¸­åªæœ‰STATUSä¸º0x00è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–éƒ½æ˜¯è¡¨ç¤ºé”™è¯¯ã€‚ ä¸‹é¢æ˜¯å¯¹åº”çš„Nodeä»£ç å®ç°: 12345678910111213141516171819202122232425262728// è¿™ä¸ªåç»­ä¼šè¯´æ˜const receiveRequest = require(&apos;./receive-request.js&apos;);module.exports = function (data) &#123; const socket = this; let ver = data[0]; // ç”¨æˆ·åé•¿åº¦ let ulen = parseInt(data[1], 10); // ç”¨æˆ·å let username = data.slice(2, 2 + ulen).toString(&apos;utf8&apos;); // å¯†ç é•¿åº¦ let plen = parseInt(data[1 + ulen + 1], 10); let passwordStartPostion = 1 + ulen + 2; // å¯†ç  let password = data.slice(passwordStartPostion, passwordStartPostion + plen).toString(&apos;utf8&apos;); // statusä¸æ˜¯0x00å°±è¡¨ç¤ºå¯†ç é”™è¯¯ let status = 0x01; // è¿™é‡Œæˆ‘ä»¬è´¦å·å¯†ç æš‚æ—¶å†™æ­»ä¸ºabc 1234 if (username === &apos;abc&apos; &amp;&amp; password === &apos;1234&apos;) &#123; status = 0x00; &#125; let res = new Buffer([ver, status]); // å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ socket.write(res); // ç›‘å¬ä¸‹ä¸€æ¬¡è¯·æ±‚ socket.once(&apos;data&apos;, receiveRequest.bind(socket));&#125;; sock5ä»£ç†nodeå®ç°(1)sock5ä»£ç†nodeå®ç°(3)","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"},{"name":"socks","slug":"socks","permalink":"http://wangyuekai.com/tags/socks/"},{"name":"proxy","slug":"proxy","permalink":"http://wangyuekai.com/tags/proxy/"}]},{"title":"sock5ä»£ç†nodeå®ç°(1)","date":"2017-07-30T15:37:37.000Z","path":"2017/07/30/node-socks-proxy-1/","text":"ç›¸ä¿¡å¤§å®¶éƒ½ä½¿ç”¨è¿‡æˆ–è€…å¬è¯´è¿‡shadowsocks, å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è®¿é—®ä¸€äº›â€œè®¿é—®ä¸åˆ°â€çš„ç½‘ç«™ã€‚åœ¨wikiä¸Šå¯¹äºå®ƒçš„è¯´æ˜æ˜¯â€œshadowsocksæ˜¯ä¸€ç§åŸºäºSocks5ä»£ç†æ–¹å¼çš„ç½‘ç»œæ•°æ®åŠ å¯†ä¼ è¾“åŒ…â€(ç™¾åº¦ä¸Šå¹¶æ²¡æœ‰è¿™ä¸ªè¯æ¡äº†)ã€‚å…¶å®shadowsockså°±æ˜¯socks5åè®®çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„å®ç°ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬äº†è§£ä¸€ä¸‹socks5çš„å…·ä½“ç»†èŠ‚ï¼Œå¹¶ä½¿ç”¨nodeæ¥å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯ç‰ˆæœ¬ã€‚ å…¶ä¸­socksæœ‰socks4å’Œsocks5ç‰ˆæœ¬ï¼Œsocks5æ¯”socks4å¤šäº†UDPã€éªŒè¯ï¼Œä»¥åŠIPv6çš„æ”¯æŒï¼Œæ‰€æœ‰socks5æ˜¯socks4çš„å‡çº§ç‰ˆä¹Ÿæ”¯æŒäº†socks4æ‰€æœ‰çš„å†…å®¹ï¼ˆæˆ‘ä»¬ä¸‹é¢è¯´åˆ°çš„æ‰€æœ‰socksåè®®éƒ½æ˜¯åŸºäºsocks5ç‰ˆæœ¬ï¼‰ã€‚åŒæ—¶socksåè®®ä½äºè¡¨ç¤ºå±‚å’Œä¼ è¾“å±‚ä¹‹é—´ï¼Œè€Œhttpå’Œhttpsä½äºåº”ç”¨å±‚ï¼Œæ‰€ä»¥ä½¿ç”¨socksåè®®æ¥ä»£ç†httpså¯ä»¥ä¸éœ€è¦è€ƒè™‘httpsæœ¬èº«çš„å®‰å…¨é™åˆ¶ã€‚ å…³äºsocks5çš„åè®®ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹RFCçš„socks5è¯´æ˜ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯socks5ä¼ è¾“çš„éƒ½æ˜¯16è¿›åˆ¶çš„æ•°æ®ã€‚ åˆ›å»ºæœåŠ¡å™¨é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨æ¥æ¥æ”¶åé¢å®¢æœç«¯ä¼ è¿‡æ¥çš„æ•°æ®ã€‚ ä¸‹é¢æ˜¯nodeçš„å®ç°ï¼š 12345678910111213141516171819202122232425262728293031const net = require(&apos;net&apos;);// ç¬¬ä¸€æ¬¡æ¡æ‰‹è¿æ¥çš„æ•°æ®å¤„ç†ï¼Œåé¢ä¼šå®ç°ã€‚const shakehand = require(&apos;./shake-hand.js&apos;);function connectServer(socket) &#123; try &#123; // ç›‘å¬socketçš„é”™è¯¯ä¿¡æ¯ socket.on(&apos;error&apos;, (e) =&gt; &#123; console.error(e); &#125;); // è®¾ç½®è¶…æ—¶å¹¶ç›‘å¬timeoutäº‹ä»¶ socket.setTimeout(60 * 1000); socket.on(&apos;timeout&apos;, () =&gt; &#123; socket.destroyed || socket.destroy(); &#125;); // ç”¨äºä¸‹é¢çš„æ¡æ‰‹è¿æ¥ // å› ä¸ºsocks5çš„æ•´ä¸ªæ¡æ‰‹å’Œè®¤è¯éœ€è¦ä¼ è¾“å¤šæ¬¡æ•°æ®ï¼Œæ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿™é‡Œåªéœ€è¦ç›‘å¬ä¸€æ¬¡ã€‚ socket.once(&apos;data&apos;, shakehand.bind(socket)); &#125; catch (e) &#123; console.error(&apos;æœªæ•æ‰é”™è¯¯&apos;); console.error(e); &#125;&#125;// ç›‘å¬1080ç«¯å£net.createServer(connectServer).listen(1080).on(&apos;error&apos;, (e) =&gt; &#123; console.error(e);&#125;); ç¬¬ä¸€æ¬¡æ¡æ‰‹è¿æ¥å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºè¿æ¥ã€‚é¦–å…ˆæ˜¯ç”±å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ²¡æœ‰å†™socks5çš„å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬æš‚æ—¶ä½¿ç”¨curlæ¥ä»£æ›¿socks5å®¢æˆ·ç«¯ã€‚ æˆ‘ä»¬ç¬¬ä¸€æ¬¡æ”¶åˆ°è¿™æ ·æ ¼å¼çš„æ•°æ®ã€‚ +â€”-+â€”â€”â€”-+â€”â€”â€”-+|VER | NMETHODS | METHODS |+â€”-+â€”â€”â€”-+â€”â€”â€”-+| 1 | 1 | 1 to 255 |+â€”-+â€”â€”â€”-+â€”â€”â€”-+ ç¬¬ä¸€ä¸ªVERè¡¨ç¤ºå®¢æœç«¯é‡‡ç”¨çš„socksç‰ˆæœ¬ï¼Œä¾‹å¦‚socks5ç‰ˆæœ¬å°±ä¼šæ˜¯0x05ã€‚ ç¬¬äºŒä¸ªå‚æ•°NMETHODSè¡¨ç¤ºå®¢æˆ·ç«¯æ”¯æŒçš„éªŒè¯ç±»å‹çš„æ•°é‡ã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°METHODSï¼Œæ¯ä¸€ä½è¡¨ç¤ºä¸€ä¸ªéªŒè¯ç±»å‹ã€‚ å½“å‰å®šä¹‰çš„æ–¹æ³•æœ‰ï¼šÂ· Xâ€™00â€™ ä¸éœ€è¦è®¤è¯Â· Xâ€™01â€™ GSSAPIÂ· Xâ€™02â€™ ç”¨æˆ·å/å¯†ç Â· Xâ€™03â€™ â€“ Xâ€™7Fâ€™ ç”±IANAåˆ†é…Â· Xâ€™80â€™ â€“ Xâ€™FEâ€™ ä¸ºç§äººæ–¹æ³•æ‰€ä¿ç•™çš„Â· Xâ€™FFâ€™ æ²¡æœ‰å¯ä»¥æ¥å—çš„æ–¹æ³• è€Œæˆ‘ä»¬æ¥æ”¶åˆ°å®¢æœç«¯ä¿¡æ¯åï¼Œåˆ¤æ–­æ˜¯å¦å’Œè‡ªå·±æ”¯æŒçš„ç‰ˆæœ¬æ˜¯å¦ä¸€æ ·ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªéªŒè¯æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼ è¾“0xFFã€‚ ä¸‹é¢æ˜¯nodeçš„ä»£ç å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// å¯†ç éªŒè¯å¤„ç†ï¼Œåé¢ä¼šå®ç°const passwordVerity = require(&apos;./password-verify.js&apos;);// æš‚æ—¶åªå†™äº†ä¸‰ä¸ªéªŒè¯æ–¹å¼const AuthMethods = &#123; NOAUTH: 0, // ä¸éœ€è¦éªŒè¯ GSSAPI: 1, // GSSAPIéªŒè¯ USERPASS: 2, // ç”¨æˆ·å/å¯†ç  éªŒè¯&#125;;function shakehand(chunk) &#123; let socket = this; const VERSION = parseInt(chunk[0], 10); // å®¢æˆ·ç«¯æ”¯æŒçš„è®¤è¯æ–¹å¼çš„æ•°é‡ const NMETHODS = parseInt(chunk[1], 10); // åˆ¤æ–­å®¢æˆ·ç«¯socksçš„ç‰ˆæœ¬ if (VERSION !== 5) &#123; socket.destroyed || socket.destroy(); return false; &#125; // è·å–å®¢æˆ·ç«¯æ”¯æŒçš„æ‰€æœ‰çš„ç±»å‹ socket.methods = []; for (let i = 1; i &lt;= NMETHODS; i++) &#123; socket.methods.push(chunk[1 + i]); &#125; // åˆ¤æ–­æ˜¯å¦æ”¯æŒç”¨æˆ·å/å¯†ç  éªŒè¯ let isSupportPassrod = socket.methods.find(method =&gt; method === AuthMethods.USERPASS); // å¦‚æœä¸æ”¯æŒå°±è¿”å› æ²¡æœ‰å¯ä»¥æ¥å—çš„æ–¹æ³• if (typeof isSupportPassrod === &apos;undefined&apos;) &#123; let res = new Buffer([VERSION, 0xFF]); socket.write(res); socket.destroyed || socket.destroy(); return false; &#125; // è¿”å›ç‰ˆæœ¬å’Œéœ€è¦è´¦å·å¯†ç æ¥éªŒè¯ let res = new Buffer([VERSION, AuthMethods.USERPASS]); socket.write(res); // ç›‘å¬ä¸‹ä¸€æ¬¡çš„æ•°æ®ï¼Œæ¥è¿›è¡Œè´¦å·å¯†ç æ¥éªŒè¯ socket.once(&apos;data&apos;, passwordVerity.bind(socket)); return false;&#125;module.exports = shakehand; sock5ä»£ç†nodeå®ç°(2)sock5ä»£ç†nodeå®ç°(3)","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"},{"name":"socks","slug":"socks","permalink":"http://wangyuekai.com/tags/socks/"},{"name":"proxy","slug":"proxy","permalink":"http://wangyuekai.com/tags/proxy/"}]},{"title":"(è½¬è½½)å¦ç„¶é¢å¯¹ï¼šåº”å¯¹å‰ç«¯ç–²åŠ³","date":"2017-07-16T13:37:57.000Z","path":"2017/07/16/not-an-imposter-fighting-front-end-fatigue/","text":"æœ¬æ–‡è½¬è½½è‡ªï¼šä¼—æˆç¿»è¯‘è¯‘è€…ï¼šå­¦ä¼šå¾®ç¬‘å®¡æ ¡: huangxiaolué“¾æ¥ï¼šhttp://www.zcfy.cc/article/3509åŸæ–‡ï¼šhttps://www.smashingmagazine.com/2016/11/not-an-imposter-fighting-front-end-fatigue/ æˆ‘æœ€è¿‘å’Œä¸€ä¸ªåšåç«¯å¼€å‘çš„æœ‹å‹è®¨è®ºæˆ‘åœ¨å·¥ä½œä¹‹ä½™èŠ±äº†å¤šé•¿çš„æ—¶é—´å»å†™ç å’Œå­¦ä¹ å†™ç ã€‚ä»–ç»™æˆ‘çœ‹äº†Uncle Bobçš„ã€ŠClean Codeã€‹è¿™æœ¬ä¹¦ä¸­çš„ä¸€æ®µè¯ï¼Œå®ƒå°†éŸ³ä¹å®¶ä»¬ä¸ºå‡†å¤‡éŸ³ä¹ä¼šè€ŒèŠ±è´¹çš„æ—¶é—´ä¸å¼€å‘è€…è®©ä»£ç æ­£ç¡®æ‰§è¡Œæ‰€ç”¨çš„ç»ƒä¹ æ—¶é—´è¿›è¡Œäº†æ¯”è¾ƒã€‚ æˆ‘å–œæ¬¢è¿™ä¸ªç±»æ¯”ï¼Œä½†æ˜¯æˆ‘ä¸è®¤ä¸ºæˆ‘å®Œå…¨è®¤åŒå®ƒï¼›é¦–å…ˆè¿™ç§æƒ³æ³•ä¼šå¯¼è‡´ç–²åŠ³ã€‚æˆ‘è®¤ä¸ºå¦‚æœä½ æƒ³è¿›ä¸€æ­¥ç£¨ç»ƒä½ çš„æŠ€æœ¯å¹¶æ‰©å¤§ä½ çš„æŠ€èƒ½é›†ï¼Œé‚£ä¹ˆè¿™æ˜¯å¾ˆå¥½çš„ï¼Œä½†æ˜¯è¦ä¸€å¤©ä¸­æ¯ä¸ªå°æ—¶éƒ½è¿™æ ·åšæ˜¯å¾ˆéš¾æŒç»­çš„ã€‚ å‰ç«¯ç–²åŠ³æ˜¯éå¸¸çœŸå®çš„ã€‚ æˆ‘çœ‹åˆ°è¿‡ä¸€äº›å…³äºJavaScriptç–²åŠ³çš„æ–‡ç« ï¼Œä½†æˆ‘è®¤ä¸ºé—®é¢˜è¿œä¸æ­¢äºè¿™ç§ç‰¹å®šçš„è¯­è¨€ã€‚ å…ˆæ¾„æ¸…ä¸€ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« ä¸æ˜¯åœ¨æŠ±æ€¨å‰ç«¯ç–²åŠ³å¦‚ä½•ç³Ÿç³•ï¼Œä»¥åŠæŠ€æœ¯å‘å±•å¤ªå¿«â€”â€” æˆ‘å–œæ¬¢æŠ€æœ¯è¿…é€Ÿå‘å±•ã€‚åŒæ ·çš„ï¼Œæˆ‘å¯ä»¥æ„Ÿå—åˆ°å®ƒæ˜¯å¦‚ä½•çš„åŠ¿ä¸å¯æŒ¡ï¼Œä¹Ÿä¼šæ—¶ä¸æ—¶åœ°æ„Ÿè§‰è‡ªå·±è¦è½ä¼äº†ã€‚ æ®æˆ‘æ‰€çŸ¥ï¼Œè¿™æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚ é¦–å…ˆä½œä¸ºä¸€ä¸ªå‰ç«¯å¼€å‘è€…ï¼Œä½ è®¤ä¸ºä½ çš„æŠ€èƒ½æ ‘é‡Œåº”å½“æœ‰ä»¥ä¸‹æ‰€æœ‰çš„æŠ€èƒ½: HTML (æ•´æ´ä»£ç ï¼Œè¯­ä¹‰åŒ–æ ‡ç­¾) CSS (æ¨¡å—åŒ–ï¼Œå¯ä¼¸ç¼©) CSS æ–¹æ³• (BEM, SMACSS, OOCSS) CSS é¢„å¤„ç†å™¨ (åƒLESS, SCSS, PostCSS) ç°ä»£ CSS (Flexbox, Grid) JS ç°ä»£ JS (ES6, Typescript) JS æ¡†æ¶ (Angular, React, Vue [æ›´å¤šçš„ä¹‹ååœ¨æ­¤æ’å…¥]ï¼‰ JS æ–¹æ³• (å‡½æ•°å¼ç¼–ç¨‹, é¢å‘å¯¹è±¡) JS åº“ (Immutable, Ramda, Lodash) å“åº”å¼è®¾è®¡åŸåˆ™ æµ‹è¯• (TDD) æµ‹è¯•æ¡†æ¶ (Jasmine, Karma) SVG WebGL åŠ¨ç”»æŠ€æœ¯ å¯è®¿é—®æ€§ å¯ç”¨æ€§ æ€§èƒ½ æ„å»ºå·¥å…· (Grunt, Gulp, NPM è„šæœ¬) èµ„æºæ‰“åŒ…å·¥å…· (WebPack, Browserify) NPM ç”Ÿæ€ç³»ç»Ÿ äº†è§£ä¸åŒæµè§ˆå™¨çš„æ€ªç™– æ•æ·æ–¹æ³• ç‰ˆæœ¬æ§åˆ¶ (é€šå¸¸æ˜¯ Git) è§†è§‰è®¾è®¡åŸºç¡€ è½¯æŠ€èƒ½ï¼Œæ—¶é—´ç®¡ç† å¯¹ä½¿ç”¨çš„åç«¯è¯­è¨€æœ‰åŸºæœ¬çš„äº†è§£ã€‚ æ­¤å¤–ï¼Œä½ è¿˜è¦æ¶‰è¶³æˆ–å±•æœ›è¿™äº›æŠ€æœ¯ï¼š Service workers Progressive Web Apps (PWA) Webç»„ä»¶åŒ– å…¶æ¬¡ï¼Œä½ çš„æ—¥å¸¸å·¥ä½œå¯èƒ½ä¸ä¼šå®Œå…¨è¦†ç›–è¿™äº›æŠ€èƒ½ï¼Œæˆ–è€…ä¸ä¼šè®©ä½ æœ‰æ—¶é—´å»å­¦æ‰€æœ‰æŠ€æœ¯ï¼Œå› æ­¤æ€æ ·æ‰èƒ½åœ¨ä½ çš„æ§åˆ¶ä¸‹å»ä¿è¯ä¼šæ‰€æœ‰çš„æŠ€èƒ½ï¼Ÿ å¼€å‘äººå‘˜å¬è§â€œProgressive Web Appsâ€ è¿™ç§æœ¯è¯­å¯èƒ½ä¼šæ„Ÿåˆ°ç•æƒ§ã€‚æ–°çš„æ–¹æ³•å’ŒæŠ€å·§å¯¼è‡´ç–²åŠ³æ„Ÿ â€”â€” å‰ç«¯ç–²åŠ³ã€‚ (å›¾ç‰‡æ¥æº) ç°åœ¨ä½œä¸ºè¿™äº›æŠ€æœ¯çš„æ¶ˆè´¹è€…ï¼Œä½ å¯èƒ½è¦åšçš„æ˜¯ï¼š è®¢é˜…ä¸€æ‰“ä¸åŒçš„å¼€å‘è€…å‘¨åˆŠç®€æŠ¥ æ·»åŠ Twitterè®¢é˜… å‚åŠ æ¯å‘¨èµ¶å·¥ä½œçš„å‰ç«¯å›¢é˜Ÿ åœ¨å·¥ä½œä¹‹å¤–æœ‰è½»æ¾çš„æ¸ é“èƒ½å’Œä¸€äº›å¼€å‘è€…äº¤æµ æŒ‰ç…§ç½‘ä¸Šçš„æ•™ç¨‹ (å¸Œæœ›ä¸æ˜¯è¿‡æ—¶çš„) ä½¿ç”¨è§†é¢‘è¯¾ç¨‹åŸ¹è®­ç½‘ç«™åƒ Frontend Masters ä¹°webå¼€å‘çš„ä¹¦ (å¸Œæœ›ä¸æ˜¯è¿‡æ—¶çš„) å‚åŠ æŠ€æœ¯èšä¼š å‚åŠ ä¼šè®® å‚åŠ åŸ¹è®­è¯¾ç¨‹ è€Œä½œä¸ºä¸€ä¸ªè´¡çŒ®è€…ï¼Œä½ å¯èƒ½è¦åšçš„æ˜¯ï¼š å†™åšå®¢/æ‚å¿—æ–‡ç«  æ¼”è®² ç›´æ’­ è´¡çŒ®å¼€æºé¡¹ç›® åšè‡ªå·±çš„ä¸šä½™é¡¹ç›® æœ€è¿‘æˆ‘å‘ç°æˆ‘çš„æ³¨æ„åŠ›è¢«åˆ†æ•£åˆ°ä¸‰ä»¶äº‹æƒ…ä¸Šï¼Œæˆ‘ç”¨ä¸‰åˆ†ä¹‹ä¸€çš„ç²¾åŠ›å†™ç€ä»£ç ï¼ŒåŒæ—¶æˆ´ç€è€³æœºä¸€è¾¹å¬åˆ«äººè®¨è®ºä»£ç ï¼Œä¸€è¾¹åœ¨Slackä¸Šè·Ÿåˆ«äººèŠä»£ç ã€‚æˆ‘å†³å®šé€‚å¯è€Œæ­¢â€”â€”æˆ‘çš„å…¨éƒ¨æ³¨æ„åŠ›éƒ½è¢«ä»£ç æ‰€å æ®ã€‚æˆ‘å·²ç»ç²¾ç–²åŠ›ç«­äº†ã€‚ è™½ç„¶è¿™è‚¯å®šæ˜¯æç«¯æƒ…å†µï¼Œä½†æˆ‘ç›¸ä¿¡å…¶ä»–äººä¹Ÿç»å†è¿‡ç±»ä¼¼çš„äº‹æƒ…ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œä½ å¯èƒ½æœ‰ä¸€ä»½å…¨èŒå·¥ä½œï¼Œå®¶åº­ï¼Œæœ‹å‹ï¼Œä¸šä½™çˆ±å¥½ã€‚éš¾æ€ªæˆ‘ä»¬ä¸­æœ‰é‚£ä¹ˆå¤šäººæ„Ÿè§‰åŠ›ä¸ä»å¿ƒå¹¶ä¸”æ€€ç–‘æˆ‘ä»¬æ˜¯å¦åšäº†æ­£ç¡®çš„èŒä¸šé€‰æ‹©ã€‚ æˆ‘çš„ä¸€äº›å‰ç«¯åŒäº‹éƒ½è¡¨ç¤ºæƒ³è¦æ‰“åŒ…èµ°äººï¼Œç„¶åæ¢ä¸€ä¸ªå¯ä»¥åœ¨äº”ç‚¹ç»“æŸçš„å·¥ä½œã€‚ä½†æˆ‘è®¤ä¸ºå‰ç«¯å·¥ä½œä»æ—§å¸å¼•ç€æŸäº›çš„äººï¼Œè€Œå¦‚æœæ”¾å¼ƒè¿™ä»½å·¥ä½œï¼Œæˆä¸ºä¸€ä¸ªæˆ¿åœ°äº§ç»çºªäººï¼Œä½ ä»ç„¶æƒ³å°½ä½ çš„å¯èƒ½æˆä¸ºæœ€å¥½çš„æˆ¿åœ°äº§ç»çºªäººã€‚åœ¨ä½ çš„ç©ºé—²æ—¶é—´ä½ è¿˜æ˜¯ä¼šå‚åŠ æˆ¿åœ°äº§ä¼šè®®å’Œè·Ÿè¸ªæˆ¿ä»·è¶‹åŠ¿ã€‚å¾ˆå¤šä¸ªæœˆä»¥å‰ï¼Œæˆ‘åœ¨é‡‘èä¸šå·¥ä½œï¼Œæ™šä¸Šæˆ‘è¿˜åœ¨å­¦ä¹ ï¼Œé˜…è¯»ç›¸å…³èµ„æ–™ï¼Œæƒ³æˆä¸ºæˆ‘æ‰€é€‰æ‹©é¢†åŸŸä¸­æŠ€èƒ½æœ€ä½³çš„äººã€‚ å¹¶ä¸æ˜¯åªæœ‰è¿™ä¸ªé¢†åŸŸéœ€è¦ä»˜å‡ºå·¨å¤§çš„ç²¾åŠ›ï¼Œè®¸å¤šèŒä¸šéœ€è¦æŠ•å…¥å¤§é‡çš„ç²¾åŠ›å¹¶ä¸”åœ¨å·¥ä½œä¹‹å¤–å­¦ä¹ ã€‚ä¹Ÿè®¸å‰ç«¯å¼€å‘çš„ç‰¹æ®Šä¹‹å¤„åœ¨äºæŠ€æœ¯å‘å±•å¾—å¦‚æ­¤è¿…é€Ÿï¼Œä»¥è‡³äºå¥½åƒæœ‰äººä¸€ç›´åœ¨ç§»åŠ¨ç›®æ ‡å²—ä½ã€‚è¿™å°±åƒæ¯éš”ä¸€å¤©æˆ‘å°±ä¼šæ”¶åˆ°ä¸€å°ç”µå­é‚®ä»¶ï¼Œä¸Šé¢å†™ç€â€œXYZâ€æŠ€æœ¯å·²æ­»ã€‚æˆ‘ç¡®å®šè¿™ä¸æ˜¯çœŸçš„ï¼Œå¦åˆ™æˆ‘ä»¬å°±æ²¡æœ‰æŠ€æœ¯å¯ç”¨äº†ã€‚ ç”Ÿæ€ç³»ç»Ÿå¤„äºä¸æ–­å˜åŒ–çš„çŠ¶æ€ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä»¶å¥½äº‹ã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘å–œæ¬¢æ‰®æ¼”ä¸€ä¸ªå¯ä»¥ä¸æ–­åœ°å­¦ä¹ ã€å‘å±•å’Œç£ä¿ƒè‡ªå·±çš„è§’è‰²ï¼Œä½†è¿™å¹¶ä¸æ˜¯è¯´æˆ‘ä¸ä¼šå¶å°”æ„Ÿåˆ°ä¸çŸ¥æ‰€æªã€‚ è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘å°è¯•è®°ä½è¿™äº›äº‹æƒ…ç”¨æ¥é˜»æ­¢æˆ‘æ®šç²¾ç«­è™‘ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸€äº›é¿å…ç–²åŠ³çš„é€šç”¨å»ºè®®ã€‚ æˆ‘ä»¬æ˜¯ä¸€æ ·çš„æˆ‘è®¤è¯†çš„å¼€å‘è€…ï¼Œæ— è®ºæ˜¯åœ¨å·¥ä½œä¸­è¿˜æ˜¯å·¥ä½œå¤–ï¼Œéƒ½æ˜¯æˆ‘è®¤è¯†çš„æœ€èªæ˜çš„äººã€‚ä½†ä»–ä»¬å…¨éƒ½ä¼šæ„Ÿåˆ°ä¸çŸ¥æ‰€æªã€‚å¤§å¤šæ•°äººéƒ½æœ‰ä¸€äº›å¸Œæœ›å­¦ä¹ çš„æŠ€æœ¯æ¸…å•ã€‚å¯èƒ½æœ‰å°‘æ•°äººçŸ¥é“æ‰€æœ‰æŠ€æœ¯ï¼Œè€Œä¸”åœ¨æ‰€æœ‰äº‹æƒ…ä¸Šéƒ½å¤„äºé¢†å…ˆåœ°ä½ï¼Œä½†æˆ‘ä»¬å¤§å¤šæ•°äººçš„å¤„å¢ƒå®Œå…¨ç›¸åŒã€‚ æˆ‘ä»¬ä»ç„¶ä¾èµ–Googleå’ŒStack Overflowæ¥åº¦è¿‡æˆ‘ä»¬çš„ä¸€å¤©ï¼Œæ‰“å¼€äº†è¶…å¤šçš„é€‰é¡¹å¡ï¼Œå…¨éƒ¨æ˜¯å…³äºWebç›¸å…³é—®é¢˜çš„ç­”æ¡ˆã€‚ä¸æ­¢ä½ ä¸€ä¸ªäººæ˜¯è¿™æ ·ï¼ è¦é«˜å…´åœ°çŸ¥é“ä½ ä¸æ˜¯ä¸€ä¸ªç³Ÿç³•çš„å¼€å‘äººå‘˜ï¼Œä½ åªæ˜¯è¿˜æ²¡æœ‰å°è¯•è¿‡é…·å­©å­ä»¬æ­£åœ¨ä½¿ç”¨çš„ä¸œè¥¿ã€‚ æ˜¯çš„ï¼Œå³ä½¿æ˜¯â€œwebåäººâ€ä¹Ÿæœ‰åŒæ ·çš„å›°å¢ƒâ€¦ ä½ ä¸å¯èƒ½çŸ¥é“æ‰€æœ‰çš„äº‹æƒ…ï¼Œè€Œä½ åœ¨Twitterä¸Šè¿½éšçš„æ˜æ˜Ÿå¼€å‘è€…åœ¨å°éƒ¨åˆ†çš„é¢†åŸŸä¸­è¡¨ç°å¾—éå¸¸å¥½ã€‚ä½ ä¼šæ³¨æ„åˆ°ï¼Œä»–ä»¬å‡ºåçš„é¢†åŸŸæ°å¥½æ˜¯ä»–ä»¬æ‰€ç†ŸçŸ¥çš„é¢†åŸŸã€‚å¯èƒ½ä¹Ÿä¼šæœ‰ä¾‹å¤–ï¼Œä½†ä»–ä»¬å’Œæˆ‘ä»¬ä¸€æ ·ä¹Ÿåªæ˜¯ä¸ªæ™®é€šäººã€‚:) å†’å……è€…ç»¼åˆå¾æ˜¯çœŸå®çš„ï¼Œæˆ‘ä»¬éƒ½æœ‰æˆ‘çŸ¥é“æœ‰æœ‰äº›ä¼˜ç§€çš„å‰ç«¯å¼€å‘äººå‘˜ä¸ä¼šç”³è¯·èŒä½ï¼Œå› ä¸ºä»–ä»¬åœ¨ä¸çŸ¥é“å·¥ä½œæè¿°è¦æ±‚ä¸Šçš„æ‰€æœ‰ä¸œè¥¿çš„æƒ…å†µä¸‹ï¼Œå°±è§‰å¾—è‡ªå·±æ˜¯ä¸ªéª—å­ã€‚å¼•ç”¨å…¶ä¸­ä¸€ä¸ªï¼š â€œæˆ‘çœ‹åˆ°çš„90%çš„JDsï¼Œä¼šè®©æˆ‘æ„Ÿè§‰â€œå•Šï¼Œæˆ‘å¤ªè½åï¼â€ ã€‚äº‹å®ä¸Šï¼Œè¿™è®©æˆ‘å¾ˆå›°æ‰°ï¼Œæˆ‘æƒ³ç•™åœ¨æˆ‘ç°åœ¨çš„èŒä½ï¼Œè¯•å›¾èµšæ›´å¤šçš„é’±ï¼Œåªæ˜¯å› ä¸ºè¿™æ ·è®©æˆ‘è§‰å¾—æˆ‘å·²ç»â€œæ‘†è„±å®ƒâ€ã€‚â€ äº‹å®ä¸Šï¼Œå¤§éƒ¨åˆ†çš„å·¥ä½œè¯´æ˜éƒ½æ˜¯é—¹å‰§ã€‚æˆ‘çš„æœ‹å‹BÃ¥rdæŠŠè¿™äº›è¯´æ˜æ”¾åœ¨ä¸€å¼ å¤§çš„å›¾ç‰‡ï¼Œæ¥å±•ç¤ºå‡ºå‰ç«¯å·¥ä½œè¦æ±‚å’Œå®ƒä»¬çš„çœŸæ­£å«ä¹‰ä¹‹é—´çš„åŒºåˆ«ã€‚ æ‹›è˜å¹¿å‘Šçš„è§£é‡Š (å›¾ç‰‡æ¥æº) (å›¾ç‰‡æ¥æº) åªè¦è®°ä½ï¼Œä¼šå˜å¥½çš„ã€‚æˆ‘æ‰€åšçš„æ¯ä¸€é¡¹å·¥ä½œï¼Œæˆ‘éƒ½è§‰å¾—è‡ªå·±ä¸å¤Ÿæ·±å…¥ï¼Œä½†æœ€ç»ˆä½ ä¼šä¹ æƒ¯ä»–ä»¬çš„å·¥å…·å’Œå·¥ä½œæµç¨‹ï¼Œä½ ä¼šå­¦ä¹ å¹¶æˆä¸ºä¸€ä¸ªæ›´å¥½çš„å¼€å‘äººå‘˜ã€‚ ä¸è¦å®³æ€•åœ¨å·¥ä½œä¸­å­¦ä¹ ï¼ŒæŒæ¡æ–°æŠ€èƒ½çš„æœ€ä½³æ–¹æ³•æ˜¯æ¯å¤©ä½¿ç”¨å®ƒä»¬ã€‚ å¦‚æœä½ æœ‰å†’å……è€…ç»¼åˆå¾ï¼Œå¯èƒ½ä½ æ˜¯ä¸ªæ­£æ´¾çš„å¼€å‘è€…ï¼Œå¦åˆ™ä½ å°±ä¸ä¼šè‡ªè§‰åœ°æ„è¯†åˆ°å®ƒã€‚ å·©å›ºåŸºç¡€äººä»¬å¾ˆå®¹æ˜“è¢«è€€çœ¼çš„æ–°äº‹ç‰©åˆ†å¿ƒï¼Œä½†æ˜¯å¦‚æœä½ çš„åŸºç¡€è¿˜ä¸ç‰¢å›ºï¼Œé‚£ä¹ˆä½ æ‰€å»ºé€ çš„ä¸œè¥¿å°†ç»å—ä¸ä½æ—¶é—´çš„è€ƒéªŒã€‚ å°±åƒæˆ‘çš„ä¸€ä¸ªå¥½æœ‹å‹æ›¾ç»å¯¹æˆ‘è¯´çš„ï¼š â€œä¸“æ³¨äºåŸºç¡€ä¸€ç›´æ˜¯æˆ‘çš„å£å¤´ç¦…ã€‚ä½ èƒ½å»ºç«‹è‰¯å¥½çš„é¡¹ç›®ï¼ˆSHï¼Tï¼‰å’Œè§£å†³é—®é¢˜ï¼Œè¿™æ‰æ˜¯æœ€é‡è¦çš„ï¼Œè€Œä½ å¦‚ä½•è§£å†³å®ƒä»¬ï¼ˆæ‰€ä½¿ç”¨çš„å·¥å…·ï¼‰å·²ç»å¹¶å°†æ°¸è¿œæ”¹å˜ã€‚â€ ä¾‹å¦‚ï¼Œå½“reactä¸€è·ƒæˆåï¼Œå®ƒä¼¼ä¹æ€»æ˜¯å’ŒES6æ†ç»‘åœ¨ä¸€èµ·ï¼Œæˆ‘æŠŠé‡ç‚¹æ”¾åœ¨è¯­è¨€çš„é‚£äº›æ”¹å˜å’Œæ–°ç‰¹æ€§ä¸Šè€Œä¸æ˜¯æ¡†æ¶æœ¬èº«çš„ç»†å¾®å·®åˆ«ã€‚ä¸€æ—¦reactä¸ç«äº†ï¼Œæˆ‘ä»æœ€æ–°çš„JavaScriptä¸Šå­¦åˆ°çš„çŸ¥è¯†å°†ç»§ç»­å­˜åœ¨ä¸‹å»ã€‚ä½ å¯ä»¥åœ¨åŸç”Ÿchromeç©å¾ˆå¤šç‰¹æ€§ï¼Œè€Œä¸ç”¨å¼•å…¥Babelé™·å…¥ä¾èµ–åœ°ç‹±ã€‚ ä¸ç”¨å­¦æ‰€æœ‰çš„è¿™çœŸçš„å¾ˆå…³é”®ã€‚æˆ‘è®¤ä¸ºæ­£åœ¨æ‰¼æ€æˆ‘ä»¬çš„ä¸æ˜¯æ–°æ¡†æ¶ã€åº“å’Œæ¨¡å—ï¼Œè€Œæ˜¯æˆ‘ä»¬è‡ªå·±å¿…é¡»æŠŠå®ƒä»¬å…¨éƒ¨å­¦ä¼šçš„ä¿¡å¿µã€‚ é€šè¿‡å­¦ä¹ æˆ‘å‘ç°æœ€å¥½çš„åŠæ³•æ˜¯ä¸“æ³¨â€”â€”æ­¤åˆ»æˆ‘æ­£åœ¨é’»ç ”ES6ä¸­çš„JavaScriptå‡½æ•°å¼ç¼–ç¨‹ã€‚ æˆ‘çš„æ¸…å•ä¸Šè¿˜æœ‰å¾ˆå¤šæˆ‘æƒ³å­¦çš„ä¸œè¥¿ï¼Œä½†æˆ‘å°½é‡ä¸åˆ†å¿ƒã€‚ä¾‹å¦‚ï¼Œæˆ‘å–œæ¬¢æ¸©ä¹ æˆ‘ä¼šçš„çŸ¥è¯†ï¼Œç©Polymerï¼Œé’»ç ”ä¸€äº›æœ€æ–°çš„CSSæŠ€æœ¯ï¼Œæ¯”å¦‚Gridï¼Œä½†æ˜¯å¦‚æœæˆ‘ä¸€æ¬¡å¼€å§‹é˜…è¯»å¤ªå¤šä¸åŒçš„é¢†åŸŸï¼Œæˆ‘å¾—ä¸åˆ°æ‰€æœ‰çš„ä¿¡æ¯ã€‚è¿™äº›åˆ«çš„ä¸œè¥¿å“ªå„¿ä¹Ÿå»ä¸äº†ï¼Œå†æ¬¡çœ‹åˆ°çš„æ—¶å€™å°±èƒ½è”æƒ³åˆ°ä»–ä»¬ã€‚ é¿å…åœ¨æŸä¸€ä¸»é¢˜ä¸ŠåŒ†å¿™å°è¯•ä½¿ç”¨ä¸€åˆ‡ã€‚ æ…¢æ…¢æ¥ï¼Œç¡®ä¿ä½ å®Œå…¨ç†è§£å®ƒã€‚ å¦‚æœä½ åƒæˆ‘ä¸€æ ·ï¼Œä½ ä¼šæœ‰ä¸€ä¸ªä¸æ–­å¢é•¿çš„æ¸…å•ï¼Œä½†ä¸è¦å®³æ€•ä»ä¸­å‰”é™¤é¡¹ç›®ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„äº‹æƒ…éƒ½å€¼å¾—æŠ•å…¥æ—¶é—´ï¼Œä½ åº”è¯¥è¯•ç€å»è®¤è¯†å“ªäº›æ˜¯å€¼å¾—å­¦ä¹ çš„ï¼Œå“ªäº›å¯èƒ½åœ¨å‡ å¹´å†…æ¶ˆå¤±ã€‚èŠ±æ—¶é—´æ¥å­¦ä¹ ç¼–ç¨‹çš„è®¾è®¡æ¨¡å¼å’Œæ¶æ„æŠ€æœ¯ï¼Œç›¸æ¯”äºæŠ•å…¥åœ¨å½“å‰ç«çš„æ¡†æ¶ï¼Œåœ¨é•¿è¿œä¸Šæ¥çœ‹ï¼Œæ€»æ˜¯æ›´æœ‰ç›Šçš„ã€‚è„±ç¦»æˆé•¿è½¨è¿¹ï¼Œè¿‡ä¸äº†å¤šä¹…ä½ å°±ä¼šè¿·å¤±åœ¨è¿½é€ç©æµè¡Œè¯­çš„è¿‡ç¨‹ä¸­ã€‚ å¤§å¤šæ•°å…¬å¸æ²¡æœ‰ä½¿ç”¨å°–ç«¯æŠ€æœ¯ç°åœ¨æœ‰å¾ˆå¤šæ–°çš„ä¸œè¥¿å‡ºç°ï¼Œwebæ­£åœ¨ä»¥æƒŠäººçš„é€Ÿåº¦å‘å±•ï¼Œä½†é€šå¸¸ä¼ä¸šçœŸæ­£åœ¨ä¸šåŠ¡ä¸­å¼€å§‹é‡‡ç”¨è¿™äº›æ–°æŠ€æœ¯ï¼Œéœ€è¦å¾ˆé•¿çš„æ—¶é—´ã€‚å¤§å¤šæ•°å…¬å¸ä¼šç­‰ä¸€æ®µæ—¶é—´å¾…æŠ€æœ¯æˆç†Ÿï¼Œå¹¶çœ‹åˆ°å®ƒåœ¨é¢†åŸŸä¸­è¢«è®¤å¯ã€‚ Angular æ˜¯å…­å¹´å‰åˆ›å»ºçš„ï¼Œæˆ‘åˆšå¼€å§‹åœ¨ä¸€å®¶åˆåˆ›å…¬å¸å·¥ä½œï¼Œä»–è®¤ä¸ºè¿™æ˜¯ä¸‰å¹´å‰çš„æ¡†æ¶ã€‚Reactjs å·²ç»æœ‰å¤§çº¦ä¸‰å¹´çš„å†å²äº†ï¼Œæˆ‘ç°åœ¨çš„å…¬å¸ä»…åœ¨ä»Šå¹´åœ£è¯èŠ‚å‰æ‰å¼€å§‹ä½¿ç”¨å®ƒã€‚æˆ‘ç¡®ä¿¡æœ‰å¾ˆå¤šå…¶ä»–çš„æ¡†æ¶åœ¨åŒä¸€æ—¶é—´å‡ºç°æˆ–è€…æ¶ˆå¤±ã€‚å¦‚æœæ‰€æœ‰çš„æˆ‘éƒ½è¦å»ç ”ç©¶ï¼Œæˆ‘ä¼šå‘ç–¯çš„ã€‚ åœ¨CSSé¢†åŸŸï¼Œflexboxåœ¨2010å¹´å°±å¯ä»¥ç”¨äº†â€”â€”å…­å¹´å‰ï¼ä½†æ˜¯æµè§ˆå™¨åˆ°ç°åœ¨æ”¯æŒä»ç„¶æœ‰é™ã€‚æˆ‘ä»¬ä»Šå¹´æ—©äº›æ—¶å€™å¼€å§‹åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å®ƒï¼Œè€Œä¸”æˆ‘ä¹Ÿä¸è®¤ä¸ºå®ƒåœ¨å…¶ä»–åœ°æ–¹è¢«å¹¿æ³›ä½¿ç”¨ã€‚ æˆ‘çš„æ„æ€æ˜¯ï¼Œä¸å¿…æ€¥äºå­¦ä¹ æ‰€æœ‰çš„ä¸œè¥¿ï¼Œè™½ç„¶æŠ€æœ¯å¯èƒ½ä¼šå¾ˆå¿«å‘å±•ï¼Œä½†ä½ çš„æ½œåœ¨é›‡ä¸»æ­£åœ¨ä»¥è¾ƒæ…¢çš„é€Ÿåº¦å‰è¿›ã€‚ä½ ä¸å¿…èµ°åœ¨æ›²çº¿çš„å‰é¢ï¼Œåªæ˜¯è¦ç¡®ä¿ä½ åœ¨è§‚å¯Ÿå®ƒçš„è½¨è¿¹ã€‚ ä½ å­¦çš„è¶Šå¤šï¼Œä½ ä¼šå‘ç°ä½ ä¸çŸ¥é“çš„ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œè¿™æ²¡å…³ç³»è¿™æ˜¯å®Œå…¨æ­£å¸¸çš„ã€‚å½“ä½ åˆšå¼€å§‹çš„æ—¶å€™ï¼Œä½ ä¸çŸ¥é“ä½ ä¸çŸ¥é“ä»€ä¹ˆã€‚ç„¶åä½ ä¼šå­¦ä¹ ä¸€äº›ä¸œè¥¿å¹¶ä¸”è®¤ä¸ºä½ æ˜¯ä¸€ä¸ªå¤©æ‰ã€‚ç„¶åï¼Œæ¸æ¸åœ°ï¼Œè¿™ç§å¹»è§‰è¢«æ‰“ç ´ï¼Œä½ å¼€å§‹ç†è§£äº‹å®ä¸Šåœ¨è¿™ä¹‹å¤–ä½ æœ‰å¤šå°‘ä¸œè¥¿ä¸çŸ¥é“ã€‚ ä»æœ¬è´¨ä¸Šè¯´ï¼Œä½ å¾—åˆ°çš„ç»éªŒè¶Šå¤šï¼Œä½ è¿›å…¥çš„ç©ºè™šå°±è¶Šæ·±ã€‚ä½ éœ€è¦è·Ÿè¿™ä¸ªå’Œå¹³ç›¸å¤„ï¼Œå¦åˆ™å®ƒä¼šæ¶ˆè€—ä½ ã€‚å¦‚æœæœ‰çš„è¯ï¼Œè¿™ç§æ„Ÿè§‰ä¼šè®©ä½ ç›¸ä¿¡ä½ æ­£æœç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚åœ¨æˆ‘ä»¬é€‰æ‹©çš„èŒä¸šä¸­ï¼Œä½ æ°¸è¿œä¸ä¼šèˆ’èˆ’æœæœåœ°å­¦ä¼šæ‰€æœ‰å‰ç«¯çŸ¥è¯†ã€‚ ä¸è¦æŠŠä½ æ‰€æœ‰çš„ä¸šä½™æ—¶é—´éƒ½èŠ±åœ¨å­¦ä¹ ä¸Šä½ å¾ˆå®¹æ˜“å°±æ„Ÿè§‰åˆ°ä½ è¿œè¿œè½åï¼Œéœ€è¦æ¯åˆ†é’Ÿéƒ½å»ç¼–ç å’Œå­¦ä¹ ã€‚è¿™æ˜¯ä¸€å¼ é€šå¾€èŒä¸šç–²å€¦çš„å•ç¨‹ç¥¨ã€‚ç•™ä¸€äº›æ—¶é—´æ¥å‘å±•ä½ çš„æŠ€èƒ½ï¼Œçœ‹çœ‹ä½ æ˜¯å¦å¯ä»¥ä¸ä½ çš„è€æ¿åå•†ä¸€äº›æ—¶é—´æ¥ä¿è¯ä½ çš„å­¦ä¹ æ—¶é—´ï¼Œç„¶åç”¨å‰©ä¸‹çš„æ—¶é—´æ¥åšä½ çˆ±åšçš„äº‹ã€‚ æˆ‘å·²ç»åˆ†å‡ºä¸€ç‚¹å†™ä»£ç çš„æ—¶é—´åœ¨å¥èº«æˆ¿ã€‚é”»ç‚¼å¯¹ä½ çš„èº«å¿ƒéƒ½æ˜¯æå…¶é‡è¦çš„ã€‚å°è¯•æ¯å¤©è‡³å°‘åš20åˆ°30åˆ†é’Ÿï¼Œå¯ä»¥ä¿æŒå¤´è„‘æ¸…é†’ï¼Œé˜²æ­¢ç–²åŠ³ã€‚ ç»™ä½ çš„å®¶äººå’Œæœ‹å‹ç•™å‡ºæ—¶é—´ï¼Œå°½é‡ä¸è¦å’Œä»–ä»¬è°ˆå·¥ä½œï¼ ç°åœ¨æ˜¯å¼€å‘è€…çš„å¸‚åœºç›®å‰ä¸è¦æ‹…å¿ƒæ‰¾ä¸åˆ°å·¥ä½œã€‚æ­¤æ—¶æˆ‘ä»¬æ­£å¤„äºä¸€ä¸ªéå¸¸å¹¸è¿çš„ç‚¹ï¼Œç­‰å¾…å¡«å……çš„å²—ä½è¿œæ¯”å¼€å‘è€…è¦å¤šã€‚æˆ‘ä¸çŸ¥é“è¿™å°†æŒç»­å¤šä¹…ï¼Œä½†ç°åœ¨å¥½å¥½æŠŠæ¡å®ƒï¼ ä½ å¯ä»¥åœ¨ä¸çŸ¥é“æ‰€æœ‰æŠ€æœ¯çš„æƒ…å†µä¸‹å¾—åˆ°ä¸€ä»½å·¥ä½œã€‚æˆ‘å‘ç°ï¼Œåœ¨æˆ‘é¢è¯•è¿‡çš„äººä¸­ï¼Œ99%çš„äººå®Œå…¨æ˜¯åœ¨å¹ç‰›ã€‚ æœ€åçš„æƒ…å†µï¼Œè®°ä½é—ç•™ä»£ç ä¸­æœ‰é»„é‡‘ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªå–œæ¬¢è€æ–¹å¼çš„å¼€å‘äººå‘˜ï¼Œæ€»æ˜¯ä¼šæœ‰ä¸€äº›å…¬å¸ä¾èµ–äºä¼ ç»ŸæŠ€æœ¯ï¼Œéœ€è¦å¼€å‘äººå‘˜åœ¨ä»–ä»¬çš„è½¯ä»¶ä¸Šå·¥ä½œã€‚ ç»“è®ºæˆ‘å¸Œæœ›å…¶ä¸­çš„ä¸€äº›ç‚¹æœ‰åŠ©äºå‡è½»ä½ å¯èƒ½æ„Ÿåˆ°çš„ä¸€äº›æŒ«æŠ˜ã€‚ä½ èƒ½åšçš„æœ€ç³Ÿç³•çš„äº‹å°±æ˜¯åˆ°è¾¾è¾¹ç¼˜ï¼Œå®Œå…¨è¢«çƒ§å°½ï¼Œå› ä¸ºä¸€æ—¦ä½ è¿™æ ·ï¼Œå¾ˆéš¾æ¢å¤ä½ å¯¹ä½ æ‰€åšçš„äº‹æƒ…çš„çƒ­æƒ…ï¼Œä»¥åŠä½ è¿™ä¹ˆåšçš„åˆè¡·ã€‚ æ’¸ç æ„‰å¿«ï¼ (aa, il)","tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://wangyuekai.com/tags/å‰ç«¯/"}]},{"title":"è®©ä½ å¤‡å—åˆ®ç›®ç›¸çœ‹çš„8ä¸ªnpmæŠ€å·§","date":"2017-07-06T02:56:33.000Z","path":"2017/07/06/npm-skills/","text":"æœ¬æ–‡è½¬è½½è‡ªï¼šä¼—æˆç¿»è¯‘è¯‘è€…ï¼šliuhui_is_meé“¾æ¥ï¼šhttp://www.zcfy.cc/article/3362åŸæ–‡ï¼šhttps://medium.freecodecamp.com/8-npm-tricks-you-can-use-to-impress-your-colleagues-dbdae1ef5f9e ä½ è§‚çœ‹ä¸€ä¸ªåŒäº‹ç¼–ç æ—¶å€™ï¼Œä½ ä¼šçœ‹åˆ°ä¸€äº›é€Ÿè®°å’ŒæŠ€å·§è¢«åº”ç”¨ï¼Œæœ‰äº›æ–¹å¼ä½ å¹¶ä¸ç†Ÿæ‚‰ï¼Œé‚£ä½ å°±è¢«é„™è§†äº†ï¼Œè¿™ç§äº‹æƒ…åœ¨æˆ‘ä»¬æ¯ä¸€ä¸ªä¸€ç”Ÿéƒ½ä¼šå‘ç”Ÿçš„ã€‚ åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»‹ç»ä¸€äº›å¾ˆæœ‰ç”¨çš„npmæŠ€å·§ï¼Œè¿˜æœ‰å¾ˆå¤šè¿™é‡Œå¹¶ä¸èƒ½å…¨æ”¶å½•ï¼Œæˆ‘ä»¬åªå…³æ³¨é‚£äº›ç›¸å…³çš„å¹¶ä¸”æœ‰ç›Šäºæˆ‘ä»¬æ¯å¤©çš„å·¥ä½œå’Œå¼€å‘çš„æŠ€å·§ã€‚ åŸºæœ¬çš„é€Ÿè®°ä¸ºäº†è®©å¤§å®¶çš„å¯¹npmæœ‰ä¸€ä¸ªä¸€è‡´çš„ç†è§£ï¼Œå°¤å…¶æ˜¯æˆ‘ä»¬çš„æ–°äººï¼Œè®©æˆ‘ä»¬å¿«é€Ÿäº†è§£åŸºæœ¬çš„é€Ÿè®°å’Œç¡®ä¿æ²¡æœ‰é”™è¿‡ä»»ä½•ç»†èŠ‚ã€‚ å®‰è£…å®‰è£…åŒ…å¸¸è§„: npm install pkg, é€Ÿè®°: npm i pkg. å…¨å±€å®‰è£…åŒ…:å¸¸è§„: npm i --global pkg, é€Ÿè®°: npm i -g pkg. å®‰è£…åŒ…å¹¶åŒ…å«åœ¨ä¾èµ–ä¸­:å¸¸è§„: npm i --save pkg, é€Ÿè®°: npm i -S pkg. å®‰è£…åŒ…å¹¶åŒ…å«åœ¨å¼€å‘ä¾èµ–ä¸­:å¸¸è§„: npm i --save-dev pkg, é€Ÿè®°: npm i -D pkg. å…¶ä»–çš„npmé€Ÿè®°é˜…è¯»npmåšå®¢ é€Ÿè®°è¡¨. ä¸‹é¢å¼€å§‹æœ‰è¶£çš„å†…å®¹ã€‚ 1. åˆå§‹åŒ–ä¸€ä¸ªæ–°åŒ…æˆ‘ä»¬éƒ½çŸ¥é“npm initï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…ã€‚ ä½†æ˜¯ï¼Œæ‰€æœ‰çš„é—®é¢˜éƒ½æ˜¯åŒ¿åçš„ï¼Œæˆ‘ä»¬æ— è®ºå¦‚ä½•éƒ½ä¼šä¿®æ”¹å®ƒçš„ï¼Œé‚£ä¹ˆæ€ä¹ˆé¿å…å‘ç”Ÿå‘¢ï¼Ÿ ä½¿ç”¨npm init -y å’Œ npm init -få›åˆ°åˆå§‹åŒ–ï¼ 2. è¿è¡Œæµ‹è¯•å‘½ä»¤å¦ä¸€ä¸ªå‘½ä»¤å°±æ˜¯npm test,æˆ‘ä»¬å¯èƒ½æ¯å¤©ä½¿ç”¨ä¾æ¬¡æˆ–è€…ä¸€å¤©ä½¿ç”¨å¥½å‡ æ¬¡ã€‚ å¦‚æœæˆ‘å‘Šè¯‰ä½ å¯ä»¥ä½¿ç”¨å°‘äº40%çš„å­—ç¬¦å»å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Ÿæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ï¼Œåº”è¯¥è¿™æ ·ã€‚ å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨npm tï¼Œå®ƒå°±å¯ä»¥èƒœä»» 3. æšä¸¾å¯ç”¨çš„è„šæœ¬æˆ‘ä»¬å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å¦‚ä½•å¼€å§‹ã€‚æˆ‘ä»¬é€šå¸¸ä¼šé—®è‡ªå·±è¿™æ ·çš„é—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•è¿è¡Œå®ƒï¼Ÿå“ªäº›è„šæœ¬å¯ç”¨ï¼Ÿ ä¸€ä¸ªæ–¹æ³•æ˜¯æ‰“å¼€package.jsonæ–‡ä»¶å¹¶æ£€æŸ¥scriptséƒ¨åˆ†ã€‚ æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬åªæ˜¯è¿è¡Œnpm runå¾—åˆ°ä¸€ä¸ªçš„æ‰€æœ‰å¯ç”¨çš„è„šæœ¬çš„åˆ—è¡¨ã€‚ å¦å¤–çš„å¯ä»¥é€‰æ‹©æ˜¯å®‰è£…ntl (npm i -g ntl)ï¼Œç„¶åè¿è¡Œntlåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ã€‚å®ƒä¹Ÿå¯ä»¥è¿è¡Œè„šæœ¬ï¼Œä¹Ÿå¾ˆæ–¹é¢ã€‚ 4. æšä¸¾å·²ç»å®‰è£…çš„åŒ…ç±»ä¼¼äºå¯ç”¨çš„è„šæœ¬ï¼Œæœ‰æ—¶æˆ‘ä»¬ä¼šé—®è‡ªå·±æˆ‘ä»¬çš„é¡¹ç›®ä¸­æœ‰å“ªäº›ä¾èµ–é¡¹ã€‚ æˆ‘ä»¬å¯ä»¥å†æ¬¡æ‰“å¼€package.jsonæ–‡ä»¶å’Œæ£€æŸ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»åšçš„æ›´å¥½äº†ã€‚ ä½¿ç”¨ npm ls --depth 0. æšä¸¾å…¨å±€å®‰è£…åŒ…ï¼Œä½¿ç”¨npm ls -g --depth 0 5. è¿è¡Œæœ¬åœ°å®‰è£…çš„å¯æ‰§è¡Œæ–‡ä»¶æˆ‘ä»¬å®‰è£…äº†ä¸€ä¸ªåŒ…åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„ï¼Œä½†æˆ‘ä»¬åªèƒ½è¿è¡Œå®ƒé€šè¿‡ä¸€ä¸ªæ–°çš„è„šæœ¬ã€‚ä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ–è€…å¦‚ä½•å…‹æœå®ƒï¼Ÿ é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸ºä»€ä¹ˆâ€”â€”å½“æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œå®é™…å‘ç”Ÿçš„æ˜¯å®ƒåœ¨PATHç¯å¢ƒå˜é‡ä¸­åˆ—å‡ºçš„æ‰€æœ‰è·¯å¾„ä¸­æŸ¥æ‰¾ä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™å°±æ˜¯ä»–ä»¬å¦‚ä½•ç¥å¥‡åœ°ä»ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ‰§è¡Œã€‚æœ¬åœ°å®‰è£…çš„è½¯ä»¶åŒ…ç™»è®°ä»–ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨æœ¬åœ°ï¼Œæ‰€ä»¥ä»–ä»¬ä¸åœ¨æˆ‘ä»¬çš„PATHè·¯å¾„ä¸­å°†ä¸ä¼šè¢«å‘ç°ã€‚ å½“æˆ‘ä»¬è¿è¡Œè¿™äº›å¯æ‰§è¡Œæ–‡ä»¶é€šè¿‡ä¸€ä¸ªæ–°è„šæœ¬ï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿä½ å¯èƒ½ä¼šé—®ï¼Ÿå¾ˆå¥½çš„é—®é¢˜ï¼è¿™æ˜¯å› ä¸ºè¿™ç§æ–¹å¼è¿è¡Œæ—¶ï¼ŒNPMåšäº†ä¸€ç‚¹æŠ€å·§å’Œå¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„æ–‡ä»¶å¤¹åˆ°PATHï¼Œ/node_modules/.binä¸­ã€‚ä½ å¯ä»¥çœ‹åˆ°å®ƒçš„è¿è¡Œnpm run env | grep &quot;$PATH&quot;ã€‚ä½ ä¹Ÿå¯ä»¥è¿è¡Œåªæ˜¯npm run env æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ç¯å¢ƒå˜é‡ï¼Œnpmå¢åŠ äº†ä¸€äº›æ›´æœ‰è¶£çš„ä¸œè¥¿ã€‚/node_modules/.binï¼Œå¦‚æœä½ ä¸çŸ¥é“ï¼Œæ­£æ˜¯åœ¨æœ¬åœ°å®‰è£…çš„è½¯ä»¶åŒ…æ”¾ç½®å¯æ‰§è¡Œæ–‡ä»¶çš„åœ°æ–¹ã€‚ æˆ‘ä»¬å¯ä»¥è¿è¡Œ ./node_modules/.bin/mocha åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œçœ‹çœ‹å°†ä¼šå‘ç”Ÿä»€ä¹ˆ. å¾ˆç®€å•, å¯¹å§? ä»…ä»…è¿è¡Œ ./node_modules/.bin/ ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™ä½ æƒ³è¦è¿è¡Œæœ¬åœ°å·²å®‰è£…çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ 6. åœ¨ç½‘ä¸ŠæŸ¥æ‰¾ä½ æƒ³è¦çš„åŒ…ä½ å¯èƒ½çœ‹åˆ°äº†repositoryè¿™ä¸ªå…¥å£åœ¨package.jsonæ–‡ä»¶ä¸­ï¼Œç–‘é—®â€œè¿™æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿâ€ ä¸ºäº†é—®ç­”è¿™ä¸ªé—®é¢˜ï¼Œä»…ä»…è¿è¡Œnpm repoç„¶ååœ¨ä½ çš„æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚ ä¸ä¹‹ç±»ä¼¼,npm homeå‘½ä»¤è¿›å…¥ä¸»é¡µã€‚ å¦‚æœä½ æƒ³æ‰“å¼€ä½ çš„åŒ…çš„ä¸»é¡µnpmjs.comï¼Œé‚£æ˜¯ä¸€ä¸ªä¸é”™çš„é€Ÿè®°ï¼Œnpm docsã€‚ 7. åœ¨å…¶ä»–è„šæœ¬å‰åè¿è¡Œè„šæœ¬æ‚¨å¯èƒ½ç†Ÿæ‚‰è¯¸å¦‚pretestä¹‹ç±»çš„è„šæœ¬ï¼Œå®ƒå…è®¸æ‚¨å®šä¹‰åœ¨testè„šæœ¬ä¹‹å‰è¿è¡Œçš„ä»£ç ã€‚ æ‚¨å¯èƒ½ä¼šæƒŠè®¶åœ°å‘ç°ï¼Œæ‚¨å¯ä»¥ä¸ºæ¯ä¸ªè„šæœ¬é…ç½®æˆ–æœ‰æˆ–åçš„è„šæœ¬ï¼ŒåŒ…æ‹¬æ‚¨è‡ªå·±çš„è‡ªå®šä¹‰è„šæœ¬ï¼ å¯¹äºé¡¹ç›®ä¸­ï¼Œä½ ä½¿ç”¨NPMä½œä¸ºæ‚¨çš„æ„å»ºå·¥å…·ï¼Œæœ‰å¾ˆå¤šè„šæœ¬ï¼Œä½ éœ€è¦è‡ªå·±æ€»ç»“ä½¿ç”¨ã€‚ 8. ä¿®æ”¹åŒ…çš„ç‰ˆæœ¬ä½ å¼€å‘ä¸€ä¸ªå®‰è£…åŒ…ï¼Œä½ ä½¿ç”¨semverä½œä¸ºç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä¿®æ”¹ä¸€ä¸ªæ–°ç‰ˆæœ¬ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ éœ€è¦æ‰‹åŠ¨çš„ä¿®æ”¹package.jsonæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸æ¨èè¿™æ ·åšã€‚ æ›´å®¹æ˜“çš„æ–¹å¼æ˜¯è¿è¡Œnpm version é€šè¿‡ major, minor æˆ–è€… patch è¿™å°±æ˜¯è¿™æœŸçš„æ‰€æœ‰ã€‚ æˆ‘å¸Œæœ›ä½ å­¦åˆ°æ–°çš„ä¸œè¥¿ï¼Œå‘ç°åœ¨è¿™äº›æŠ€å·§ç”¨ï¼Œå¹¶åœ¨ä½ çš„æ—¥å¸¸å·¥ä½œæµç¨‹ä¸­ä½¿ç”¨ã€‚æœ€å¥½çš„å°±æ˜¯ä½ å¯¹npmæœ‰ä¸€ä¸ªæ–°çš„äº†è§£ï¼Œåœ¨ä½ çš„å·¥ä½œä¸­æ›´å¥½çš„ä½¿ç”¨å®ƒã€‚ ç»™åŒäº‹ç•™ä¸‹æ·±åˆ»å°è±¡æ˜¯å¾ˆå¥½çš„ï¼Œä½†æ˜¯ä¸æ–­å­¦ä¹ æ–°äº‹ç‰©å¹¶ä¸”æ›´ä¸“ä¸šæ›´å¥½ï¼ å¦‚æœä½ çŸ¥é“æ›´å¤šæœ‰ç”¨çš„æŠ€å·§ï¼Œè¯·åœ¨è¯„è®ºä¸­åˆ†äº«ï¼","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"ES6å±•å¼€è¿ç®—ç¬¦ï¼ˆæ‰©å±•è¿ç®—ç¬¦ï¼‰çš„ä½¿ç”¨æŠ€å·§","date":"2017-07-04T09:04:20.000Z","path":"2017/07/04/es6-spread-syntax/","text":"åœ¨ES6ä¸­ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ–°çš„è¿ç®—ç¬¦â€“å±•å¼€è¿ç®—ç¬¦ï¼Œå®ƒå¯ä»¥ä½¿æˆ‘ä»¬çš„ä»£ç çš„æ•°é‡æœ‰ä¸€å®šçš„å‡å°‘ï¼Œæœ‰æ—¶å€™ç”šè‡³æœ‰å¾ˆæœ‰ç”¨çš„ä½œç”¨ï¼Œæˆ‘ä»¬æ¥ä¸¾å‡ ä¸ªå¸¸ç”¨çš„ä¾‹å­ï¼ŒåŒæ—¶é€šè¿‡ä¾‹å­æ¥äº†è§£å±•å¼€è¿ç®—ç¬¦çš„ä½¿ç”¨ã€‚1.applyä¸­çš„ä½¿ç”¨ å½“æˆ‘ä»¬çš„å‡½æ•°æœ‰å¤šä¸ªå˜é‡çš„æ—¶å€™ï¼ˆç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬ä¸çŸ¥é“å˜é‡çš„æ•°é‡çš„æ—¶å€™ï¼‰ï¼Œæœ‰æ—¶å€™ä¼šé€šè¿‡å°†å˜é‡ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œå¹¶é€šè¿‡callæ¥æ‰§è¡Œå‡½æ•°ï¼Œæœ‰äº†å±•å¼€è¿ç®—ç¬¦ååˆ™æœ‰äº†æ›´å¥½çš„æ–¹å¼ï¼ˆæ¯•ç«Ÿä½¿ç”¨calléœ€è¦æ‰‹åŠ¨æŒ‡å®šthisï¼Œæœ‰æ—¶å€™ä¼šä¸æ˜¯å¾ˆæ–¹ä¾¿å¾ˆå‡†ç¡®ï¼‰ 1234567// ä¸€èˆ¬function a(x, y, z) &#123; &#125;var args = [0, 1, 2];a.call(null, args);// å±•å¼€è¿ç®—ç¬¦a(...args); é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ 1234567// éœ€è¦ä¼ å…¥ä¸å®šæ•°é‡çš„å‚æ•°ï¼ŒåŒæ—¶æœ€åä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æŒ‡å®šçš„å€¼function b() &#123; console.log(arguments.length); console.log(arguments[arguments.length -1]);&#125;var args = [0, 1, 2];b(...args, -2) æ€»çš„æ¥è¯´ï¼Œä½¿å¤šå‚æ•°çš„å‡½æ•°è°ƒç”¨æœ‰äº†æ–°çš„æ–¹å¼, è€Œä¸”é¿å…çš„ä½œç”¨åŸŸçš„é—®é¢˜ã€‚ 2.æ•°ç»„ä¸­çš„ä½¿ç”¨ æ•°ç»„çš„åˆå¹¶ 12var a = [1, 2];var b = [0, ...a, 3] æ•°ç»„çš„åˆ†å‰² 12var [a, ...b] = [0, 1, 2];console.log(b) // [1, 2] æ•°ç»„çš„æ‹·è´ 12var a = [1, 2];var b = [...a]; 3.å¯¹è±¡ä¸­çš„ä½¿ç”¨è¿™é‡Œçš„å¯¹è±¡æ˜¯æŒ‡ç±»ä¼¼{a:1}è¿™æ ·çš„å¯¹è±¡ï¼Œå› ä¸ºæ•°ç»„ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ä¸­çš„ä¸€ç§ã€‚ 12let &#123; x, y, ...z &#125; = &#123; x: 1, y: 2, a: 3, b: 4 &#125;;console.log(z) // &#123;a: 3, b: 4&#125; è¿™ä¸ªåœ¨å‡½æ•°çš„å‚æ•°ä¸­ä¹Ÿæœ‰å¾ˆå¥½çš„ç”¨å¤„ 12345function test(...args) &#123; console.log(args);&#125;test(&apos;wang&apos;, &apos;23&apos;, &apos;man&apos;); å¯èƒ½ä¼šæœ‰äººè¯´argumentsæœ¬èº«å°±å¯ä»¥å•Šï¼Œä½†æ˜¯argumentsæœ¬èº«å¹¶ä¸æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥å¯¹argumentsè¿›è¡Œæ•°ç»„æ“ä½œã€‚ ç±»å¤–ï¼Œåœ¨Nodeä¸­æœ‰å¾ˆå¤šçš„å›è°ƒå‡½æ•°éƒ½æ˜¯ä»¥errorä¸ºç¬¬ä¸€è¿”å›å€¼ï¼Œå…¶å®å¾ˆå¤šæ¥å£éƒ½æ˜¯é‚£ä¹ˆè®¾è®¡çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ†ç¦»errorå’Œå…¶ä»–å‚æ•° 1234request.get(&apos;./demo&apos;, (e, ...data) =&gt; &#123; console.log(e); console.log(data);&#125;) ä¸è¿‡ç°åœ¨çš„ES6ä¸­è¿˜ä¸æ”¯æŒåœ¨å¯¹è±¡ä¸­ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œè¿™ä¸ªè¿˜åœ¨ES7çš„è‰æ¡ˆä¸­ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨babelæ¥å¤„ç†ã€‚ æœ€åå†™ä¸€ä¸ªä¾‹å­å§ï¼Œåœ¨githubä¸Šæœ‰è¿™ä¸ªä¸€ä¸ªåº“https://github.com/sindresorhus/pifyç”¨äºå°†å›è°ƒçš„å‡½æ•°æ”¹ä¸ºpromiseå½¢å¼ 123456789101112131415161718192021const fs = require(&apos;fs&apos;);const pify = function(fn) &#123; return function(...args) &#123; return new Promise((resolve) =&gt; &#123; fn(...args, (...res) =&gt; &#123; resolve(res); &#125;) &#125;) &#125;&#125;;// fs.readFilepify(fs.readFile)(&apos;./package.json&apos;, &apos;utf8&apos;).then(([err, data]) =&gt; &#123; console.log(data);&#125;)// ajaxpify(request)(&apos;http://demo.api.com&apos;).then(([err, data]) =&gt; &#123; console.log(data)&#125;)","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"jsæ•°ç»„å»é‡","date":"2017-06-09T07:04:16.000Z","path":"2017/06/09/js-array-remove-duplication/","text":"æ•°ç»„çš„å»é‡åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ç»å¸¸ç¢°åˆ°çš„éœ€æ±‚ï¼Œè™½ç„¶æˆ‘ä»¬çœŸå®å¼€å‘è¿‡ç¨‹ä¸­ä¼šæœ‰lodashï¼ŒJqueryç­‰æ¡†æ¶å¸®åŠ©æˆ‘ä»¬ã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦è‡ªå·±æ¥å®ç°è¿™ä¸ªç®€å•çš„åŠŸèƒ½ æ¡†æ¶12345678910var arr = [1, 2, 3, 4, 5, 5, 5, 5];// Jquery$.unique(arr);// lodash_.uniq(arr);// underscore_.uniq(arr); æ–¹æ³•-1234567var arr = [1, 2, 3, 4, 5, 5, 5, 5];var res = [];arr.forEach((d) =&gt; &#123; if(res.indexOf(d) === -1) &#123; res.push(d) &#125;&#125;); æ–¹æ³•äºŒ1234var arr = [1, 2, 3, 4, 5, 5, 5, 5];var res = arr.filter((d, i) =&gt; &#123; return arr.indexOf(d) === i;&#125;) æ–¹æ³•ä¸‰å¦‚æœä½ çš„æ•°ç»„é‡Œé¢éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¯¹è±¡KEYçš„å”¯ä¸€æ€§æ¥å®ç°æ•°ç»„çš„å»é‡ 123456var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos; , &apos;a&apos;, &apos;c&apos;, &apos;d&apos;];var resObject = &#123;&#125;;arr.forEach((d) =&gt; &#123; resObject[d] = (resObject[d] || 1) + 1;&#125;);var res = Object.keys(resObject); å› ä¸ºObjectçš„é”®å€¼å¿…é¡»è¦æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å½“æ•°ç»„é‡Œé¢æœ‰æ•°å­—ï¼Œundefinedï¼Œboolç­‰ç±»å‹æ—¶ï¼Œå°±æ²¡æœ‰ä½œç”¨äº†ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸ä½†å¯ä»¥å¯¹å­—ç¬¦ä¸²æ•°ç»„å»é‡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•° æ–¹æ³•å››å½“æˆ‘ä»¬åœ¨å¾€æ•°ç»„é‡Œé¢pushçš„æ—¶å€™ï¼Œå¦‚æœæ•°ç»„æœ¬èº«å°±å¯ä»¥ä¿æŒä¸é‡å¤å°±å¥½äº†ï¼Œåœ¨ES5ä¸­æˆ‘ä»¬æ²¡æœ‰åŠæ³•åšåˆ°ï¼Œä½†æ˜¯åœ¨ES6ä¸­ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„Set setå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ï¼Œæ˜¯å±äºjsåŸºæœ¬ç±»å‹çš„Objectç±»å‹ä¸‹é¢çš„ å…³äºsetçš„è¯´æ˜MDNæœ‰å¦‚ä¸‹è¯´æ˜ The Set object lets you store unique values of any type, whether primitive values or object references. è¿™æ­£æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œè€Œä¸”setè¿˜å¯ä»¥æ ¹ä¼ å…¥æ•°ç»„æ¥åˆå§‹åŒ–ï¼Œè€Œsetä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„è½¬å›æ•°ç»„ 12let arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos; , &apos;a&apos;, &apos;c&apos;, &apos;d&apos;];let res = Array.from(new Set(arr));","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"nodeä¸­requireçš„å¾ªç¯ä½¿ç”¨","date":"2017-06-01T12:45:58.000Z","path":"2017/06/01/node-circular-require/","text":"æˆ‘ä»¬åœ¨Nodeä¸­å¯ä»¥é€šè¿‡requireæ¥å¾ˆæ–¹ä¾¿çš„å¼•å…¥ä¸€ä¸ªæ¨¡å—ï¼Œè€Œä¸”æˆ‘ä»¬ä¸€ç›´åˆ°requireæ¨¡å—æ˜¯ä¸€ä¸ªåŒæ­¥çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªä¸¤ä¸ªæ¨¡å—ç›¸äº’å¼•ç”¨çš„æ—¶å€™ï¼ŒNodeä¼šå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ åœ¨Nodeçš„å®˜æ–¹æ–‡æ¡£ä¸­æˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä¸‹çš„æè¿° When main.js loads a.js, then a.js in turn loads b.js. At that point, b.js tries to load a.js. In order to prevent an infinite loop, an unfinished copy of the a.js exports object is returned to the b.js module. b.js then finishes loading, and its exports object is provided to the a.js module. å½“ main.js åŠ è½½ a.js æ—¶ï¼Œa.js åˆåŠ è½½ b.jsã€‚ æ­¤æ—¶ï¼Œb.js ä¼šå°è¯•å»åŠ è½½ a.jsã€‚ ä¸ºäº†é˜²æ­¢æ— é™çš„å¾ªç¯ï¼Œä¼šè¿”å›ä¸€ä¸ª a.js çš„ exports å¯¹è±¡çš„ æœªå®Œæˆçš„å‰¯æœ¬ ç»™ b.js æ¨¡å—ã€‚ ç„¶å b.js å®ŒæˆåŠ è½½ï¼Œå¹¶å°† exports å¯¹è±¡æä¾›ç»™ a.js æ¨¡å—ã€‚ é‚£ä¹ˆè¿™é‡Œçš„å‰¯æœ¬æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æˆ‘ä»¬é€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­è¾“å‡ºexports å¯¹è±¡ a.js 123456const b = require(&apos;./b.js&apos;);console.log(b.name);console.log(b);exports.name = &apos;a.js&apos;;console.log(b.name); b.js 12345const a = require(&apos;./a.js&apos;);console.log(a.name);console.log(a);exports.name = &apos;b.js&apos;;console.log(a.name); å½“æˆ‘ä»¬æ‰§è¡Œnode a.jsçš„æ—¶å€™è¾“å‡º 12345undefined&#123;&#125;undefinedb.jsb.js æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Nodeä¼šæŒ‰ç…§requireæ¨¡å—çš„é¡ºåºï¼Œå€’åºåŠ è½½æ¨¡å—ï¼Œå¦‚æœå½“å‰æ¨¡å—ä¸­å‡ºç°äº†è¿˜æœªåŠ è½½è¿‡çš„ä¸”ä¾èµ–äºå½“å‰æ¨¡å—ï¼Œåˆ™å°†éœ€è¦çš„æ¨¡å—çš„exports å¯¹è±¡é»˜è®¤ä¸º{}(ç©ºå¯¹è±¡)æ¥é˜²æ­¢å¾ªç¯åŠ è½½çš„é—®é¢˜ã€‚","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"jsä¸­é€’å½’å¯¼è‡´çš„å †æ ˆæº¢å‡º","date":"2017-05-23T10:10:50.000Z","path":"2017/05/23/js-recursion-stackoverflow/","text":"åœ¨ç¼–ç¨‹ä¸­é€’å½’æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„æ“ä½œï¼Œä½†åœ¨jsä¸­ä½¿ç”¨é€’å½’å¾ˆå®¹æ˜“ä¸€ä¸å°å¿ƒå¯¼è‡´å †æ ˆæº¢å‡ºï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æœ€å¸¸ç”¨çš„é—­åŒ…ï¼Œå¦‚ä¸‹ä¾‹å­ 12345678910111213function isEven (num) &#123; if (num === 0) &#123; return true; &#125; if (num === 1) &#123; return false; &#125; return isEven(Math.abs(num) - 2);&#125;isEven(100); å› ä¸ºé€’å½’æ‰€ä»¥å¯¼è‡´æ¯ä¸€å±‚çš„isEvenå‡½æ•°éƒ½ä¿ç•™äº†ä¹‹å‰æ‰€æœ‰å±‚çš„å‡½æ•°ç©ºé—´","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"Lampç¯å¢ƒæ­å»º(linux apache mysql php)","date":"2017-05-19T10:14:17.000Z","path":"2017/05/19/linux-install-lamp/","text":"From: https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-on-centos-6 About LAMPLAMP stack is a group of open source software used to get web servers up and running. The acronym stands for Linux, Apache, MySQL, and PHP. Since the server is already running CentOS, the linux part is taken care of. Here is how to install the rest. Set UpThe steps in this tutorial require the user on the virtual private server to have root privileges. You can see how to set that up in the Initial Server Setup Tutorial in steps 3 and 4. Step Oneâ€”Install ApacheApache is a free open source software which runs over 50% of the worldâ€™s web servers. To install apache, open terminal and type in this command: sudo yum install httpd Once it installs, you can start apache running on your VPS: sudo service httpd start Thatâ€™s it. To check if Apache is installed, direct your browser to your serverâ€™s IP address (eg. http://12.34.56.789). The page should display the words â€œIt works!â€ like this. How to find your Serverâ€™s IP addressYou can run the following command to reveal your serverâ€™s IP address. ifconfig eth0 | grep inet | awk &apos;{ print $2 }&apos; Step Twoâ€”Install MySQLMySQL is a powerful database management system used for organizing and retrieving data on a virtual server To install MySQL, open terminal and type in these commands: sudo yum install mysql-server sudo service mysqld start During the installation, MySQL will ask you for your permission twice. After you say Yes to both, MySQL will install. Once it is done installing, you can set a root MySQL password: sudo /usr/bin/mysql_secure_installation The prompt will ask you for your current root password. Since you just installed MySQL, you most likely wonâ€™t have one, so leave it blank by pressing enter. Enter current password for root (enter for none): OK, successfully used password, moving on... Then the prompt will ask you if you want to set a root password. Go ahead and choose Y and follow the instructions. CentOS automates the process of setting up MySQL, asking you a series of yes or no questions. Itâ€™s easiest just to say Yes to all the options. At the end, MySQL will reload and implement the new changes. By default, a MySQL installation has an anonymous user, allowing anyone to log into MySQL without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment. Remove anonymous users? [Y/n] y ... Success! Normally, root should only be allowed to connect from &apos;localhost&apos;. This ensures that someone cannot guess at the root password from the network. Disallow root login remotely? [Y/n] y ... Success! By default, MySQL comes with a database named &apos;test&apos; that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment. Remove test database and access to it? [Y/n] y - Dropping test database... ... Success! - Removing privileges on test database... ... Success! Reloading the privilege tables will ensure that all changes made so far will take effect immediately. Reload privilege tables now? [Y/n] y ... Success! Cleaning up... All done! If you&apos;ve completed all of the above steps, your MySQL installation should now be secure. Thanks for using MySQL! Step Threeâ€”Install PHPPHP is an open source web scripting language that is widely used to build dynamic webpages. To install PHP on your virtual private server, open terminal and type in this command: sudo yum install php php-mysql Once you answer yes to the PHP prompt, PHP will be installed. PHP ModulesPHP also has a variety of useful libraries and modules that you can add onto your server. You can see the libraries that are available by typing: yum search php- Terminal then will display the list of possible modules. The beginning looks like this: php-bcmath.x86_64 : A module for PHP applications for using the bcmath library php-cli.x86_64 : Command-line interface for PHP php-common.x86_64 : Common files for PHP php-dba.x86_64 : A database abstraction layer module for PHP applications php-devel.x86_64 : Files needed for building PHP extensions php-embedded.x86_64 : PHP library for embedding in applications php-enchant.x86_64 : Human Language and Character Encoding Support php-gd.x86_64 : A module for PHP applications for using the gd graphics library php-imap.x86_64 : A module for PHP applications that use IMAP To see more details about what each module does, type the following command into terminal, replacing the name of the module with whatever library you want to learn about. yum info _name of the module_ Once you decide to install the module, type: sudo yum install _name of the module_ You can install multiple libraries at once by separating the name of each module with a space. Congratulations! You now have LAMP stack on your droplet! We should also set the processes to run automatically when the server boots (php will run automatically once Apache starts): sudo chkconfig httpd on sudo chkconfig mysqld on Step Fourâ€”RESULTS: See PHP on your ServerAlthough LAMP is installed on your virtual server, we can still take a look and see the components online by creating a quick php info page To set this up, first create a new file: sudo nano /var/www/html/info.php Add in the following line: &lt;?php phpinfo(); ?&gt; Then Save and Exit. Restart apache so that all of the changes take effect on your virtual server: sudo service httpd restart Finish up by visiting your php info page (make sure you replace the example ip address with your correct one): http://12.34.56.789/info.php It should look similar to this. See MoreAfter installing LAMP, you can go on to do more with MySQL (A Basic MySQL Tutorial), Create an SSL Certificate, or Install an FTP Server.","tags":[{"name":"linux","slug":"linux","permalink":"http://wangyuekai.com/tags/linux/"},{"name":"apache","slug":"apache","permalink":"http://wangyuekai.com/tags/apache/"},{"name":"mysql","slug":"mysql","permalink":"http://wangyuekai.com/tags/mysql/"},{"name":"php","slug":"php","permalink":"http://wangyuekai.com/tags/php/"}]},{"title":"è½¬è½½ä¸€ä»½æ¸…å•ï¼šæ‰€æœ‰å¯ä»¥æ”¾è¿›headæ ‡ç­¾çš„å…ƒç´ ","date":"2017-05-18T14:05:34.000Z","path":"2017/05/18/head-element/","text":"æœ¬æ–‡è½¬è½½è‡ªï¼šä¼—æˆç¿»è¯‘è¯‘è€…ï¼šmsmailcodeé“¾æ¥ï¼šhttp://www.zcfy.cc/article/2838åŸæ–‡ï¼šhttps://github.com/joshbuchea/HEAD?utm_source=statuscode&amp;utm_medium=medium HEADå¯ä»¥åœ¨ä½ æ–‡æ¡£çš„headæ ‡ç­¾ä¸­ä½¿ç”¨çš„æ‰€æœ‰å†…å®¹çš„æ¸…å•ã€‚ ç›®å½• Recommended Minimum Elements Meta Link Favicons Social Facebook Open Graph Facebook Instant Articles Twitter Cards Google+ / Schema.org OEmbed Browsers / Platforms Apple iOS Apple Safari Google Android Google Chrome Microsoft Internet Explorer Browsers (Chinese) 360 Browser QQ Mobile Browser UC Mobile Browser App Links Notes Performance Other Resources Related Projects Other Formats Translations Contributing Contributors Author License æ¨èçš„æœ€åŸºæœ¬çš„ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ç½‘ç«™éœ€è¦çš„æœ€åŸºæœ¬çš„æ ‡ç­¾ã€‚ 12345&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;&lt;!-- ä¸Šé¢çš„ä¸‰ä¸ªæ ‡ç­¾ *å¿…é¡»* åœ¨headæ ‡ç­¾çš„æœ€å‰é¢ï¼›ä»»ä½•å…¶ä»–çš„æ ‡ç­¾å¿…é¡»åœ¨è¿™ä¸‰ä¸ªæ ‡ç­¾çš„ *åé¢* --&gt;&lt;title&gt;Page Title&lt;/title&gt; Elements123456789101112131415161718&lt;!-- æ–‡æ¡£æ ‡é¢˜ --&gt;&lt;title&gt;Page Title&lt;/title&gt;&lt;!-- åœ¨æ–‡æ¡£ä¸­åŒ…å«çš„æ‰€æœ‰ç›¸å¯¹ URL çš„ Base URL --&gt;&lt;base href=&quot;https://example.com/page.html&quot;&gt;&lt;!-- å¤–éƒ¨æ ·å¼è¡¨ --&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;styles.css&quot;&gt;&lt;!-- å†…éƒ¨æ ·å¼è¡¨ --&gt;&lt;style&gt; /* ... */&lt;/style&gt;&lt;!-- JavaScript --&gt;&lt;!-- JavaScript --&gt;``&lt;script src=&quot;script.js&quot;&gt;``&lt;/script&gt;&lt;noscript&gt;&lt;!--è„šæœ¬æœªè¢«æ‰§è¡Œæ—¶çš„æ›¿ä»£å†…å®¹--&gt;&lt;/noscript&gt; Meta1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374&lt;meta charset=&quot;utf-8&quot;&gt; &lt;!-- è®¾ç½®æ–‡æ¡£çš„å­—ç¬¦ç¼–ç  --&gt;&lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;&lt;!-- ä¸Šé¢çš„ä¸‰ä¸ªæ ‡ç­¾ *å¿…é¡»* åœ¨headæ ‡ç­¾çš„æœ€å‰é¢ï¼›ä»»ä½•å…¶ä»–çš„æ ‡ç­¾å¿…é¡»åœ¨è¿™ä¸‰ä¸ªæ ‡ç­¾çš„ *åé¢* --&gt;&lt;!-- å…è®¸æ§åˆ¶èµ„æºä»ä½•å¤„åŠ è½½ --&gt;&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos;&quot;&gt;&lt;!-- å°½å¯èƒ½æ—©çš„åœ¨æ–‡æ¡£ä¸­æ”¾ç½® --&gt;&lt;!-- ä»…é€‚ç”¨äºæ­¤æ ‡ç­¾åçš„å†…å®¹ --&gt;&lt;!-- Webåº”ç”¨ç¨‹åºåç§°ï¼ˆä»…å½“ç½‘ç«™ä½œä¸ºåº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨ï¼‰ --&gt;&lt;meta name=&quot;application-name&quot; content=&quot;Application Name&quot;&gt;&lt;!-- é¡µé¢çš„ç®€çŸ­æè¿°ï¼ˆé™åˆ¶ä¸º150ä¸ªå­—ç¬¦ï¼‰ --&gt;&lt;!-- åœ¨ *éƒ¨åˆ†* æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæè¿°è¢«ç”¨ä½œæœç´¢ç»“æœä¸­æ˜¾ç¤ºçš„ç‰‡æ®µçš„ä¸€éƒ¨åˆ†ã€‚ --&gt;&lt;meta name=&quot;description&quot; content=&quot;A description of the page&quot;&gt;&lt;!-- æ§åˆ¶æœç´¢å¼•æ“çš„æŠ“å–å’Œç´¢å¼•è¡Œä¸º --&gt;&lt;meta name=&quot;robots&quot; content=&quot;index,follow&quot;&gt;&lt;!-- All Search Engines --&gt;&lt;!-- æ‰€æœ‰çš„æœç´¢å¼•æ“ --&gt;&lt;meta name=&quot;googlebot&quot; content=&quot;index,follow&quot;&gt;&lt;!-- Google Specific --&gt;&lt;!-- é’ˆå¯¹ Google --&gt;&lt;!-- å‘Šè¯‰ Google ä¸æ˜¾ç¤º [sitelinks](!https://en.wikipedia.org/wiki/Sitelink) æœç´¢æ¡† --&gt;&lt;meta name=&quot;google&quot; content=&quot;nositelinkssearchbox&quot;&gt;&lt;!-- å‘Šè¯‰è°·æ­Œä¸è¦ä¸ºè¿™ä¸ªé¡µé¢æä¾›ç¿»è¯‘ --&gt;&lt;meta name=&quot;google&quot; content=&quot;notranslate&quot;&gt;&lt;!-- Google [Search Console](!https://developers.google.cn/webmaster-tools/) èº«ä»½éªŒè¯ --&gt;&lt;meta name=&quot;google-site-verification&quot; content=&quot;verification_token&quot;&gt;&lt;!-- [Yandex Webmasters](!https://webmaster.yandex.com/) èº«ä»½éªŒè¯ --&gt;&lt;meta name=&quot;yandex-verification&quot; content=&quot;verification_token&quot;&gt;&lt;!-- [Bing Webmaster Center](!https://www.bing.com/toolbox/webmaster/) èº«ä»½éªŒè¯ --&gt;&lt;meta name=&quot;msvalidate.01&quot; content=&quot;verification_token&quot;&gt;&lt;!-- [Alexa Console](!http://www.alexa.com/) èº«ä»½éªŒè¯ --&gt;&lt;meta name=&quot;alexaVerifyID&quot; content=&quot;verification_token&quot;&gt;&lt;!-- [Pinterest Console](!https://developers.pinterest.com) èº«ä»½éªŒè¯ --&gt;&lt;meta name=&quot;p:domain_verify&quot; content=&quot;code from pinterest&quot;&gt;&lt;!-- [Norton Safe Web](!https://safeweb.norton.com/help/site_owners) èº«ä»½éªŒè¯ --&gt;&lt;meta name=&quot;norton-safeweb-site-verification&quot; content=&quot;norton code&quot;&gt;&lt;!-- ç”¨äºå‘½åæ„å»ºç½‘ç«™çš„è½¯ä»¶ (i.e. - WordPress, Dreamweaver) --&gt;&lt;meta name=&quot;generator&quot; content=&quot;program&quot;&gt;&lt;!-- ç½‘ç«™ä¸»é¢˜çš„ç®€çŸ­æè¿° --&gt;&lt;meta name=&quot;subject&quot; content=&quot;your website&apos;s subject&quot;&gt;&lt;!-- åŸºäºç½‘ç«™å†…å®¹ç»™å‡ºä¸€èˆ¬[å¹´é¾„åˆ†çº§](!https://en.wikipedia.org/wiki/International_Age_Rating_Coalition) --&gt;&lt;meta name=&quot;rating&quot; content=&quot;General&quot;&gt;&lt;!-- å…è®¸æ§åˆ¶ referrer ä¿¡æ¯å¦‚ä½•ä¼ é€’ --&gt;&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;&gt;&lt;!-- ç¦ç”¨è‡ªåŠ¨æ£€æµ‹å’Œæ ¼å¼åŒ–å¯èƒ½çš„ç”µè¯å·ç  --&gt;&lt;meta name=&quot;format-detection&quot; content=&quot;telephone=no&quot;&gt;&lt;!-- é€šè¿‡è®¾ç½®ä¸º&quot;off&quot;å®Œå…¨å…³é—­[ DNS é¢„è¯»å–](!https://developer.mozilla.org/zh-CN/docs/Controlling_DNS_prefetching) --&gt;&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;off&quot;&gt;&lt;!-- åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸Šå­˜å‚¨cookieä»¥è¿›è¡Œç”¨æˆ·è¯†åˆ« --&gt;&lt;meta http-equiv=&quot;set-cookie&quot; content=&quot;name=value; expires=date; path=url&quot;&gt;&lt;!-- æŒ‡å®šæ˜¾ç¤ºåœ¨ç‰¹å®šæ¡†æ¶ä¸­çš„é¡µé¢ --&gt;&lt;meta http-equiv=&quot;Window-Target&quot; content=&quot;_value&quot;&gt;&lt;!-- åœ°ç†æ ‡ç­¾ --&gt;&lt;meta name=&quot;ICBM&quot; content=&quot;latitude, longitude&quot;&gt;&lt;meta name=&quot;geo.position&quot; content=&quot;latitude;longitude&quot;&gt;&lt;!-- å›½å®¶ä»£ç ï¼ˆISO 3166-1ï¼‰ï¼šå¼ºåˆ¶æ€§ï¼Œå·ä»£ç ï¼ˆISO 3166-2ï¼‰ï¼šå¯é€‰ï¼›eg. content=&quot;US&quot; / content=&quot;US-NY&quot; --&gt;&lt;meta name=&quot;geo.placename&quot; content=&quot;city/town&quot;&gt;&lt;!-- eg. content=&quot;New York City&quot; --&gt; Googleå¯ä»¥è¯†åˆ«çš„metaæ ‡ç­¾ Metaæ‰©å±•-WHATWG Wiki ICBM-ç»´åŸºç™¾ç§‘ åœ°ç†æ ‡ç­¾-ç»´åŸºç™¾ç§‘ Link12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;!-- æŒ‡å‘ä¸€ä¸ªCSSæ ·å¼è¡¨ --&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://example.com/styles.css&quot;&gt;&lt;!-- å¸®åŠ©è§£å†³å†…å®¹é‡å¤æ”¶å½• [Canonical link element](!https://en.wikipedia.org/wiki/Canonical_link_element) --&gt;&lt;link rel=&quot;canonical&quot; href=&quot;https://example.com/2010/06/9-things-to-do-before-entering-social-media.html&quot;&gt;&lt;!-- ä¹‹å‰ç”¨äºåŒ…å« icon é“¾æ¥ï¼Œä½†å·²è¢«åºŸå¼ƒä¸å†ä½¿ç”¨ --&gt;&lt;link rel=&quot;shortlink&quot; href=&quot;https://example.com/?p=42&quot;&gt;&lt;!-- é“¾æ¥åˆ°å½“å‰æ–‡æ¡£çš„ [AMP HTML](!https://www.ampproject.org/) ç‰ˆæœ¬ --&gt;&lt;link rel=&quot;amphtml&quot; href=&quot;https://example.com/path/to/amp-version.html&quot;&gt;&lt;!-- é“¾æ¥åˆ°ä¸ºwebåº”ç”¨ç¨‹åºæŒ‡å®šâ€œå®‰è£…â€å‡­è¯çš„JSONæ–‡ä»¶ --&gt;&lt;link rel=&quot;manifest&quot; href=&quot;manifest.json&quot;&gt;&lt;!-- é“¾æ¥åˆ°æ–‡æ¡£çš„ä½œè€… --&gt;&lt;link rel=&quot;author&quot; href=&quot;humans.txt&quot;&gt;&lt;!-- é“¾æ¥åˆ°é€‚ç”¨äºé“¾æ¥ä¸Šä¸‹æ–‡çš„ç‰ˆæƒå£°æ˜ --&gt;&lt;link rel=&quot;copyright&quot; href=&quot;copyright.html&quot;&gt;&lt;!-- ç»™å‡ºæ–‡æ¡£çš„å¦ä¸€ç§è¯­è¨€çš„æ›¿ä»£ç‰ˆæœ¬ [a-simple-guide-to-using-rel-alternate-hreflang-x](!https://searchenginewatch.com/sew/how-to/2232347/a-simple-guide-to-using-rel-alternate-hreflang-x) --&gt;&lt;link rel=&quot;alternate&quot; href=&quot;https://es.example.com/&quot; hreflang=&quot;es&quot;&gt;&lt;!-- æä¾›äº†å…³äºä½œè€…æˆ–å…¶ä»–äººçš„ä¿¡æ¯ --&gt;&lt;link rel=&quot;me&quot; href=&quot;https://google.com/profiles/thenextweb&quot; type=&quot;text/html&quot;&gt;&lt;link rel=&quot;me&quot; href=&quot;mailto:name@example.com&quot;&gt;&lt;link rel=&quot;me&quot; href=&quot;sms:+15035550125&quot;&gt;&lt;!-- æè¿°å†å²è®°å½•ã€æ–‡ä»¶æˆ–å…¶ä»–èµ„æ–™çš„é›†åˆçš„æ–‡æ¡£çš„é“¾æ¥ã€‚ --&gt;&lt;link rel=&quot;archives&quot; href=&quot;https://example.com/archives/&quot;&gt;&lt;!-- å±‚æ¬¡ç»“æ„ä¸­çš„é¡¶çº§èµ„æºçš„é“¾æ¥ --&gt;&lt;link rel=&quot;index&quot; href=&quot;https://example.com/&quot;&gt;&lt;!-- ç»™å‡ºä¸€ä¸ªè‡ªæˆ‘å‚è€ƒ - å½“æ–‡æ¡£æœ‰å¤šä¸ªå¯èƒ½çš„å‚è€ƒæ—¶éå¸¸æœ‰ç”¨ --&gt;&lt;link rel=&quot;self&quot; type=&quot;application/atom+xml&quot; href=&quot;https://example.com/atomFeed.php?page=3&quot;&gt;&lt;!-- åˆ†åˆ«æ˜¯ä¸€ä¸ªç³»åˆ—æ–‡æ¡£çš„ç¬¬ä¸€ä¸ªã€ä¸‹ä¸€ä¸ªã€å‰ä¸€ä¸ªä»¥åŠæœ€åä¸€ä¸ªæ–‡æ¡£ --&gt;&lt;link rel=&quot;first&quot; href=&quot;https://example.com/atomFeed.php&quot;&gt;&lt;link rel=&quot;next&quot; href=&quot;https://example.com/atomFeed.php?page=4&quot;&gt;&lt;link rel=&quot;prev&quot; href=&quot;https://example.com/atomFeed.php?page=2&quot;&gt;&lt;link rel=&quot;last&quot; href=&quot;https://example.com/atomFeed.php?page=147&quot;&gt;&lt;!-- ä½¿ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ç»´æŠ¤åšå®¢æ—¶ä½¿ç”¨ --&gt;&lt;link rel=&quot;EditURI&quot; href=&quot;https://example.com/xmlrpc.php?rsd&quot; type=&quot;application/rsd+xml&quot; title=&quot;RSD&quot;&gt;&lt;!-- å½“å¦ä¸€ä¸ªWordPressåšå®¢é“¾æ¥åˆ°ä½ çš„WordPressåšå®¢æˆ–å¸–å­æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨è¯„è®º --&gt;&lt;link rel=&quot;pingback&quot; href=&quot;https://example.com/xmlrpc.php&quot;&gt;&lt;!-- å½“ä½ åœ¨è‡ªå·±çš„é¡µé¢ä¸Šé“¾æ¥åˆ°ä¸€ä¸ª url æ—¶é€šçŸ¥å®ƒ --&gt;&lt;link rel=&quot;webmention&quot; href=&quot;https://example.com/webmention&quot;&gt;&lt;!-- åŠ è½½ä¸€ä¸ªå¤–éƒ¨çš„ HTML æ–‡ä»¶åˆ°å½“å‰ HTML æ–‡ä»¶ä¸­ --&gt;&lt;link rel=&quot;import&quot; href=&quot;/path/to/component.html&quot;&gt;&lt;!-- æ‰“å¼€æœç´¢ --&gt;&lt;link rel=&quot;search&quot; href=&quot;/open-search.xml&quot; type=&quot;application/opensearchdescription+xml&quot; title=&quot;Search Title&quot;&gt;&lt;!-- Feedsç½‘ç»œè®¢é˜… --&gt;&lt;link rel=&quot;alternate&quot; href=&quot;https://feeds.feedburner.com/example&quot; type=&quot;application/rss+xml&quot; title=&quot;RSS&quot;&gt;&lt;link rel=&quot;alternate&quot; href=&quot;https://example.com/feed.atom&quot; type=&quot;application/atom+xml&quot; title=&quot;Atom 0.3&quot;&gt;&lt;!-- é¢„è¯»å–ï¼Œé¢„åŠ è½½ï¼Œé¢„æµè§ˆ --&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//example.com/&quot;&gt;&lt;link rel=&quot;preconnect&quot; href=&quot;https://www.example.com/&quot;&gt;&lt;link rel=&quot;prefetch&quot; href=&quot;https://www.example.com/&quot;&gt;&lt;link rel=&quot;prerender&quot; href=&quot;https://example.com/&quot;&gt;&lt;link rel=&quot;preload&quot; href=&quot;image.png&quot; as=&quot;image&quot;&gt;&lt;!-- æ›´å¤šä¿¡æ¯: https://css-tricks.com/prefetching-preloading-prebrowsing/ --&gt; Favicons1234567&lt;!-- IE 10 åŠä»¥ä¸‹ç‰ˆæœ¬ --&gt;&lt;!-- å°† favicon.ico æ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸­ - ä¸éœ€è¦ link æ ‡ç­¾ --&gt;&lt;!-- IE 11, Chrome, Firefox, Safari, Opera --&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;16x16&quot; href=&quot;/path/to/favicon-16x16.png&quot;&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;32x32&quot; href=&quot;/path/to/favicon-32x32.png&quot;&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;96x96&quot; href=&quot;/path/to/favicon-96x96.png&quot;&gt; å…³äº Favicons (å’Œ Touch Icons) Favicon å¯¹ç…§è¡¨ Social ç¤¾äº¤åª’ä½“Facebook Open Graph123456789&lt;meta property=&quot;fb:app_id&quot; content=&quot;123456789&quot;&gt;&lt;meta property=&quot;og:url&quot; content=&quot;https://example.com/page.html&quot;&gt;&lt;meta property=&quot;og:type&quot; content=&quot;website&quot;&gt;&lt;meta property=&quot;og:title&quot; content=&quot;Content Title&quot;&gt;&lt;meta property=&quot;og:image&quot; content=&quot;https://example.com/image.jpg&quot;&gt;&lt;meta property=&quot;og:description&quot; content=&quot;Description Here&quot;&gt;&lt;meta property=&quot;og:site_name&quot; content=&quot;Site Name&quot;&gt;&lt;meta property=&quot;og:locale&quot; content=&quot;en_US&quot;&gt;&lt;meta property=&quot;article:author&quot; content=&quot;&quot;&gt; Facebook Open Graph Markup Open Graph protocol Facebook Instant Articles12345678&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta property=&quot;op:markup_version&quot; content=&quot;v1.0&quot;&gt;&lt;!-- ä½ çš„æ–‡ç« çš„ Web ç‰ˆæœ¬çš„ URL --&gt;&lt;link rel=&quot;canonical&quot; href=&quot;http://example.com/article.html&quot;&gt;&lt;!-- æœ¬æ–‡ä½¿ç”¨çš„æ ·å¼ --&gt;&lt;meta property=&quot;fb:article_style&quot; content=&quot;myarticlestyle&quot;&gt; Facebook Instant Articles: Creating Articles Instant Articles: Format Reference Twitter Cards1234567&lt;meta name=&quot;twitter:card&quot; content=&quot;summary&quot;&gt;&lt;meta name=&quot;twitter:site&quot; content=&quot;@site_account&quot;&gt;&lt;meta name=&quot;twitter:creator&quot; content=&quot;@individual_account&quot;&gt;&lt;meta name=&quot;twitter:url&quot; content=&quot;https://example.com/page.html&quot;&gt;&lt;meta name=&quot;twitter:title&quot; content=&quot;Content Title&quot;&gt;&lt;meta name=&quot;twitter:description&quot; content=&quot;Content description less than 200 characters&quot;&gt;&lt;meta name=&quot;twitter:image&quot; content=&quot;https://example.com/image.jpg&quot;&gt; Twitter Cards: Getting Started Guide Twitter Card Validator Google+ / Schema.org1234&lt;link href=&quot;https://plus.google.com/+YourPage&quot; rel=&quot;publisher&quot;&gt;&lt;meta itemprop=&quot;name&quot; content=&quot;Content Title&quot;&gt;&lt;meta itemprop=&quot;description&quot; content=&quot;Content description less than 200 characters&quot;&gt;&lt;meta itemprop=&quot;image&quot; content=&quot;https://example.com/image.jpg&quot;&gt; PinterestPinterest è®©ä½ é˜»æ­¢ç”¨æˆ·ä»ä½ çš„ç½‘ç«™ä¸Šä¿å­˜ä¸œè¥¿ï¼ŒæŸ¥çœ‹ help centerã€‚ description æ˜¯å¯é€‰çš„ 1&lt;meta name=&quot;pinterest&quot; content=&quot;nopin&quot; description=&quot;Sorry, you can&apos;t save from my website!&quot;&gt; OEmbed123456&lt;link rel=&quot;alternate&quot; type=&quot;application/json+oembed&quot; href=&quot;http://example.com/services/oembed?url=http%3A%2F%2Fexample.com%2Ffoo%2F&amp;format=json&quot; title=&quot;oEmbed Profile: JSON&quot;&gt;&lt;link rel=&quot;alternate&quot; type=&quot;text/xml+oembed&quot; href=&quot;http://example.com/services/oembed?url=http%3A%2F%2Fexample.com%2Ffoo%2F&amp;format=xml&quot; title=&quot;oEmbed Profile: XML&quot;&gt; oEmbed format Browsersæµè§ˆå™¨ / Platformså¹³å°Apple iOS1234567891011121314151617181920212223&lt;!-- Smart App Banner æ™ºèƒ½ App å¹¿å‘Šæ¡ --&gt;&lt;meta name=&quot;apple-itunes-app&quot; content=&quot;app-id=APP_ID,affiliate-data=AFFILIATE_ID,app-argument=SOME_TEXT&quot;&gt;&lt;!-- ç¦æ­¢æ•°å­—è‡ªåŠ¨è¯†åˆ«ä¸ºç”µè¯å·ç  --&gt;&lt;meta name=&quot;format-detection&quot; content=&quot;telephone=no&quot;&gt;&lt;!-- Add to Home Screen æ·»åŠ åˆ°ä¸»å±å¹• --&gt;&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;&lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;&gt;&lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;App Title&quot;&gt;&lt;!-- Touch Icons --&gt;&lt;!-- åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨headä¸­ä¸€ä¸ª180Ã—180pxçš„å›¾æ ‡å°±è¶³å¤Ÿäº†ã€‚ --&gt;&lt;link rel=&quot;apple-touch-icon&quot; href=&quot;/path/to/apple-touch-icon.png&quot;&gt;&lt;!-- æ³¨æ„: iOS 7 çš„ Safari ä¸ä¸ºå›¾æ ‡æ·»åŠ æ•ˆæœã€‚ --&gt;&lt;!-- æ—§ç‰ˆæœ¬ Safari ä¸ä¼šä¸ºåç¼€åä¸º -precomposed.png çš„ icon æ–‡ä»¶æ·»åŠ æ•ˆæœ --&gt;&lt;!-- å¯åŠ¨ç”»é¢ ( å¼ƒç”¨ ) --&gt;&lt;link rel=&quot;apple-touch-startup-image&quot; href=&quot;/path/to/startup.png&quot;&gt;&lt;!-- iOS åº”ç”¨æ·±åº¦é“¾æ¥ --&gt;&lt;meta name=&quot;apple-itunes-app&quot; content=&quot;app-id=APP-ID, app-argument=http/url-sample.com&quot;&gt;&lt;link rel=&quot;alternate&quot; href=&quot;ios-app://APP-ID/http/url-sample.com&quot;&gt; Apple Meta Tags Apple Safari12&lt;!-- å›ºå®šä¹¦ç­¾é¡µ --&gt;&lt;link rel=&quot;mask-icon&quot; href=&quot;/path/to/icon.svg&quot; color=&quot;red&quot;&gt; Google Android123456789&lt;meta name=&quot;theme-color&quot; content=&quot;#E64545&quot;&gt;&lt;!-- æ·»åŠ åˆ°ä¸»å±å¹• --&gt;&lt;meta name=&quot;mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;&lt;!-- æ›´å¤šä¿¡æ¯: https://developer.chrome.com/multidevice/android/installtohomescreen --&gt;&lt;!-- Android åº”ç”¨æ·±åº¦é“¾æ¥ --&gt;&lt;meta name=&quot;google-play-app&quot; content=&quot;app-id=package-name&quot;&gt;&lt;link rel=&quot;alternate&quot; href=&quot;android-app://package-name/http/url-sample.com&quot;&gt; Google Chrome1234&lt;link rel=&quot;chrome-webstore-item&quot; href=&quot;https://chrome.google.com/webstore/detail/APP_ID&quot;&gt;&lt;!-- ç¦ç”¨ç¿»è¯‘æç¤º --&gt;&lt;meta name=&quot;google&quot; value=&quot;notranslate&quot;&gt; Google Chrome Mobile (åªé’ˆå¯¹ Android)ä» Chrome 31 å¼€å§‹, ä½ å¯ä»¥åƒ Safari ä¸€æ ·è®¾ç½®ä½ çš„ Web åº”ç”¨ä¸ºâ€œapp modeâ€ ã€‚ 123456789&lt;!-- é“¾æ¥åˆ°ä¸€ä¸ª manifest å¹¶å®šä¹‰ manifest çš„å…ƒæ•°æ®ã€‚ --&gt;&lt;!-- manifest.jsonçš„ä¾‹å­å¯ä»¥åœ¨ä¸‹é¢çš„é“¾æ¥ä¸­æ‰¾åˆ°ã€‚ --&gt;&lt;link rel=&quot;manifest&quot; href=&quot;manifest.json&quot;&gt;&lt;!-- å°†ä½ çš„ç½‘é¡µå®šä¹‰ä¸º Web åº”ç”¨ --&gt;&lt;meta name=&quot;mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;&lt;!-- ä¸»å±å¹•å›¾æ ‡ --&gt;&lt;link rel=&quot;icon&quot; sizes=&quot;192x192&quot; href=&quot;highres-icon.png&quot;&gt; Google Developer Microsoft Internet Explorer123456789101112131415161718192021&lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;&lt;meta name=&quot;skype_toolbar&quot; content=&quot;skype_toolbar_parser_compatible&quot;&gt;&lt;!-- IE10: ç¦ç”¨ç‚¹å‡»æ—¶é“¾æ¥é«˜äº® (https://blogs.windows.com/buildingapps/2012/11/15/adapting-your-webkit-optimized-site-for-internet-explorer-10/) --&gt;&lt;meta name=&quot;msapplication-tap-highlight&quot; content=&quot;no&quot;&gt;&lt;!-- å›ºå®šç½‘é¡µ (https://msdn.microsoft.com/en-us/library/dn255024(v=vs.85).aspx) --&gt;&lt;meta name=&quot;application-name&quot; content=&quot;Sample Title&quot;&gt;&lt;meta name=&quot;msapplication-tooltip&quot; content=&quot;A description of what this site does.&quot;&gt;&lt;meta name=&quot;msapplication-starturl&quot; content=&quot;http://example.com/index.html?pinned=true&quot;&gt;&lt;meta name=&quot;msapplication-navbutton-color&quot; content=&quot;#FF3300&quot;&gt;&lt;meta name=&quot;msapplication-window&quot; content=&quot;width=800;height=600&quot;&gt;&lt;meta name=&quot;msapplication-task&quot; content=&quot;name=Task 1;action-uri=http://host/Page1.html;icon-uri=http://host/icon1.ico&quot;&gt;&lt;meta name=&quot;msapplication-task&quot; content=&quot;name=Task 2;action-uri=http://microsoft.com/Page2.html;icon-uri=http://host/icon2.ico&quot;&gt;&lt;meta name=&quot;msapplication-badge&quot; value=&quot;frequency=NUMBER_IN_MINUTES;polling-uri=http://example.com/path/to/file.xml&quot;&gt;&lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#FF3300&quot;&gt;&lt;meta name=&quot;msapplication-TileImage&quot; content=&quot;/path/to/tileimage.jpg&quot;&gt;&lt;meta name=&quot;msapplication-config&quot; content=&quot;http://example.com/browserconfig.xml&quot;&gt;&lt;meta name=&quot;msapplication-notification&quot; content=&quot;frequency=60;polling-uri=http://example.com/livetile;polling-uri2=http://example.com/livetile2&quot;&gt;&lt;meta name=&quot;msapplication-task-separator&quot; content=&quot;1&quot;&gt; App Links åº”ç”¨å…³è”1234567891011&lt;!-- iOS --&gt;&lt;meta property=&quot;al:ios:url&quot; content=&quot;applinks://docs&quot;&gt;&lt;meta property=&quot;al:ios:app_store_id&quot; content=&quot;12345&quot;&gt;&lt;meta property=&quot;al:ios:app_name&quot; content=&quot;App Links&quot;&gt;&lt;!-- Android --&gt;&lt;meta property=&quot;al:android:url&quot; content=&quot;applinks://docs&quot;&gt;&lt;meta property=&quot;al:android:app_name&quot; content=&quot;App Links&quot;&gt;&lt;meta property=&quot;al:android:package&quot; content=&quot;org.applinks&quot;&gt;&lt;!-- Web Fallback Webæ›¿ä»£æ˜¾ç¤ºèµ„æºæ–‡ä»¶ --&gt;&lt;meta property=&quot;al:web:url&quot; content=&quot;http://applinks.org/documentation&quot;&gt;&lt;!-- æ›´å¤šä¿¡æ¯: http://applinks.org/documentation/ --&gt; App Links Docs Browsers (Chinese)360 æµè§ˆå™¨12&lt;!-- [æŒ‰æŒ‡å®šé¡ºåºé€‰æ‹©æ¸²æŸ“å¼•æ“](!http://se.360.cn/v6/help/meta.html) --&gt;&lt;meta name=&quot;renderer&quot; content=&quot;webkit|ie-comp|ie-stand&quot;&gt; QQ æ‰‹æœºæµè§ˆå™¨123456&lt;!-- å°†å±å¹•é”å®šä¸ºæŒ‡å®šæ–¹å‘ ç«–å±/æ¨ªå± --&gt;&lt;meta name=&quot;x5-orientation&quot; content=&quot;landscape/portrait&quot;&gt;&lt;!-- è®¾ç½®é¡µé¢å…¨å±æ˜¾ç¤º --&gt;&lt;meta name=&quot;x5-fullscreen&quot; content=&quot;true&quot;&gt;&lt;!-- å¼€å¯ç½‘é¡µåº”ç”¨æ¨¡å¼ (å…¨å±,etc.) --&gt;&lt;meta name=&quot;x5-page-mode&quot; content=&quot;app&quot;&gt; QQæ‰‹æœºæµè§ˆå™¨ UC æ‰‹æœºæµè§ˆå™¨1234567891011121314&lt;!-- å¼ºåˆ¶é¡µé¢æ¨ªå±/ç«–å±æ˜¾ç¤º --&gt;&lt;meta name=&quot;screen-orientation&quot; content=&quot;landscape/portrait&quot;&gt;&lt;!-- è®¾ç½®é¡µé¢å…¨å±æ˜¾ç¤º --&gt;&lt;meta name=&quot;full-screen&quot; content=&quot;yes&quot;&gt;&lt;!-- å³ä½¿æ˜¯æ— å›¾æ¨¡å¼UCæµè§ˆå™¨ä»ä¼šæ˜¾ç¤ºå›¾ç‰‡ --&gt;&lt;meta name=&quot;imagemode&quot; content=&quot;force&quot;&gt;&lt;!-- è°ƒç”¨åº”ç”¨æ¨¡å¼(å…¨å±,ç¦æ­¢æ‰‹åŠ¿, etc.) --&gt;&lt;meta name=&quot;browsermode&quot; content=&quot;application&quot;&gt;&lt;!-- ç¦ç”¨ UCæµè§ˆå™¨çš„å¤œé—´æ¨¡å¼ --&gt;&lt;meta name=&quot;nightmode&quot; content=&quot;disable&quot;&gt;&lt;!-- ç®€åŒ–é¡µé¢çš„å¤„ç†ï¼Œä½¿å¾—é¡µé¢å†…å®¹æ›´é€‚åˆè¿›è¡Œé¡µé¢é˜…è¯»ã€èŠ‚çœæµé‡åŠå“åº”æ›´å¿« --&gt;&lt;meta name=&quot;layoutmode&quot; content=&quot;fitscreen&quot;&gt;&lt;!-- ç¦ç”¨UCæµè§ˆå™¨çš„ç‰¹æ€§:â€œå½“é¡µé¢æ–‡å­—å¤šæ—¶ï¼Œæ”¾å¤§å­—ä½“â€ã€‚ --&gt;&lt;meta name=&quot;wap-font-scale&quot; content=&quot;no&quot;&gt; UCæµè§ˆå™¨æ–‡æ¡£ æœ€æ–°ç‰ˆUCæµè§ˆå™¨æ–‡æ¡£ æ³¨é‡Šæ€§èƒ½Moving the href attribute to the beginning of an element improves compression when GZIP is enabled, because the href attribute is used in a, base and link tags.å½“å¯ç”¨ GZIP æ—¶ï¼Œå°† href å±æ€§ç§»åŠ¨åˆ°å…ƒç´ çš„å¼€å§‹å¯ä»¥æé«˜å‹ç¼©ï¼Œå› ä¸º href å±æ€§ åœ¨ a, base and link æ ‡ç­¾ä¸­ä½¿ç”¨ã€‚ ä¾‹å­: 1&lt;link href=&quot;https://fonts.googleapis.com/css?family=Open+Sans:400,700&quot; rel=&quot;stylesheet&quot;&gt; å…¶å®ƒèµ„æº HTML5 Boilerplate Docs: The HTML HTML5 Boilerplate Docs: Extend and customize ç›¸å…³é¡¹ç›® Atom HTML Head Snippets - Atom package for HEAD snippets Sublime Text HTML Head Snippets - Sublime Text package for HEAD snippets head-it - CLI interface for HEAD snippets vue-head - Manipulating the meta information of the HEAD tag for Vue.js","tags":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"http://wangyuekai.com/tags/è½¬è½½/"},{"name":"html","slug":"html","permalink":"http://wangyuekai.com/tags/html/"}]},{"title":"Node.js EventEmitter å­¦ä¹ ","date":"2017-05-17T12:35:05.000Z","path":"2017/05/17/events-learn/","text":"è¯´èµ·Nodeä¸­å‡ ä¸ªæœ€é‡è¦çš„æ¨¡å—ï¼Œé‚£ä¹ˆeventsæ¨¡å—ä¸€å®šåœ¨å…¶ä¸­ï¼Œåœ¨Nodeä¸­å¾ˆå¤šå¾ˆå¤šçš„å…¶ä»–æ¨¡å—éƒ½æ˜¯åŸºäºæˆ–è€…ä¾èµ–äºeventsæ¨¡å—ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯eventsæ¨¡å—å’Œeventsæ¨¡å—çš„ä½¿ç”¨ï¼Œå’Œä¸€äº›æ³¨æ„ç‚¹ æˆ‘ä»¬å‚çœ‹çš„Node v6.10.3æ–‡æ¡£ï¼Œ å¯¹äºEventEmitterçš„æ–¹æ³•æˆ‘ä»¬ä¸è§£é‡Šï¼Œç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå®˜æ–¹ä¹Ÿç»™å‡ºäº†è¾ƒå¤šçš„ä¾‹å­ï¼Œå®Œå…¨å¯ä»¥å‚çœ‹å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿™é‡Œå°±è¯´æ˜ä¸€äº›æ³¨æ„ç‚¹ EventEmitterå®ä¾‹åŒ–é¦–å…ˆå¾ˆå¤šçš„æ•™ç¨‹é‡Œé¢ä¼šå†™ä»¥ä¸‹çš„ä»£ç æ¥å®ä¾‹åŒ–ä¸€ä¸ªEventEmitter 12var events = require(&apos;events&apos;);var emitter = new events.EventEmitter(); ä½†æ˜¯å®˜æ–¹ç»™å‡ºçš„ä¾‹å­å´æ˜¯ 12345const EventEmitter = require(&apos;events&apos;);class MyEmitter extends EventEmitter &#123;&#125;const myEmitter = new MyEmitter(); åœ¨REPLä¸­è¾“å‡ºconst EventEmitter = require(&#39;events&#39;);ä¸­çš„EventEmitter 1234567EventEmitter&#123; [Function: EventEmitter] EventEmitter: [Circular], // å¾ªç¯å¼•ç”¨ usingDomains: true, defaultMaxListeners: [Getter/Setter], init: [Function], listenerCount: [Function] &#125; åŒæ—¶åœ¨ç¿»çœ‹æºç ä¹‹åçœ‹åˆ° 1234module.exports = EventEmitter;// Backwards-compat with node 0.10.xEventEmitter.EventEmitter = EventEmitter; æ‰€ä»¥ï¼Œä¸¤ç§æ–¹å¼éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ„Ÿè§‰æŒ‰ç…§å®˜æ–¹çš„æ–¹å¼ä¼šæ›´å¥½ã€‚ erroräº‹ä»¶å½“ EventEmitter å®ä¾‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè§¦å‘ä¸€ä¸ª â€˜errorâ€™ äº‹ä»¶ã€‚ è¿™åœ¨ Node.js ä¸­æ˜¯ç‰¹æ®Šæƒ…å†µã€‚ å¦‚æœ EventEmitter æ²¡æœ‰ä¸º â€˜errorâ€™ äº‹ä»¶æ³¨å†Œè‡³å°‘ä¸€ä¸ªç›‘å¬å™¨ï¼Œåˆ™å½“ â€˜errorâ€™ äº‹ä»¶è§¦å‘æ—¶ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€æ‰“å°å †æ ˆè·Ÿè¸ªã€ä¸”é€€å‡º Node.js è¿›ç¨‹ã€‚ 123const myEmitter = new MyEmitter();myEmitter.emit(&apos;error&apos;, new Error(&apos;whoops!&apos;));// æŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä½¿ Node.js å¥”æºƒ æ‰€ä»¥åº”è¯¥å§‹ç»ˆä¸º â€˜errorâ€™ äº‹ä»¶æ³¨å†Œç›‘å¬å™¨ã€‚123myEmitter.on(&apos;error&apos;, (err) =&gt; &#123; console.error(&apos;æœ‰é”™è¯¯&apos;);&#125;); å¦å¤–æä¸€å¥ä¸ºäº†é˜²æ­¢ Node.js è¿›ç¨‹å´©æºƒï¼Œå¯ä»¥åœ¨ process å¯¹è±¡çš„ uncaughtException äº‹ä»¶ä¸Šæ³¨å†Œç›‘å¬å™¨ã€‚ 1234567const myEmitter = new MyEmitter();process.on(&apos;uncaughtException&apos;, (err) =&gt; &#123; console.error(&apos;æœ‰é”™è¯¯&apos;);&#125;);myEmitter.emit(&apos;error&apos;, new Error(&apos;whoops!&apos;)); thisä½œç”¨åŸŸåœ¨ES6åŠ å…¥åï¼Œæœ‰äº†ç®­å¤´å‡½æ•°ï¼Œæœ‰æ—¶å€™ä¼šå¯¼è‡´ç›‘å¬å™¨çš„thisä½œç”¨åŸŸçš„ä¸åŒï¼Œè¿™é‡Œéœ€è¦ç¨å¾®æ³¨æ„ä¸€ä¸‹ 1234567891011const myEmitter = new MyEmitter();myEmitter.on(&apos;event&apos;, function(a, b) &#123; console.log(a, b, this); // æ‰“å°: // a b MyEmitter &#123; // domain: null, // _events: &#123; event: [Function] &#125;, // _eventsCount: 1, // _maxListeners: undefined &#125;&#125;);myEmitter.emit(&apos;event&apos;, &apos;a&apos;, &apos;b&apos;); ç®­å¤´å‡½æ•°ç‰ˆæœ¬123456const myEmitter = new MyEmitter();myEmitter.on(&apos;event&apos;, (a, b) =&gt; &#123; console.log(a, b, this); // æ‰“å°: a b &#123;&#125;&#125;);myEmitter.emit(&apos;event&apos;, &apos;a&apos;, &apos;b&apos;); ç›¸ä¿¡äº†è§£è¿‡ç®­å¤´å‡½æ•°çš„åŸç†çš„éƒ½åº”è¯¥å¯ä»¥ç†è§£ã€‚ on() å’Œ addListener() çš„åŒºåˆ«æ²¡æœ‰åŒºåˆ« 1EventEmitter.prototype.on = EventEmitter.prototype.addListener;","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"word-wrap word-break å’Œ white-space","date":"2017-05-15T15:59:09.000Z","path":"2017/05/15/word-wrap-word-break-white-space/","text":"è¿™ä¸‰ä¸ªåœ¨å¯¹äºæ–‡æœ¬çš„æ¢è¡Œä¸å¦å’Œå¦‚ä½•æ¢è¡Œæ—¶ï¼Œç»å¸¸è¢«ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¥ä»”ç»†äº†è§£ä¸€ä¸‹ä¸‰ä¸ªå±æ€§çš„å†…å®¹ã€‚ white-spaceé¡¾åæ€ä¹‰å°±æ˜¯â€œç©ºæ ¼â€,å…¶å®è¿™ä¸ªå±æ€§å°±æ˜¯å¯¹äºç©ºæ ¼å’Œæ¢è¡Œç¬¦çš„æ§åˆ¶ white-space:normalè¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ï¼Œæ¢è¡Œç¬¦ä¼šè¢«å½“ä½œç©ºç™½ç¬¦æ¥å¤„ç†ã€‚å¡«å……lineç›’å­æ—¶ï¼Œå¿…è¦çš„è¯ä¼šæ¢è¡Œã€‚ åœ¨è¿™é‡Œçš„æ¢è¡Œç”Ÿæ•ˆäº†,ä½†æ˜¯æ¢è¡Œåçš„ç©ºæ ¼ä¹Ÿè¢«åˆå¹¶äº†ï¼Œæ‰€ä»¥æ¯ä¸€è¡Œéƒ½æ˜¯ç›´æ¥æ˜¾ç¤ºåœ¨åœ¨æ–‡æœ¬æœ€å‰é¢ white-space:nowrap å’Œ normal ä¸€æ ·ï¼Œè¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ã€‚ä½†æ–‡æœ¬å†…çš„æ¢è¡Œæ— æ•ˆã€‚ åœ¨è¿™é‡Œçš„æ¢è¡Œæ²¡æœ‰ç”Ÿæ•ˆ,æ¢è¡Œåçš„ç©ºæ ¼ä¹Ÿè¢«åˆå¹¶äº†ï¼Œæ‰€ä»¥æ¯ä¸€è¡Œéƒ½æ˜¯ç›´æ¥æ˜¾ç¤ºåœ¨åœ¨æ–‡æœ¬æœ€å‰é¢ï¼ˆä¾æ—§ä¼šå¯¼è‡´æ¢è¡Œï¼‰ white-space:preè¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«ä¿ç•™ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…&lt;br&gt;å…ƒç´ æ—¶æ‰ä¼šæ¢è¡Œã€‚ æ¢è¡Œç”Ÿæ•ˆäº†ï¼Œä¸”ç©ºæ ¼æ²¡æœ‰åˆå¹¶ #### white-space:pre-wrap è¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«ä¿ç•™ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…``å…ƒç´ ï¼Œæˆ–è€…éœ€è¦ä¸ºäº†å¡«å……lineç›’å­æ—¶æ‰ä¼šæ¢è¡Œã€‚ white-space:pre-lineè¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…&lt;br&gt;å…ƒç´ ï¼Œæˆ–è€…éœ€è¦ä¸ºäº†å¡«å……lineç›’å­æ—¶ä¼šæ¢è¡Œã€‚ æ¢è¡Œç¬¦ ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦ æ–‡å­—è½¬è¡Œ normal åˆå¹¶ åˆå¹¶ è½¬è¡Œ nowrap åˆå¹¶ åˆå¹¶ ä¸è½¬è¡Œ pre ä¿ç•™ ä¿ç•™ ä¸è½¬è¡Œ pre-wrap ä¿ç•™ ä¿ç•™ è½¬è¡Œ pre-line ä¿ç•™ åˆå¹¶ è½¬è¡Œ word-wrap word-breaké¦–å…ˆæˆ‘åœ¨MDNä¸Šå¹¶æ²¡æœ‰æ‰¾åˆ°word-wrapï¼ŒåŸæ¥word-wrapå±æ€§åŸæœ¬å±äºå¾®è½¯çš„ä¸€ä¸ªç§æœ‰å±æ€§ï¼Œåœ¨ CSS3 ç°åœ¨çš„æ–‡æœ¬è§„èŒƒè‰æ¡ˆä¸­å·²ç»è¢«é‡åä¸º overflow-wrap ã€‚ word-wrap ç°åœ¨è¢«å½“ä½œ overflow-wrap çš„ â€œåˆ«åâ€ã€‚ ç¨³å®šçš„è°·æ­Œ Chrome å’Œ Opera æµè§ˆå™¨ç‰ˆæœ¬æ”¯æŒè¿™ç§æ–°è¯­æ³•ã€‚","tags":[{"name":"css","slug":"css","permalink":"http://wangyuekai.com/tags/css/"}]},{"title":"-è½¬è½½-è‡ªå®šä¹‰ç»„åˆå­—ä½“","date":"2017-05-14T05:43:25.000Z","path":"2017/05/14/combining-fonts/","text":"æœ¬æ–‡è½¬è½½è‡ªï¼šä¼—æˆç¿»è¯‘è¯‘è€…ï¼šä¸ºä¹‹æ¼«ç¬”é“¾æ¥ï¼šhttp://www.zcfy.cc/article/2767åŸæ–‡ï¼šhttps://jakearchibald.com/2017/combining-fonts/ æˆ‘å–œæ¬¢å­—ä½“Just Another Handï¼Œæˆ‘ç»å¸¸åœ¨æˆ‘åˆ†äº«ä¸­çš„å›¾ç¤ºé‡Œç”¨å®ƒï¼š (å­—ä½“è½¬å›¾ç‰‡äº†ã€‚â€”â€”è¯‘è€…æ³¨)é—®é¢˜åœ¨äºï¼Œæˆ‘ä¸å–œæ¬¢è¿å­—å·å’Œç­‰å·çš„å­—å½¢â€¦â€¦ (å­—ä½“è½¬å›¾ç‰‡äº†ã€‚â€”â€”è¯‘è€…æ³¨) å®ƒä»¬çš„ä½ç½®è®©äººçœ‹ç€ä¸èˆ’æœï¼Œä½ç½®å¤ªé«˜äº†ã€‚ å¥½åœ¨CSSæ”¯æŒåˆå¹¶å­—ä½“ï¼Œå› è€Œæˆ‘å¯ä»¥åˆ›é€ ä¸€ä¸ªç±»ä¼¼äºJust Another Handçš„å­—ä½“æ—ï¼Œä¸åŒåœ¨äºå…¶ä¸­çš„è¿å­—ç¬¦å’Œç­‰äºå·æ¥è‡ªå¦ä¸€æ¬¾å­—ä½“ï¼š Architects Daughterã€‚ (å­—ä½“è½¬å›¾ç‰‡äº†ã€‚â€”â€”è¯‘è€…æ³¨) æ€ä¹ˆåšåˆ°åƒå¾€å¸¸ä¸€æ ·å®šä¹‰@font-faceï¼š @font-face { font-family: &apos;Just Another Hand Fixed&apos;; font-style: normal; font-weight: 400; src: local(&apos;Just Another Hand&apos;), local(&apos;JustAnotherHand-Regular&apos;), url(&apos;https://fonts.gstatic.com/â€¦woff2&apos;) format(&apos;woff2&apos;), url(&apos;https://fonts.gstatic.com/â€¦woff&apos;) format(&apos;woff&apos;); } ç„¶åå†æ·»åŠ ä¸€ä¸ªåŒåçš„@font-faceï¼ŒåªåŠ å…¥è¿å·å’Œç­‰äºå·ï¼š @font-face { font-family: &apos;Just Another Hand Fixed&apos;; src: local(&apos;Architects Daughter&apos;), local(&apos;ArchitectsDaughter&apos;), url(&apos;https://fonts.gstatic.com/l/â€¦&apos;) format(&apos;woff2&apos;), url(&apos;https://fonts.gstatic.com/l/â€¦&apos;) format(&apos;woff&apos;); unicode-range: U+2d, U+3d; } å…³é”®æ˜¯unicode-rangeæè¿°ç¬¦ã€‚å®ƒæŒ‡å®šä¸Šé¢çš„srcåªèƒ½ç”¨äºè¿å­—å·ï¼ˆU+2dï¼‰å’Œç­‰äºå·ï¼ˆU+3dï¼‰çš„ç ç‚¹ã€‚ç”¨ä»¥ä¸‹æ–¹å¼å¯ä»¥æŠŠUnicodeå­—ç¬¦è½¬æ¢ä¸ºç ç‚¹ï¼š &apos;=&apos;.codePointAt(0).toString(16); // &quot;3d&quot; æˆ‘è¿˜ä½¿ç”¨äº†Google fontsâ€™ text parameterå–å¾—â€œArchitects Daughterâ€å­—ä½“çš„å­é›†ï¼Œå…¶ä¸­åªåŒ…å«è¿å­—å·å’Œç­‰äºå·ï¼ŒæŠŠä½“ç§¯å‡è‡³æœ€å°ã€‚woff2ç‰ˆåªæœ‰500å­—èŠ‚ï¼Œä¸é”™ï¼ è¿™æ ·å°±è¡Œäº†ã€‚ç„¶åå°±å¯ä»¥è¿™æ ·ç”¨ï¼š .whatever { font-family: &apos;Just Another Hand Fixed&apos;; } â€¦â€¦æ­¤æ—¶ç”¨çš„å°±æ˜¯ç»„åˆåçš„å­—ä½“äº†ï¼ æ›´æ–°ï¼šä¸éœ€è¦ç”¨unicode-rangleå—ï¼ŸTwitterå’Œè¯„è®ºä¸­æœ‰å‡ ä½æœ‹å‹è¯´ï¼Œä¸éœ€è¦unicode-rangeï¼Œåªè¦è¿™æ ·å³å¯ï¼š /* Subsetted font */ @font-face { font-family: &apos;Just Another Hand Fixed&apos;; src: url(&apos;https://fonts.gstatic.com/l/â€¦&apos;) format(&apos;woff2&apos;) â€¦; } /* Main font */ @font-face { font-family: &apos;Just Another Hand Fixed&apos;; src: url(&apos;https://fonts.gstatic.com/â€¦woff2&apos;) format(&apos;woff2&apos;) â€¦; } è¡¨é¢ä¸Šå¯è¡Œï¼Œä½†æ€§èƒ½ä¸å¥½ã€‚ ä¸‡ä¸€æµè§ˆå™¨å…ˆä¸‹è½½äº†å­é›†åŒ–çš„å­—ä½“ï¼ˆSubsetted fontï¼‰ï¼Œå‘ç°è¿™ä¸ªå­—ä½“ç¼ºå°‘å®ƒéœ€è¦çš„å­—å½¢ï¼Œå°±ä¼šä¸‹è½½ä¸»å­—ä½“ï¼ˆMain fontï¼‰ã€‚å­—ä½“æ˜¯ä¸€ä¸ªä¸€ä¸ªä¸‹è½½ã€‚ Live demo.Network waterfall. è€Œä½¿ç”¨unicode-rangeï¼Œæµè§ˆå™¨é¢„å…ˆçŸ¥é“è‡ªå·±å…ˆéœ€è¦ä»€ä¹ˆï¼Œå› æ­¤å¯ä»¥å¹¶è¡Œä¸‹è½½å­—ä½“ã€‚ Live demo.Network waterfall. è€Œä¸”ï¼Œå¦‚æœä½ æ ¹æœ¬æ²¡æœ‰ç”¨åˆ°å­é›†åŒ–å­—ä½“ä¸­å­—å½¢ï¼Œæµè§ˆå™¨çŸ¥é“è‡ªå·±æ ¹æœ¬ä¸ç”¨ä¸‹è½½å®ƒï¼ Live demo.Network waterfall.","tags":[{"name":"css","slug":"css","permalink":"http://wangyuekai.com/tags/css/"}]},{"title":"jsæµ®ç‚¹è¿ç®—ç²¾åº¦é—®é¢˜å’ŒIEEE754","date":"2017-05-14T05:34:37.000Z","path":"2017/05/14/ieee754-and-js-float-point-calculation/","text":"å½“æˆ‘ä»¬ä½¿ç”¨ä¸€æ®µæ—¶é—´çš„JSä¹‹åä¼šé‡åˆ°ä¸‹é¢è¿™ä¸ªé—®é¢˜ 10.1 + 0.2 === 0.3 // false æˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°é‡Œé¢çœ‹åˆ°0.1+0.2è¾“å‡ºçš„å¹¶ä¸æ˜¯0.3è€Œæ˜¯0.30000000000000004ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆå‡ºç°è¿™æ ·çš„é—®é¢˜å‘¢ã€‚å…¶å®å‡ºç°è¿™æ ·çš„é—®é¢˜åœ¨äºjsä½¿ç”¨äº†IEEE754äºŒè¿›åˆ¶æµ®ç‚¹æ•°ç®—æœ¯æ ‡å‡†ï¼Œè¿™ä¸ªæ ‡å‡†å¯¹äº1/2, 1/4, 1/8ç­‰æ•°å­—æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œå…¶å®è¿™ä¸ªæ ‡å‡†ä¹Ÿæ˜¯ç°åœ¨å¤§å¤šæ•°è¯­è¨€,CPUå’Œæµ®ç‚¹è®¡ç®—å™¨é€‰æ‹©çš„æµ®ç‚¹æ•°ç®—æœ¯æ ‡å‡†ã€‚ å› ä¸ºIEEE754æ˜¯äºŒè¿›åˆ¶çš„è§„åˆ™ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åšç”¨n*2^mè¿™æ ·çš„è¡¨ç¤ºæ–¹å¼,è¿™æ ·çš„è¡¨è¾¾å¼åœ¨æœ‰é™çš„å­˜å‚¨ç©ºé—´ä¸‹æ— æ³•è¡¨ç¤ºn*10^mç±»å‹æ•°å­—ï¼Œæ‰€ä»¥å¾ˆç®€å•çš„0.1æ— æ³•è¢«å‡†ç¡®çš„è¡¨ç¤ºã€‚ ä½†æ˜¯ç±»ä¼¼Javaç­‰å¾ˆå¤šè¯­è¨€åœ¨åº•å±‚ä¼šå¯¹æµ®ç‚¹é¢„ç®—æœ‰å¤„ç†ï¼Œæ‰€ä»¥çœ‹ä¸Šå»å¥½åƒæ²¡æœ‰é‡åˆ°JSä¸­çš„é—®é¢˜ æœ‰äººè®¤ä¸ºï¼Œ JavaScript åº”è¯¥é‡‡ç”¨ä¸€ç§å¯ä»¥ç²¾ç¡®å‘ˆç°æ•°å­—çš„å®ç°æ–¹å¼ã€‚ ä¸€ç›´ä»¥ æ¥å‡ºç°è¿‡å¾ˆå¤šæ›¿ä»£æ–¹æ¡ˆï¼Œåªæ˜¯éƒ½æ²¡èƒ½æˆä¸ºæ ‡å‡†ï¼Œä»¥åå¤§æ¦‚ä¹Ÿä¸ä¼šã€‚è¿™ä¸ªé—®é¢˜ çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™ä¸ç„¶ï¼Œå¦åˆ™æ—©å°±è§£å†³äº†ã€‚ ä¸ºä»€ä¹ˆè¯´åœ¨æœ‰é™çš„å­˜å‚¨ç©ºé—´ä¸‹æ— æ³•å‡†ç¡®è¡¨ç¤ºå‘¢ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹IEEE754æ˜¯å¦‚ä½•æ¥è¡¨ç¤ºä¸€ä¸ªæ•°å­—çš„å§ã€‚ å…³äºIEEE754æœ‰å•ç²¾åº¦å’ŒåŒç²¾åº¦ä¸¤ç§æ–¹å¼ï¼Œä¸¤ä¸ªæ–¹å¼çš„è®¡ç®—è§„åˆ™éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å•ç²¾åº¦ä½¿ç”¨32ä½æ¥å­˜å‚¨ä¸€ä¸ªæ•°å­—ï¼Œè€ŒåŒç²¾åº¦ä½¿ç”¨64ä½æ¥å­˜å‚¨ï¼Œåªæ˜¯ç”¨äºå­˜å‚¨çš„ä½æ•°çš„å¤§å°ã€‚ å…³äºIEEE754æ¯ä½è¡¨ç¤ºçš„æ„æ€ï¼Œè¿™é‡Œä¸è¯¦ç»†è¯´æ˜ï¼Œè¯¦ç»†å¯ä»¥æŸ¥çœ‹wiki IEEE 754 ç®€å•æ¥è¯´å°±æ˜¯IEEE754å¯¹äºæ•°å­—çš„è¡¨è¾¾æ–¹å¼æ˜¯1n = (-1)^s * 2^(e-127) * (1 + f) (å³è¾¹ä¸ºç¬¬0ä½)å•ç²¾åº¦ s : ç¬¬31ä½ e : ç¬¬30è‡³23ä½ f : ç¬¬22æŒ‡0ä½ å•ç²¾åº¦ s : ç¬¬63ä½ e : ç¬¬62è‡³52ä½ f : ç¬¬51æŒ‡0ä½ æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜IEEEçš„è¡¨è¾¾æ–¹å¼ s e f 0 0111 1110 1100 0000 0000 0000 0000 000 åœ¨è¿™é‡Œs = 0ï¼Œeè½¬ä¸º10è¿›åˆ¶æ˜¯126ï¼Œ fä¸­å·¦æ•°ç¬¬ä¸€ä½è¡¨ç¤º 1 / 2^1,ç¬¬äºŒä½è¡¨ç¤º1 / 2^2,ä¾æ¬¡ç±»æ¨ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œf = 1 / 2^1 + 1 / 2^2 = 0.75; æ‰€ä»¥ n = (-1)^0 * 2^(126-127) * (1+0.75) = 0.875; å€’è¿‡æ¥ï¼Œå¦‚æœæˆ‘ä»¬ç»™åˆ°çš„æ•°å­—æ˜¯23.56ï¼Œé‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬å…ˆç”¨äºŒè¿›åˆ¶è¡¨ç¤ºè¿™ä¸ªæ•°å­—ï¼Œä¸º10111.1000111101011100001,ç„¶åæˆ‘ä»¬å°†å°æ•°ç‚¹ç§»åˆ°å‰é¢åªæœ‰ä¸€ä½æ•°å­—ï¼Œè¿™é‡Œæˆ‘ä»¬å·¦ç§»äº†4ä½å˜æˆ1.01111000111101011100001ï¼Œç„¶åé™¤å»ç¬¬ä¸€ä½çš„01111000111101011100001å¡«å…¥22-0ä½ï¼Œå› ä¸ºæ˜¯æ­£æ•°ï¼Œæ‰€ä»¥ç¬¬31ä½ä¸º0ï¼Œç„¶åæˆ‘ä»¬å·¦ç§»äº†4ä½ï¼Œæ‰€ä»¥è¯´æ˜(e-127) = 4ï¼Œæ‰€ä»¥e=131ï¼Œè½¬ä¸ºäºŒè¿›åˆ¶ï¼Œæ‰€ä»¥ç¬¬30è‡³23ä½ä¸º1000 0011,ä»è€Œå¾—åˆ°äº†ç»“æœã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ieee754ä¸­é‚£ä¸ªæ— æ³•å‡†ç¡®è¡¨è¾¾çš„0.1ã€‚é¦–å…ˆå°†0.1è½¬ä¸ºäºŒè¿›åˆ¶ï¼Œ10è¿›åˆ¶è½¬äºŒè¿›åˆ¶å¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥åˆ°ï¼Œåœ¨å¦‚æœä¸è€ƒè™‘å­˜å‚¨çš„è¯ï¼Œåº”è¯¥æ˜¯0.000110001100011â€¦,å¯ä»¥çœ‹åˆ°æ˜¯00011çš„æ— é™å¾ªç¯ï¼Œå…¶å®å¦‚æœåœ¨å­˜å‚¨é•¿åº¦æ²¡æœ‰é™åˆ¶çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ç®€å•çš„è®¡ç®—æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ— é™å¾ªç¯å°±æ˜¯ç­‰äº0.1ã€‚ 000011 = 3 2 / (1 / 2^4), ç­‰å¼ä¸º 3 2 ( 1/2^4 + 1/2^8 â€¦ 1/2^4n)ã€‚é€šè¿‡ç­‰æ¯”æ•°åˆ—è¿ç®— s = 3 2 (1/2^4) (1- (1/2^4)^n) / (1 - 1 /2^4) = 3 2 * 1 / 15 = 0.1 é‚£ä¹ˆæˆ‘ä»¬æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥åœ¨jsä¸­å®‰å…¨çš„ä½¿ç”¨æµ®ç‚¹è¿ç®—å‘¢ï¼Œå¯èƒ½è¯´æ²¡æœ‰æœ‰å®Œç¾çš„è§£å†³åŠæ³• ä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›ç®€å•çš„å¤„ç†åŠæ³•ã€‚ å¯¹äºè®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨toFixedæ¥å¤„ç†toFixedæ˜¯ç”¨æ¥å¼ºåˆ¶ä¿ç•™å°æ•°ç‚¹åé¢çš„ä½æ•°ï¼Œå¯ä»¥ç”¨äºå¤§å¤šæ•°ç²¾åº¦è¦æ±‚ä¸æ˜¯éå¸¸é«˜çš„è®¡ç®—ä¸­ 1(0.1 + 0.2).toFixed(2) // 0.30 æœ€å¸¸è§çš„æ–¹æ³•æ˜¯è®¾ç½®ä¸€ä¸ªè¯¯å·®èŒƒå›´å€¼ï¼Œ é€šå¸¸ç§°ä¸ºâ€œæœºå™¨ç²¾åº¦â€ï¼ˆmachine epsilonï¼‰ ï¼Œ å¯¹JavaScriptçš„æ•°å­—æ¥è¯´ï¼Œè¿™ä¸ªå€¼é€šå¸¸æ˜¯ 2^-52 (2.220446049250313e-16) ã€‚ ä» ES6 å¼€å§‹ï¼Œ è¯¥å€¼å®šä¹‰åœ¨ Number.EPSILONä¸­ï¼Œ æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ï¼Œ ä¹Ÿå¯ä»¥ä¸º ES6 ä¹‹å‰ çš„ç‰ˆæœ¬å†™ polyï¬llï¼š 123if (!Number.EPSILON) &#123; Number.EPSILON = Math.pow(2,-52);&#125; å¯ä»¥ä½¿ç”¨ Number.EPSILONæ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—æ˜¯å¦ç›¸ç­‰ï¼ˆåœ¨æŒ‡å®šçš„è¯¯å·®èŒƒå›´å†…ï¼‰ï¼š 123456789function numbersCloseEnoughToEqual(n1,n2) &#123; return Math.abs( n1 - n2 ) &lt; Number.EPSILON;&#125;var a = 0.1 + 0.2;var b = 0.3;numbersCloseEnoughToEqual( a, b ); // truenumbersCloseEnoughToEqual( 0.0000001, 0.0000002 ); // false","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"for-timeout","date":"2017-05-13T02:44:12.000Z","path":"2017/05/13/for-timeout/","text":"æœ€è¿‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ç¯‡å…³äºforå¾ªç¯çš„é¢è¯•é¢˜ï¼Œå¯ä»¥è®©è‡ªå·±å›é¡¾ä¸€ä¸‹ä½œç”¨åŸŸçš„åŸºç¡€çŸ¥è¯†ã€‚ ä¸å¤šè¯´ï¼Œé¢˜ç›®å¦‚ä¸‹: ä¸‹é¢çš„ä»£ç è¾“å‡ºçš„æ˜¯ä»€ä¹ˆ 12345for (var i = 0; i &lt; 5; i++) &#123; setTimeout(function()&#123; console.log(i) &#125;, 1000)&#125; ç›¸ä¿¡ç¨å¾®äº†è§£è¿‡ä¸€äº›ä½œç”¨åŸŸç›¸å…³çŸ¥è¯†çš„ï¼Œéƒ½å¯ä»¥å¾ˆå¿«å›ç­”å‡ºï¼Œä¼šæ‰“å°å‡º5ä¸ª5ï¼Œè€Œä¸”æ˜¯åœ¨1sååŒæ—¶æ‰“å°å‡ºæ¥ã€‚ å…¶å®è¿™æ®µä»£ç ç›¸å½“äº 123456var i = 0for (; i &lt; 5; i++) &#123; setTimeout(function()&#123; console.log(i) &#125;, 1000)&#125; å…³é”®åœ¨äºvaråˆ›å»ºäº†ä¸€ä¸ªå…¨å±€çš„å˜é‡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªforå¾ªç¯å†…çš„å—ä½œç”¨åŸŸå†…çš„å˜é‡ã€‚ é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆä¿®æ”¹è®©è¾“å‡ºæ”¹ä¸ºæ¯éš”1sè¾“å‡ºï¼Œä¸”è¾“å‡º0-4å‘¢ã€‚ æ—¢ç„¶å—ä½œç”¨åŸŸè§£å†³ä¸äº†æˆ‘ä»¬çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸæ¥ä¿å­˜æˆ‘ä»¬çš„å˜é‡ï¼Œåˆ›å»ºä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œå¾ˆæ˜æ˜¾éœ€è¦ä¸€ä¸ªå‡½æ•° 123456789function timeOutPrint(i) &#123; setTimeout(function()&#123; console.log(i) &#125;, 1000 * i)&#125;for (var i = 0; i &lt; 5; i++) &#123; timeOutPrint(i);&#125; å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨IIFE 1234567for (var i = 0; i &lt; 5; i++) &#123; (function(i)&#123; setTimeout(function()&#123; console.log(i) &#125;, 1000 * i) &#125;)(i)&#125; ä¸è¿‡ä»ä»£ç çš„è§’åº¦æ¥è¯´ä¸Šé¢å°†å‡½æ•°å°è£…èµ·æ¥å¯ä»¥æ›´åŠ ä¾¿äºé˜…è¯» æˆ‘ä»¬æ¢ä¸€ä¸ªè§’åº¦å»çœ‹è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å‡ºç°äº†ä¸€ä¸ªå¼‚æ­¥çš„ä»£ç ï¼Œé‚£ä¹ˆå¤„ç†å¼‚æ­¥çš„å…¶ä¸­ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ä½¿ç”¨promiseã€‚ 1234567891011121314151617function timeOutPrint(i) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(i) resolve(); &#125;, i * 1000); &#125;);&#125;var tasks = [];for (var i = 0; i &lt; 5; i++) &#123; tasks.push(timeOutPrint(i));&#125;Promise.all(tasks).then(()=&gt;&#123; console.log(&apos;end&apos;);&#125;) æˆ‘ä»¬æ¢ä¸€ä¸ªè§’åº¦ï¼Œå…¶å®å½“æˆ‘ä»¬ä¸€å¼€å§‹å†™è¿™æ®µä»£ç ï¼Œå¿ƒé‡Œå…¶å®æ˜¯å¸Œæœ›ï¼Œforå¾ªç¯å¯ä»¥æš‚åœï¼Œç„¶åéš”1sè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ï¼Œé‚£ä¹ˆå¦‚æœæŒ‰ç…§è¿™ä¸ªæ€è·¯å»æ”¹å†™å‘¢ ä½¿ç”¨promiseå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å› ä¸ºjsçš„äº‹ä»¶å¾ªç¯ï¼Œä¼šå¯¼è‡´Promise.resolveä¹Ÿä¼šåœ¨forå¾ªç¯ä¹‹åæ‰§è¡Œï¼Œæ‰€ä»¥ä¸å¯ä»¥ç›´æ¥ä¼ å…¥iï¼Œè¿™ä¸ªç”¨äº†resolveä¼ å€¼å¾—åŠæ³• 123456789101112131415function timeOutPrint(i) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(i) resolve(i); &#125;, 1000); &#125;);&#125;var state = Promise.resolve(-1);for (var i = 0; i &lt; 5; i++) &#123; state = state.then((value) =&gt; &#123; return timeOutPrint(++value); &#125;)&#125; å…¶å®å¦‚æœä½¿ç”¨letå°±å¯ä»¥æœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœ12345678910111213141516function timeOutPrint(i) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(i) resolve(i); &#125;, 1000); &#125;);&#125;var state = Promise.resolve(true);for (var i = 0; i &lt; 5; i++) &#123; let j = i; state = state.then(() =&gt; &#123; return timeOutPrint(j); &#125;)&#125; è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†letçš„ä½¿ç”¨ï¼Œåé¢æˆ‘ä»¬ä¼šå†æ¬¡ç”¨åˆ°è¿™ä¸ªES6çš„è¯­æ³•ã€‚ æˆ‘ä»¬é€šè¿‡ç”Ÿæˆä¸€ç³»åˆ—é¡ºåºæ‰§è¡Œçš„Promiseæ¥å®ç°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰çœŸæ­£çš„ä½¿forå¾ªç¯ä¸­æ–­ï¼Œè€Œä½¿ä»£ç ä¸­æ–­çš„è¯­æ³•åˆ™å¯ä»¥ä½¿ç”¨ES6ä¸­çš„Generatorå’Œyieldã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940function isPromise(obj) &#123; return &apos;function&apos; == typeof obj.then;&#125;var loop = function(gen) &#123; var g = gen(); var run = function() &#123; console.log(g); var r = g.next(); if(r.done) &#123; return; &#125; if(isPromise(r.value)) &#123; r.value.then(()=&gt; &#123; run(g); &#125;) &#125; else &#123; run(g); &#125; &#125;; run();&#125;function timeOutPrint(i) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(i) resolve(i); &#125;, 1000); &#125;);&#125;function *main() &#123; for (var i = 0; i &lt; 5; i++) &#123; yield timeOutPrint(i); &#125;&#125;loop(main); è¿™é‡Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªç®€å•çš„Generatorçš„æ‰§è¡Œå‡½æ•°loopã€‚ Generatorå¯ä»¥å¾ˆå¥½çš„å®ç°ä»£ç æš‚åœçš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸å¯ä»¥æ‰§è¡Œåƒæ™®é€šå‡½æ•°ä¸€æ ·fn()ï¼Œè€Œæ˜¯éœ€è¦æ­é…ä¸€ä¸ªæ‰§è¡Œå‡½æ•°æ¥æ‰§è¡Œ.next()æ–¹æ³•ã€‚ é‚£ä¹ˆæ˜¯å¦æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œasyncå’Œawaitå‡ºç°äº† 1234567891011121314function timeOutPrint(i) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(i) resolve(i); &#125;, 1000); &#125;);&#125;async function main() &#123; for (var i = 0; i &lt; 5; i++) &#123; await timeOutPrint(i); &#125;&#125;main(); æˆ–è€… 123456789101112var sleep = (time) =&gt; new Promise((resolve) =&gt; &#123; setTimeout(resolve, time);&#125;)async function main() &#123; for (var i = 0; i &lt; 5; i++) &#123; await sleep(1000); console.log(i); &#125;&#125;main(); è¿˜è®°å¾—ä¸Šé¢æˆ‘ä»¬ç”¨è¿‡çš„letä¹ˆ12345for ( let i=1; i&lt;=5; i++) &#123; setTimeout( function timer() &#123; console.log( i ); &#125;ï¼Œi*1000 );&#125; è¯´æ˜å¯ä»¥å‚çœ‹å—çº§ä½œç”¨åŸŸå’Œlet","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"jsä¸­ç±»çš„å®ç°æ–¹å¼","date":"2017-05-11T14:47:25.000Z","path":"2017/05/11/class-in-js/","text":"æ„é€ å‡½æ•°æ–¹æ³•ç±»çš„å®šä¹‰123456789var Animal = function(name) &#123; this.name = name;&#125;Animal.prototype.say = function() &#123; console.log(&apos;say&apos;);&#125;var a = new Animal(&apos;xiao&apos;);a.say(); // &quot;say&quot; ç±»çš„ç»§æ‰¿12345678910111213141516171819202122232425function extend(Child, Parent) &#123; var F = function()&#123;&#125;; F.prototype = Parent.prototype; Child.prototype = new F(); Child.prototype.constructor = Child; Child.uber = Parent.prototype;&#125;var Cat = function(name, age) &#123; this.name = name; this.age = age;&#125;extend(Cat, Animal);Cat.prototype.eat = function() &#123; console.log(&apos;eat&apos;);&#125;var gaffey = new Cat(&apos;gaffey&apos;, 5);gaffey.say() // &quot;say&quot;gaffey.eat() // &quot;eat&quot; å¯¹è±¡æ–¹æ³•ï¼ˆéæ„é€ å‡½æ•°ï¼‰è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ä½¿ç”¨äº†es5çš„Object.create()å‡½æ•° Object.create()å‡½æ•°çš„ä½œç”¨ç±»ä¼¼ä¸‹é¢,ä½†æ˜¯çœŸå®çš„Object.create()è¦å¤æ‚çš„å¤šï¼Œå…·ä½“å¯ä»¥å‚çœ‹MDNå…³äºObject.create()çš„Polyfill å…¶å®å’Œä¸Šé¢æ„é€ å‡½æ•°çš„åŸç†æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä¸Šé¢çš„æ–¹å¼éœ€è¦ç”¨åˆ°prototypeï¼Œthisç­‰çŸ¥è¯†ï¼Œç›¸å¯¹å¤æ‚ï¼Œæ‰€ä»¥es5å‡ºç°äº†Object.create(); 12345Object.create = function (o) &#123; function F() &#123;&#125; F.prototype = o; return new F();&#125;; ç±»çš„å®šä¹‰12345678var Animal = &#123; name: &quot;&quot;, say: function() &#123; console.log(&quot;say&quot;) &#125;&#125;var a = Object.create(Animal) ç±»çš„ç»§æ‰¿123456789101112131415var Cat = &#123; eat: function() &#123; console.log(eat); &#125;&#125;function extend(Child, Parent) &#123; Object.setPrototypeOf(Child, Parent);&#125;extend(Cat, Animal);var gaffey = Object.create(Cat)gaffey.say() // &quot;say&quot;gaffey.eat() // &quot;eat&quot; ES6çš„classç±»çš„å®šä¹‰1234567891011class Animal &#123; constructor(name) &#123; this.name = name; &#125; say() &#123; console.log(&quot;say&quot;); &#125;&#125;var a = Animal(&apos;xiao&apos;); ç±»çš„ç»§æ‰¿123456789101112class Cat extends Animal &#123; constructor(name, age) &#123; super(name); // è°ƒç”¨çˆ¶ç±»çš„constructor(name) this.age = age; &#125; eat() &#123; console.log(&apos;eat&apos;); &#125;&#125;var gaffey = new Cat(&apos;gaffey&apos;, 5);console.log(gaffey);","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"cssä¸­çš„å‚ç›´å±…ä¸­","date":"2017-05-09T15:21:36.000Z","path":"2017/05/09/vertical-center/","text":"absolute + margin-topåœ¨å­å…ƒç´ é«˜åº¦ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¯é‡‡ç”¨ç»å¯¹å®šä½å’Œmargin-topæ¥å®ç°12345678910111213141516171819.demo-wapper-1 &#123; border: 1px solid #ccc; height: 300px; position: relative;&#125;.demo-content-1 &#123; background-color: gray; height: 100px; width: 200px; position: absolute; top: 50%; margin-top: -50px; // åŒæ—¶ä¿æŒæ°´å¹³å±…ä¸­ left: 50%; margin-left: -100px;&#125;&lt;div class=&quot;demo-wapper-1&quot;&gt; &lt;div class=&quot;demo-content-1&quot;&gt;&lt;/div&gt;&lt;/div&gt; .demo-wapper-1{border:1px solid #ccc;height:300px;position:relative}.demo-content-1{background-color:gray;height:100px;width:200px;position:absolute;top:50%;margin-top:-50px;left:50%;margin-left:-100px} line-heightå½“å­å…ƒç´ ä¸ºå•è¡Œæ–‡æœ¬æ—¶ï¼Œå¯ä»¥è®¾ç½®çˆ¶å…ƒç´ çš„è¡Œé«˜æ¥ä¿æŒå‚ç›´å±…ä¸­1234567891011121314.demo-wapper-2 &#123; border: 1px solid #ccc; height: 200px; line-height: 200px; text-align: center&#125;.demo-content-2 &#123; background-color: gray; display: inline&#125;&lt;div class=&quot;demo-wapper-2&quot;&gt; &lt;div class=&quot;demo-content-2&quot;&gt;&lt;/div&gt;&lt;/div&gt; .demo-wapper-2{border:1px solid #ccc;height:200px;line-height:200px;text-align:center}.demo-content-2{background-color:gray;display:inline} 12345 vertical-alignæ–¹æ³•ä¸€ä½¿ç”¨tableå’Œtdæ¥å®ç° 1234567891011121314151617.demo-table &#123; border: 1px solid #ccc; height: 200px;&#125;.demo-table td &#123; text-align: center; vertical-align: middle;&#125;&lt;table class=&quot;demo-table&quot;&gt; &lt;tr&gt; &lt;td&gt; I&apos;m vertically centered multiple lines of text in a real table cell.&lt;br&gt; I&apos;m vertically centered multiple lines of text in a real table cell.&lt;br&gt; I&apos;m vertically centered multiple lines of text in a real table cell. &lt;/td&gt; &lt;/tr&gt;&lt;/table&gt; .demo-table{border:1px solid #ccc;height:200px}.demo-table td{text-align:center;vertical-align:middle} Iâ€™m vertically centered multiple lines of text in a real table cell.Iâ€™m vertically centered multiple lines of text in a real table cell.Iâ€™m vertically centered multiple lines of text in a real table cell. æ–¹æ³•äºŒæ¨¡ä»¿ä¸Šé¢çš„å½¢å¼ï¼Œæ‰‹åŠ¨ä½¿ç”¨display:tableå’Œtable-cellæ¥å®ç° 1234567891011121314151617.demo-wapper-3 &#123; border: 1px solid #ccc; height: 200px; width: 100%; display: table;&#125;.demo-content-3 &#123; background-color: gray; height: 80px; width: 200px; text-align: center; display: table-cell; vertical-align: middle;&#125;&lt;div class=&quot;demo-wapper-3&quot;&gt; &lt;div class=&quot;demo-content-3&quot;&gt;1234&lt;br&gt;12345&lt;/div&gt;&lt;/div&gt; .demo-wapper-3{border:1px solid #ccc;height:200px;width:100%;display:table}.demo-content-3{background-color:gray;height:80px;width:200px;text-align:center;display:table-cell;vertical-align:middle} 123412345 absolute + tranfromå½“æˆ‘ä»¬ä¸çŸ¥é“ä¸€ä¸ªå¿«å—å…ƒç´ çš„é«˜åº¦æ—¶ï¼Œå¯ä»¥ä½¿ç”¨tranfrom 1234567891011121314151617.demo-wapper-4 &#123; border: 1px solid #ccc; height: 200px; position: relative;&#125;.demo-content-4 &#123; background-color: gray; height: 80px; width: 200px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);&#125;&lt;div class=&quot;demo-wapper-4&quot;&gt; &lt;div class=&quot;demo-content-4&quot;&gt;&lt;/div&gt;&lt;/div&gt; .demo-wapper-4{border:1px solid #ccc;height:200px;position:relative}.demo-content-4{background-color:gray;height:80px;width:200px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)} flexåœ¨å¯ä»¥ä½¿ç”¨flexçš„æ—¶å€™ï¼Œflexå¯èƒ½æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹© 123456789101112131415.demo-wapper-5 &#123; border: 1px solid #ccc; height: 200px; display: flex; justify-content: center; align-items: center;&#125;.demo-content-5 &#123; background-color: gray; height: 80px; width: 200px;&#125;&lt;div class=&quot;demo-wapper-5&quot;&gt; &lt;div class=&quot;demo-content-5&quot;&gt;&lt;/div&gt;&lt;/div&gt; .demo-wapper-5{border:1px solid #ccc;height:200px;display:flex;justify-content:center;align-items:center}.demo-content-5{background-color:gray;height:80px;width:200px} å‚è€ƒæ–‡æ¡£Centering in CSS: A Complete Guide","tags":[{"name":"css","slug":"css","permalink":"http://wangyuekai.com/tags/css/"}]},{"title":"åŸå‹ç»§æ‰¿","date":"2017-05-07T17:53:32.000Z","path":"2017/05/08/prototype-chain-inheritance/","text":"åœ¨ES6ä¸­ï¼Œjsç»ˆäºå‡ºç°äº†æ­£å¼çš„classå…³é”®å­—ï¼Œå¯¹äºjsä¸­ç±»çš„å®ç°å’Œç»§æ‰¿ï¼Œä¼¼ä¹ä¹Ÿç»™å‡ºäº†å®˜æ–¹çš„æ–¹å‘ï¼Œclassä¹Ÿåªæ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œå®é™…è¿˜æ˜¯ä½¿ç”¨äº†jsçš„åŸå‹é“¾æ¥å®ç°äº†ç±»çš„ç»§æ‰¿åŠŸèƒ½ã€‚ æ‰€ä»¥äº†è§£åŸå‹é“¾ç»§æ‰¿å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£å’Œå­¦ä¹ JSä¸­çš„ç±»å’Œç»§æ‰¿ï¼Œå·²ç»ES6ä¸­çš„classã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£åŸå‹é“¾æ˜¯ä»€ä¹ˆæ„æ€ã€‚ JavaScript å¸¸è¢«æè¿°ä¸ºä¸€ç§åŸºäºåŸå‹çš„è¯­è¨€ (prototype-based language)â€”â€”æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå¯¹è±¡ä»¥å…¶åŸå‹ä¸ºæ¨¡æ¿ã€ä»åŸå‹ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ã€‚åŸå‹å¯¹è±¡ä¹Ÿå¯èƒ½æ‹¥æœ‰åŸå‹ï¼Œå¹¶ä»ä¸­ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ï¼Œä¸€å±‚ä¸€å±‚ã€ä»¥æ­¤ç±»æ¨ã€‚è¿™ç§å…³ç³»å¸¸è¢«ç§°ä¸ºåŸå‹é“¾ (prototype chain) é¦–å…ˆjsä¸­çš„æ‰€æœ‰å˜é‡å‡ ä¹éƒ½å¯ä»¥è¢«çœ‹åšå¯¹è±¡ï¼Œç„¶åæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šæœ‰å®ƒçš„åŸå‹å¯¹è±¡ï¼Œè€Œå¯¹è±¡ä¸­æœ‰ä¸€ä¸ª[[prototype]]æ¥æŒ‡å‘è‡ªå·±çš„åŸå‹å¯¹è±¡ã€‚ è¿™ä¸ªè®¾è®¡æ„Ÿè§‰å°±åƒæ˜¯å­ç±»å’Œçˆ¶ç±»çš„å…³ç³»ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯å®Œå…¨ç›¸åŒã€‚ è€Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ä½¿ä¸‹é¢è¿™ä¸ªç­‰å¼æˆç«‹ 1childobj.[[prototype]] === parentObj","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"å—çº§ä½œç”¨åŸŸå’Œlet","date":"2017-05-07T12:32:51.000Z","path":"2017/05/07/block-scope-and-let/","text":"åœ¨å­¦ä¹ Javascriptçš„ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨varæ¥åˆ›å»ºå˜é‡ï¼Œéšç€ES6çš„å‘å¸ƒï¼Œå‡ºç°äº†ä¸€ä¸ªä¸€ä¸ªæ–°çš„åˆ›å»ºå˜é‡çš„æ–¹å¼letï¼Œéšç€æµè§ˆå™¨å’Œnodeçš„å¿«é€Ÿæ”¯æŒä»¥åŠbabelçš„å‡ºç°ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æ­£å¼ä½¿ç”¨letã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ç”¨äºæ¯”èµ·ä½¿ç”¨var,letä¼šæ›´å¥½ï¼Œä¸åªæ˜¯åœ¨ä»£ç çš„ç¨³å®šæ€§è¿˜å¯ä»¥å¢åŠ ä»£ç çš„å¯è¯»æ€§ã€‚ æˆ‘ä»¬åœ¨å­¦ä¹ letçš„æ—¶å€™ï¼Œç»å¸¸ä¼šçœ‹åˆ°å¯¹äºletçš„å®šä¹‰ The let statement declares a block scope local variableï¼Œoptionally initializing it to a value.(letè¯­å¥å£°æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„æœ¬åœ°å˜é‡ï¼Œå¹¶ä¸”å¯é€‰çš„èµ‹äºˆåˆå§‹å€¼ã€‚) â€” let MDN æ˜¾è€Œæ˜“è§çš„ï¼Œletå°±æ˜¯ä½œç”¨äºå—çº§ä½œç”¨åŸŸï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯å—çº§ä½œç”¨åŸŸï¼ˆblock scopeï¼‰ã€‚ å¯¹äºå—çº§ä½œç”¨åŸŸMDNçš„å®šä¹‰æ˜¯ è¯­å¥å— (æˆ–å…¶ä»–è¯­è¨€ä¸­çš„ å¤åˆè¯­å¥) ç”¨æ¥ç»„ç»‡é›¶ä¸ªæˆ–å¤šæ¡è¯­å¥. ç”¨ä¸€å¯¹èŠ±æ‹¬å·ç•Œå®šè¯­å¥å—. â€” block MDN è¯­æ³• 123456[label:] &#123; statement_1; statement_2; ... statement_n;&#125; MDNå¯¹äºè¯­æ³•çš„è¯´æ˜ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªè¯´æ˜ï¼Œä¸‹é¢while (x &lt; 10)ä¹Ÿæ˜¯å—çº§ä½œç”¨åŸŸçš„ä¸€éƒ¨åˆ†ã€‚ 123while (x &lt; 10) &#123; x++;&#125; æ‰€ä»¥ç®€å•æ¥è¯´letåœ¨{}ä»¥å†…æˆ–è€…åœ¨ç±»ä¼¼while (x &lt; 10)çš„()ä¸­å®šä¹‰çš„å˜é‡ï¼Œä¸ä¼šè¢«å¤–å±‚çš„ä½œç”¨åŸŸè®¿é—®åˆ°ï¼Œå¦‚ä¸‹çš„ä¾‹å­ 1234if (true) &#123; let x = 2;&#125;console.log(x); // Uncaught ReferenceError: x is not defined åŒæ—¶ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ 12345678910&apos;use strict&apos;;let a = 1;&#123; let a = 2; console.log(a) // 2&#125;let a = 1; è¿™æ®µä»£ç ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæˆ‘è¦è¯´çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸€å¼€å§‹ç”³æ˜äº†&#39;use strict&#39;;ï¼Œè¡¨ç¤ºæˆ‘ä»¬ä½¿ç”¨äº†ä¸¥æ ¼æ¨¡å¼ï¼Œæˆ‘ä»¬ä¸¤æ¬¡å®šä¹‰äº†aå˜é‡ï¼Œä½†æ˜¯ä»£ç æ­£å¸¸æ‰§è¡Œäº†ï¼Œè¯´æ˜äº†{}äº§ç”Ÿäº†æ–°çš„å—ä½œç”¨åŸŸï¼Œæ‰€ä»¥ä»£ç æ­£å¸¸æ‰§è¡Œäº†ã€‚ å¦å¤–å¯¹äºletï¼Œæˆ‘ä»¬å¯ä»¥çœ‹æƒ…å†µå°†å…¶åŒ…è£¹åœ¨{}ä¸­ï¼Œä¸ºå˜é‡æ˜¾å¼å£°æ˜å—ä½œç”¨åŸŸï¼Œè¿™æ ·æ›´åŠ ç¬¦åˆletçš„å—çº§ä½œç”¨åŸŸçš„å®šä¹‰ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿jsçš„åƒåœ¾å›æ”¶æœºåˆ¶æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å›æ”¶ï¼Œä¹Ÿå¯ä»¥å¢åŠ ä»£ç çš„æ¨¡å—åŒ–å’Œå¯è¯»æ€§ï¼Œä¾‹å­å¦‚ä¸‹ 1234567891011function process(data) &#123; // åœ¨è¿™é‡Œåšç‚¹æœ‰è¶£çš„äº‹æƒ…&#125;// åœ¨è¿™ä¸ªå—ä¸­å®šä¹‰çš„å†…å®¹å¯ä»¥é”€æ¯äº†ï¼&#123; let someReallyBigData = &#123; .. &#125;; process( someReallyBigData );&#125;// åšå…¶ä»–çš„äº‹æƒ… æœ€åï¼Œæˆ‘æ¥è§£ç­”ä¸€é“ç½‘ä¸Šç»å¸¸çœ‹åˆ°çš„é¢˜ç›®ï¼Œé¢˜ç›®å’Œè¯¦ç»†è§£ç­”åœ¨æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ä¸­ä¹Ÿæœ‰ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæœ€å¥½çš„ç­”æ¡ˆæ˜¯ï¼Œåªéœ€è¦æŠŠvaræ”¹ä¸ºlet,å…¶å®è¿™é“é¢˜ç›®çš„æœ¬è´¨åœ¨äºvarä¸æ˜¯å—çº§ä½œç”¨åŸŸï¼Œè€Œæˆ‘ä»¬çš„ä»£ç æ˜¯å†™åœ¨å—çº§ä½œç”¨åŸŸä¸­çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„å˜é‡å£°æ˜ï¼Œä¿è¯æ¯ä¸ªå—çº§ä½œç”¨åŸŸéƒ½æ˜¯ä¸ä¸€æ ·çš„å˜é‡ï¼Œç›¸äº’ä¸å½±å“ï¼Œè€Œletåˆšå¥½ã€‚ 1234567891011for ( let i=1; i&lt;=5; i++) &#123; setTimeout( function timer() &#123; console.log( i ); &#125;ï¼Œi*1000 );&#125;// ç›¸éš”1sè¾“å‡º// 1// 2// 3// 4// 5","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"mysqlç»‘å®šåœ°å€","date":"2017-05-05T07:52:25.000Z","path":"2017/05/05/mysql-bind-address/","text":"æœ‰æ—¶å€™éœ€è¦å°†mysqlè¿è¡Œåœ¨127.0.0.1ä¸Šæ¥ä¿è¯åªæœ‰å†…ç½‘è®¿é—®ï¼Œæˆ–è€…éœ€è¦æ”¹åˆ°0.0.0.0æ¥å®ç°è¿œç¨‹é“¾æ¥ 1234vim /etc/mysql/my.cnf// æ‰¾åˆ°bind-addressçš„é…ç½®ï¼Œç„¶åé‡å¯mysqlservice mysql restart","tags":[{"name":"mysql","slug":"mysql","permalink":"http://wangyuekai.com/tags/mysql/"}]},{"title":"front-end tips","date":"2017-05-03T07:33:19.000Z","path":"2017/05/03/js-tips/","text":"argumentsè½¬æ•°ç»„1let args = Array.prototype.slice.call(arguments); åˆ¤æ–­æ˜¯å¦æ˜¯Generator1234// æ¥è‡ªäºco,è¿™é‡Œçš„åˆ¤æ–­å‰ææ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä¼ å…¥çš„å‚æ•°åæ˜¯objfunction isGenerator(obj) &#123; return &apos;function&apos; == typeof obj.next &amp;&amp; &apos;function&apos; == typeof obj.throw;&#125; npm publishnpm publish æ—¶ä¼šå°†.gitignoreæ”¹ä¸º.npmignore é˜²æ­¢ Node.js è¿›ç¨‹å´©æºƒå¯ä»¥åœ¨ process å¯¹è±¡çš„ uncaughtException äº‹ä»¶ä¸Šæ³¨å†Œç›‘å¬å™¨ã€‚1234567const myEmitter = new MyEmitter();process.on(&apos;uncaughtException&apos;, (err) =&gt; &#123; console.error(&apos;æœ‰é”™è¯¯&apos;);&#125;);myEmitter.emit(&apos;error&apos;, new Error(&apos;whoops!&apos;)); min-height max-height heightheightä¼šè¢«min-heightå’Œmax-heightæ‰€å½±å“ï¼Œmin-heightå’Œmax-heightä¸åªæ˜¯è®¾ç½®äº†é«˜åº¦çš„é™åˆ¶ï¼Œlogical-heightç”±3ä¸ªå±æ€§å…±åŒå†³å®š 0.5pxdemo html12345678910111213141516171819202122&lt;div class=&quot;example--border&quot;&gt;&lt;/div&gt;* Firefox: y* Safari: y* Chrome: n* Falls back to 1px for non-Retina (no need to wrap in a media query)## 0.5px box-shadow&lt;div class=&quot;example--box-shadow&quot;&gt;&lt;/div&gt;* Chrome: y* Firefox: y* Safari: n## linear-gradient&lt;div class=&quot;example--gradient&quot;&gt;&lt;/div&gt;* Chrome: y* Safari: y* Firefox: y css1234567891011121314151617[class^=&apos;example&apos;] &#123; margin: 1em 0; height: 1px;&#125;.example--box-shadow &#123; box-shadow: 0 0.5px 0 blue;&#125;.example--border &#123; border-top: 0.5px solid blue;&#125;.example--gradient &#123; background-image: linear-gradient(to bottom, blue 0%, blue 51%, transparent 51%); background-size: 100% 1px;&#125; css triangle principle Node Module Wapper123(function (exports, require, module, __filename, __dirname) &#123;// ä½ çš„æ¨¡å—ä»£ç å®é™…ä¸Šåœ¨è¿™é‡Œ&#125;);","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"ftp-in-docker-container","date":"2017-04-28T17:39:38.000Z","path":"2017/04/29/ftp-in-docker-container/","text":"åœ¨dockerä¸­å®‰è£…vsftpdï¼Œåœ¨å¯åŠ¨vsftpdæœåŠ¡çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¸‹é¢çš„é”™è¯¯ 1&gt; vsftpd failed - probably invalid config æŸ¥äº†å¾ˆå¤šçš„èµ„æ–™ï¼Œæ‰¾åˆ°äº†å¦‚ä¸‹çš„è¯´æ˜å’Œè§£å†³æ–¹æ¡ˆ message â€œvsftpd failed - probably invalid config.â€ is received during boot.Yet the server started normally. This message is issued by /etc/init.d/vsftpd.This message is not issued on every boot, only occasionally. This appears to be a timing problem. The server is started asynchronouslyfrom this script. The script then immediately looks for the PID file; and ifit doesnâ€™t find it issues the above error message. But the server may not yethave had time to create the PID file. Adding â€œsleep 1â€ between start-stop-daemon â€“start â€“background -m â€“oknodo â€“pidfile /var/run/vsftpd/vsftpd.pid â€“exec ${DAEMON} and _PID=â€$(if [ -e /var/run/vsftpd/vsftpd.pid ]; then cat /var/run/vsftpd/vsftpd.pid; fi)â€ seems to fix the problem for me. åŒæ—¶è¿˜æœ‰ä¸€ä¸ªç°æˆçš„è§£å†³çš„ä¾‹å­ å…¶ä¸­çš„è¯¦ç»†çš„ä»£ç ","tags":[{"name":"docker","slug":"docker","permalink":"http://wangyuekai.com/tags/docker/"}]},{"title":"æœ‰è¶£çš„æ–‡ç« å’Œç½‘ç«™","date":"2017-04-28T10:07:53.000Z","path":"2017/04/28/read-history/","text":"2017-07-05https://stateofdev.com/https://tutorialzine.com/ 2017-05-12äººç±»ä¸€ç”Ÿå­˜åœ¨çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ 2017-05-09Vertical-Align: ä½ éœ€è¦çŸ¥é“çš„æ‰€æœ‰äº‹ 2017-05-07[è¯‘]ç¥é©¬æ˜¯AMD, CommonJS, UMD? 2017-05-05Git å·¥ä½œæµç¨‹HTTP ä»£ç†åŸç†åŠå®ç°ï¼ˆä¸€ï¼‰ 2017-05-03YAML è¯­è¨€æ•™ç¨‹RESTful API è®¾è®¡æŒ‡å— 2017-04-29å¦‚ä½•çŸ¥é“ä½ è¯¥å†™ä»€ä¹ˆ 2017-04-28PHP vs Node.js","tags":[]},{"title":"é‚£äº›è¯­è¨€","date":"2017-04-28T08:13:26.000Z","path":"2017/04/28/impressive-sentence/","text":"ç”Ÿè€Œä¸ºäººï¼Œå¯¹ä¸èµ· â€” ã€Šè¢«å«Œå¼ƒçš„æ¾å­çš„ä¸€ç”Ÿã€‹","tags":[{"name":"other","slug":"other","permalink":"http://wangyuekai.com/tags/other/"}]},{"title":"æŸ¥çœ‹Ubuntuç‰ˆæœ¬","date":"2017-04-27T14:32:30.000Z","path":"2017/04/27/get-ubuntu-version/","text":"æŸ¥çœ‹linuxç‰ˆæœ¬ æ–¹æ³•ä¸€123456uname -a&gt; Linux LI 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:12 UTC 2014 i686 athlon i686 GNU/Linux// ä»…ä»…æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬uname -r&gt; 3.13.0-32-generic æ–¹æ³•äºŒ12cat /proc/version &gt; Linux version 3.13.0-32-generic (buildd@roseapple) (gcc version 4.8.2 (Ubuntu 4.8.2-19ubuntu1) ) #57-Ubuntu SMP Tue Jul 15 03:51:12 UTC 2014 æŸ¥çœ‹Ubuntuç‰ˆæœ¬æ–¹æ³•ä¸€12cat /etc/issue&gt; Ubuntu 14.04.2 LTS \\n \\l æ–¹æ³•äºŒ123456sudo lsb_release -a&gt; NO LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 14.04.2 LTS Release: 14.04 Codename: trusty æ–¹æ³•ä¸‰ï¼š12345cat /etc/lsb-release&gt; DISTRIB_ID=Ubuntu DISTRIB_RELEASE=14.04 DISTRIB_CODENAME=trusty DISTRIB_DESCRIPTION=&quot;Ubuntu 14.04.2 LTS&quot;","tags":[]},{"title":"linux","date":"2017-04-27T14:31:32.000Z","path":"2017/04/27/linux/","text":"linuxå¸¸ç”¨æŒ‡ä»¤ é“¾æ¥æŸ¥çœ‹Ubuntuç‰ˆæœ¬ è´¦æˆ·ç®¡ç†æ˜¾ç¤ºå½“å‰è´¦æˆ·12whoami&gt; root æ–°å¢è´¦æˆ·12adduser [username]# useradd kk //æ·»åŠ ç”¨æˆ·kk åˆ‡æ¢è´¦æˆ·1234su [usename]ä¾‹å­: su uftp su root su - root su ä¸ su -å‰è€…åªæ˜¯åˆ‡æ¢äº†rootèº«ä»½ï¼Œä½†Shellç¯å¢ƒä»ç„¶æ˜¯æ™®é€šç”¨æˆ·çš„Shellï¼›è€Œåè€…è¿ç”¨æˆ·å’ŒShellç¯å¢ƒä¸€èµ·åˆ‡æ¢æˆrootèº«ä»½äº†ã€‚åªæœ‰åˆ‡æ¢äº†Shellç¯å¢ƒæ‰ä¸ä¼šå‡ºç°PATHç¯å¢ƒå˜é‡é”™è¯¯ å…³äºsuä¸sudoçš„åŒºåˆ« ï¼Œå¯ä»¥æŸ¥çœ‹ apt-getubuntu æºåœ°å€ http://wiki.ubuntu.org.cn/%E6%BA%90%E5%88%97%E8%A1%A8 ubuntu æºåœ°å€ä¿®æ”¹ åœ°å€ä¿å­˜åœ¨/etc/apt/source.listä¸­ å»ºè®®å¤‡ä»½ cp ./source.list ./source.list_back ç«¯å£æŸ¥è¯¢1netstat -nat netstatè¯¦è§£","tags":[{"name":"linux","slug":"linux","permalink":"http://wangyuekai.com/tags/linux/"}]},{"title":"vimå¿«æ·é”®","date":"2017-04-27T14:30:02.000Z","path":"2017/04/27/vim-shortcut/","text":"#VIM å¿«æ·é”® å…¨å±€:xï¼Œ ZZ æˆ– :wq â†’ ä¿å­˜å¹¶é€€å‡º (:x è¡¨ç¤ºä»…åœ¨éœ€è¦æ—¶ä¿å­˜ï¼ŒZZä¸éœ€è¦è¾“å…¥å†’å·å¹¶å›è½¦) æ’å…¥æ¨¡å¼ a â†’ åœ¨å…‰æ ‡åæ’å…¥o â†’ åœ¨å½“å‰è¡Œåæ’å…¥ä¸€ä¸ªæ–°è¡ŒO â†’ åœ¨å½“å‰è¡Œå‰æ’å…¥ä¸€ä¸ªæ–°è¡Œcw â†’ æ›¿æ¢ä»å…‰æ ‡æ‰€åœ¨ä½ç½®ååˆ°ä¸€ä¸ªå•è¯ç»“å°¾çš„å­—ç¬¦ ç§»åŠ¨å…‰æ ‡ 0 â†’ æ•°å­—é›¶ï¼Œåˆ°è¡Œå¤´^ â†’ åˆ°æœ¬è¡Œç¬¬ä¸€ä¸ªä¸æ˜¯blankå­—ç¬¦çš„ä½ç½®ï¼ˆæ‰€è°“blankå­—ç¬¦å°±æ˜¯ç©ºæ ¼ï¼Œtabï¼Œæ¢è¡Œï¼Œå›è½¦ç­‰ï¼‰$ â†’ åˆ°æœ¬è¡Œè¡Œå°¾g_ â†’ åˆ°æœ¬è¡Œæœ€åä¸€ä¸ªä¸æ˜¯blankå­—ç¬¦çš„ä½ç½®ã€‚/pattern â†’ æœç´¢ pattern çš„å­—ç¬¦ä¸²ï¼ˆå¦‚æœæœç´¢å‡ºå¤šä¸ªåŒ¹é…ï¼Œå¯æŒ‰né”®åˆ°ä¸‹ä¸€ä¸ªï¼‰ æ‹·è´/ç²˜è´´ P â†’ ç²˜è´´yy â†’ æ‹·è´å½“å‰è¡Œå½“è¡Œäº ddP Undo/Redo u â†’ undo\\ â†’ redo jsc-f æ ¼å¼åŒ– ###NERDtreeK åˆ°åŒç›®å½•ç¬¬ä¸€ä¸ªèŠ‚ç‚¹J åˆ°åŒç›®å½•æœ€åä¸€ä¸ªèŠ‚ç‚¹p åˆ°ä¸Šå±‚ç›®å½•s æ¨ªå‘æ‰“å¼€æ–‡ä»¶m æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿèœå•ï¼ˆæ·»åŠ ã€åˆ é™¤ã€ç§»åŠ¨æ“ä½œï¼‰I åˆ‡æ¢æ˜¯å¦æ˜¾ç¤ºéšè—æ–‡ä»¶r é€’å½’åˆ·æ–°é€‰ä¸­ç›®å½•R é€’å½’åˆ·æ–°æ ¹ç»“ç‚¹cd å°† CWD è®¾ä¸ºé€‰ä¸­ç›®å½• ###NerdCommenter åœ¨éæ’å…¥æ¨¡å¼ä¸­é€‰ä¸­è¡Œåè¾“å…¥ä¸‹åˆ—å‘½ä»¤1ã€ \\cc æ³¨é‡Šå½“å‰è¡Œå’Œé€‰ä¸­è¡Œ2ã€ \\cn æ²¡æœ‰å‘ç°å’Œ\\ccæœ‰åŒºåˆ«3ã€ \\c&lt;ç©ºæ ¼&gt; å¦‚æœè¢«é€‰åŒºåŸŸæœ‰éƒ¨åˆ†è¢«æ³¨é‡Šï¼Œåˆ™å¯¹è¢«é€‰åŒºåŸŸæ‰§è¡Œå–æ¶ˆæ³¨é‡Šæ“ä½œï¼Œå…¶å®ƒæƒ…å†µæ‰§è¡Œåè½¬æ³¨é‡Šæ“ä½œ4ã€ \\cm å¯¹è¢«é€‰åŒºåŸŸç”¨ä¸€å¯¹æ³¨é‡Šç¬¦è¿›è¡Œæ³¨é‡Šï¼Œå‰é¢çš„æ³¨é‡Šå¯¹æ¯ä¸€è¡Œéƒ½ä¼šæ·»åŠ æ³¨é‡Š5ã€ \\ci æ‰§è¡Œåè½¬æ³¨é‡Šæ“ä½œï¼Œé€‰ä¸­åŒºåŸŸæ³¨é‡Šéƒ¨åˆ†å–æ¶ˆæ³¨é‡Šï¼Œéæ³¨é‡Šéƒ¨åˆ†æ·»åŠ æ³¨é‡Š6ã€ \\cs æ·»åŠ æ€§æ„Ÿçš„æ³¨é‡Šï¼Œä»£ç å¼€å¤´ä»‹ç»éƒ¨åˆ†é€šå¸¸ä½¿ç”¨è¯¥æ³¨é‡Š7ã€ \\cy æ·»åŠ æ³¨é‡Šï¼Œå¹¶å¤åˆ¶è¢«æ·»åŠ æ³¨é‡Šçš„éƒ¨åˆ†8ã€ \\c$ æ³¨é‡Šå½“å‰å…‰æ ‡åˆ°æ”¹è¡Œç»“å°¾çš„å†…å®¹9ã€ \\cA è·³è½¬åˆ°è¯¥è¡Œç»“å°¾æ·»åŠ æ³¨é‡Šï¼Œå¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼10ã€\\ca è½¬æ¢æ³¨é‡Šçš„æ–¹å¼ï¼Œæ¯”å¦‚ï¼š //å’Œ//11ã€\\cl \\cb å·¦å¯¹é½å’Œå·¦å³å¯¹å…¶ï¼Œå·¦å³å¯¹å…¶ä¸»è¦é’ˆå¯¹//12ã€\\cu å–æ¶ˆæ³¨é‡Š","tags":[{"name":"vim","slug":"vim","permalink":"http://wangyuekai.com/tags/vim/"}]},{"title":"macè“ç‰™ä¸å¯ç”¨","date":"2017-04-02T02:36:20.000Z","path":"2017/04/02/mac-bluetooth-disabled/","text":"macå¼€æœºä»¥åæœ‰æ—¶å€™ä¼šå‡ºç°è“ç‰™ä¸å¯ç”¨çš„æƒ…å†µ è§£å†³åŠæ³•æ–¹æ³•ä¸€ æ–­å¼€æ‰€æœ‰çš„macå¤–æ¥è®¾å¤‡ é‡å¯mac æ–¹æ³•äºŒè¿™ä¸ªåŠæ³•ä¸»è¦æ˜¯é‡ç½®ç”µæºç®¡ç†å•å…ƒå’Œç³»ç»ŸNVRAMæ¢å¤å‡ºå‚è®¾ç½® å…³æœº æŒ‰ä¸‹poweré”®ï¼ˆå¼€æœºé”®ï¼‰,åŒæ—¶æŒ‰ä½option+command+p+r,ç­‰å¾…macå‘å‡º4å£°Duang~çš„å¼€æœºéŸ³åæ¾å¼€ï¼Œç„¶åmacä¼šæ­£å¸¸å¼€æœº è“ç‰™å¯ç”¨","tags":[{"name":"mac","slug":"mac","permalink":"http://wangyuekai.com/tags/mac/"}]},{"title":"cluster","date":"2017-03-21T08:28:11.000Z","path":"2017/03/21/cluster/","text":"å½“æˆ‘ä»¬å»äº†è§£Clusterçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåœ¨nodeçš„å®˜æ–¹æ–‡æ¡£çš„ä¸€å¼€å§‹å°±ä¼šçœ‹åˆ°ä¸€ä¸ªç®€å•çš„ä¾‹å­ 123456789101112131415161718192021222324252627// è¿™ä¸ªä¾‹å­æ˜¯æ ¹æ®cpuçš„æ ¸æ•°æ¥ç”Ÿæˆå¯¹åº”çš„å­è¿›ç¨‹æ•°é‡ï¼Œ// ç„¶åæ¯ä¸ªå­è¿›ç¨‹éƒ½è¿è¡Œä¸€ä¸ªç»‘å®šåˆ°8000ç«¯å£çš„http serverconst cluster = require(&apos;cluster&apos;);const http = require(&apos;http&apos;);const numCPUs = require(&apos;os&apos;).cpus().length;if (cluster.isMaster) &#123; console.log(`Master $&#123;process.pid&#125; is running`); // Fork workers. for (let i = 0; i &lt; numCPUs; i++) &#123; cluster.fork(); &#125; cluster.on(&apos;exit&apos;, (worker, code, signal) =&gt; &#123; console.log(`worker $&#123;worker.process.pid&#125; died`); &#125;);&#125; else &#123; // Workers can share any TCP connection // In this case it is an HTTP server http.createServer((req, res) =&gt; &#123; res.writeHead(200); res.end(&apos;hello world\\n&apos;); &#125;).listen(8000); console.log(`Worker $&#123;process.pid&#125; started`);&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ›å»ºå­è¿›ç¨‹çš„æ–¹å¼å°±æ˜¯å¾ˆç®€å•çš„ä¸€å¥cluster.fork(),æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆæ ·çš„äº‹æƒ…ã€‚ é¦–å…ˆæˆ‘ä»¬æ‰“å°äº†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556function (env) &#123; cluster.setupMaster(); const id = ++ids; const workerProcess = createWorkerProcess(id, env); const worker = new Worker(&#123; id: id, process: workerProcess &#125;); worker.on(&apos;message&apos;, function(message, handle) &#123; cluster.emit(&apos;message&apos;, this, message, handle); &#125;); worker.process.once(&apos;exit&apos;, function(exitCode, signalCode) &#123; /* * Remove the worker from the workers list only * if it has disconnected, otherwise we might * still want to access it. */ if (!worker.isConnected()) &#123; removeHandlesForWorker(worker); removeWorker(worker); &#125; worker.exitedAfterDisconnect = !!worker.exitedAfterDisconnect; worker.state = &apos;dead&apos;; worker.emit(&apos;exit&apos;, exitCode, signalCode); cluster.emit(&apos;exit&apos;, worker, exitCode, signalCode); &#125;); worker.process.once(&apos;disconnect&apos;, function() &#123; /* * Now is a good time to remove the handles * associated with this worker because it is * not connected to the master anymore. */ removeHandlesForWorker(worker); /* * Remove the worker from the workers list only * if its process has exited. Otherwise, we might * still want to access it. */ if (worker.isDead()) removeWorker(worker); worker.exitedAfterDisconnect = !!worker.exitedAfterDisconnect; worker.state = &apos;disconnected&apos;; worker.emit(&apos;disconnect&apos;); cluster.emit(&apos;disconnect&apos;, worker); &#125;); worker.process.on(&apos;internalMessage&apos;, internal(worker, onmessage)); process.nextTick(emitForkNT, worker); cluster.workers[worker.id] = worker; return worker; &#125; æˆ‘ä»¬çœ‹åˆ°ä¸€å¼€å§‹å°±è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°cluster.setupMaster() æˆ‘ä»¬åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥æŸ¥åˆ°è¿™ä¸ªå‡½æ•°, å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°execé»˜è®¤ä¸ºprocess.argv[1],åœ¨ä¸»çº¿ç¨‹ä¸­æ‰“å°process.argv[1]å¯ä»¥çœ‹åˆ°process.argv[1]æŒ‡å‘äº†å…¥å£æ–‡ä»¶ï¼Œæ‰€ä»¥cluster.fork()çš„æ—¶å€™ï¼Œæ˜¯é‡æ–°è¿è¡Œäº†å…¥å£æ–‡ä»¶ã€‚è¿™ä¹Ÿå¯¹åº”äº†æ–‡æ¡£ä¸­çš„ä¸‹é¢è¿™å¥è¯ã€‚ Unlike the fork(2) POSIX system call, child_process.fork() does not clone the current process. åŒæ ·æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹æºç å¯ä»¥äº†è§£åˆ°ä¸‹é¢è¿™è¡Œä»£ç ï¼Œæ˜¯æ ¹æ®å½“å‰çš„ç¯å¢ƒå˜é‡å’Œclusteré…ç½®ï¼Œä¼ é€’ç»™child_process.fork()ï¼ŒworkerProcesså°±æ˜¯forkåçš„è¿”å›å€¼ï¼Œé€šè¿‡æŸ¥çœ‹æ–‡æ¡£ï¼Œæˆ‘ä»¬çŸ¥é“child_process.fork()è¿”å›äº†ä¸€ä¸ª&lt;ChildProcess&gt;,å…³äºè¿™é‡Œé¢çš„ç»†èŠ‚ï¼Œå¯ä»¥çœ‹child_process.fork()çš„ç»†èŠ‚ 1const workerProcess = createWorkerProcess(id, env); å†ä¸‹é¢ï¼ŒWorkerå¯¹è±¡å¯¹ChildProcessåŒ…è£¹äº†ä¸€å±‚ï¼Œæä¾›äº†ä¸€äº›API,å…·ä½“å¯ä»¥çœ‹æ–‡æ¡£ å…¶ä»–çš„å°±æ˜¯ä¸€ä¸ªä¿¡æ¯çš„ä¼ è¾“","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"å¸¸è§çš„10ä¸­æ’åºæ–¹æ¡ˆçš„JSå®ç°","date":"2017-03-15T08:58:40.000Z","path":"2017/03/15/sort-by-js/","text":"è¿™æ®µæ—¶é—´é‡æ–°å›é¡¾äº†ä¸€ä¸‹ï¼Œç®—æ³•çš„åŸºç¡€éƒ¨åˆ†ï¼Œæ’åºï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£æ’åºï¼Œæˆ‘ä½¿ç”¨JSå®ç°äº†ä¸‹é¢10ç§ç®—æ³•ã€‚ å®ç°çš„æ’åº å†’æ³¡æ’åº(bubble) æ’å…¥æ’åº(insert) å¿«é€Ÿæ’åº(quick) é€‰æ‹©æ’åº(selection) å½’å¹¶æ’åº(merge) å¸Œå°”æ’åº(shell) å †æ’åº(heap) åŸºæ•°æ’åº(radix) æ¡¶æ’åº(bucket) è®¡æ•°æ’åº(counting) å…·ä½“çš„ç»†èŠ‚å¯ä»¥æµè§ˆsort.js ç°åœ¨æœªå¯¹å†…å­˜ä½¿ç”¨åšå¾ˆå¥½çš„ä¼˜åŒ–ï¼Œå¦‚æœå¯¹å†…å­˜è¦æ±‚æ¯”è¾ƒé«˜çš„è¯ï¼Œè¿˜æ˜¯æ¨èä½¿ç”¨cè¯­è¨€æ¥å®ç°","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://wangyuekai.com/tags/ç®—æ³•/"}]},{"title":"IF, ä¸‰å…ƒè¡¨è¾¾å¼, || çš„åˆ¤æ–­","date":"2017-02-27T14:43:43.000Z","path":"2017/02/27/if/","text":"\\undefinednullâ€˜â€™0â€˜0â€™-0+0NaN-1IFfalsefalsefalsefalsetruefalsefalsefalsetrueä¸‰å…ƒfalsefalsefalsefalsetruefalsefalsefalsetrue||falsefalsefalsefalsetruefalsefalsefalsetrue ä»ç°åœ¨çš„æƒ…å†µçœ‹èµ·æ¥ï¼Œä¸‰å…ƒè¡¨è¾¾å¼ï¼ŒIF å’Œ || è¡¨ç°çš„ç»“æœåŸºæœ¬ä¸€è‡´","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"Koaä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰å®ç°æ¢ç´¢","date":"2017-02-23T03:54:15.000Z","path":"2017/02/23/koa-middleware/","text":"è¯´èµ·Nodeï¼Œæœ€å¸¸ç”¨çš„ä¼°è®¡å°±æ˜¯expresså’Œkoaï¼Œä¸¤è€…éƒ½ç”¨åˆ°äº†ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰è¿™ä¸€æ¦‚å¿µï¼Œä¸»è¦ç”¨äºå¯¹è¯·æ±‚çš„ç»Ÿä¸€å¤„ç†ã€‚ koaçš„è¯·æ±‚å¤„ç†æ˜¯å…¸å‹çš„æ´‹è‘±æ¨¡å‹,ä¸‹é¢æ˜¯å®˜æ–¹çš„é…å›¾ï¼Œè€Œè¿™ä¸€æ¨¡å‹çš„ç»„æˆéƒ¨åˆ†å°±æ˜¯middleware æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹koaçš„æºç ï¼Œäº†è§£ä¸­é—´ä»¶çš„å®ç°æ–¹å¼ã€‚ é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°äº†koaçš„ä»“åº“Koa,å¥½å§,æˆ‘çŸ¥é“ä½ ä»¬éƒ½ä¼šè¿™ä¸€æ­¥ã€‚ åœ¨package.jsonä¸­æ‰¾åˆ°æ¨¡å—çš„å…¥å£æ–‡ä»¶application.js,ç¨å¾®æµè§ˆä¸€ä¸‹(ä¸å¾—ä¸è¯´ï¼Œtjå¤§ç¥çš„ä»£ç å†™çš„çœŸçš„æ¼‚äº®)å°±å¯ä»¥æ‰¾åˆ°Koaå¤„ç†è¯·æ±‚çš„ä»£ç  12345678910111213141516171819app.callback = function()&#123; if (this.experimental) &#123; console.error(&apos;Experimental ES7 Async Function support is deprecated. Please look into Koa v2 as the middleware signature has changed.&apos;) &#125; var fn = this.experimental ? compose_es7(this.middleware) : co.wrap(compose(this.middleware)); var self = this; if (!this.listeners(&apos;error&apos;).length) this.on(&apos;error&apos;, this.onerror); return function handleRequest(req, res)&#123; res.statusCode = 404; var ctx = self.createContext(req, res); onFinished(res, ctx.onerror); fn.call(ctx).then(function handleResponse() &#123; respond.call(ctx); &#125;).catch(ctx.onerror); &#125;&#125;; çœ‹å®Œè¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬äº†è§£åˆ°çœŸæ­£å¤„ç†è¯·æ±‚å†…å®¹çš„å‡½æ•°æ˜¯fn,è€Œè¿™ä¸ªå‡½æ•°çš„å®šä¹‰å°±æ˜¯ä¸‹é¢è¿™æ®µå‡½æ•° 123var fn = this.experimental ? compose_es7(this.middleware) : co.wrap(compose(this.middleware)); å¥½å§ï¼Œå‡†ç¡®æ¥è¯´å°±æ˜¯ 1co.wrap(compose(this.middleware)); å…¶å®æˆ‘ä»¬åªéœ€è¦çŸ¥é“è¿™æ®µå‡½æ•°åšäº†ä»€ä¹ˆï¼Œå°±çŸ¥é“ä¸­é—´ä»¶æ˜¯å¦‚ä½•è¿è¡Œçš„äº†ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨appliction.jsæ–‡ä»¶æ‰¾åˆ°äº†app.useå‡½æ•° 123456app.use = function(fn)&#123; ... this.middleware.push(fn); return this;&#125;; ä»è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“this.middlewareå°±æ˜¯ä¸€ä¸ªgeneratorå‡½æ•°çš„æ•°ç»„ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦çŸ¥é“composeå‡½æ•°åšäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬æ‰¾åˆ°composeå‡½æ•°ï¼Œå…¶å®composeå¾ˆçŸ­ 123456789101112131415function compose(middleware)&#123; return function *(next)&#123; if (!next) next = noop(); var i = middleware.length; while (i--) &#123; next = middleware[i].call(this, next); &#125; return yield *next; &#125;&#125;function *noop()&#123;&#125; è¿™é‡Œcomposeå‡½æ•°è¿”å›äº†ä¸€ä¸ªGeneratorï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯ä»¥å˜æˆä¸‹é¢çš„æ ·å­ï¼ˆå½“ç„¶è¿˜æœ‰middlewareçš„å˜é‡å†é—­åŒ…ä¸­ï¼‰ 1234567891011co.wrap(function *(next)&#123; if (!next) next = noop(); var i = middleware.length; while (i--) &#123; next = middleware[i].call(this, next); &#125; return yield *next; &#125;) æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹co.wrap 1234567co.wrap = function (fn) &#123; createPromise.__generatorFunction__ = fn; return createPromise; function createPromise() &#123; return co.call(this, fn.apply(this, arguments)); &#125;&#125;; æ‰€ä»¥ä»£ç å¯ä»¥å˜ä¸ºä¸‹é¢çš„æ ·å­ 1234567891011121314function createPromise() &#123; var fn = function *(next)&#123; if (!next) next = noop(); var i = middleware.length; while (i--) &#123; next = middleware[i].call(this, next); &#125; return yield *next; &#125; return co.call(this, fn.apply(this, arguments)); &#125; æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹è¿™æ®µä»£ç  1234567if (!next) next = noop(); var i = middleware.length; while (i--) &#123; next = middleware[i].call(this, next);&#125; è¿™æ®µä»£ç éå†äº†æˆ‘ä»¬çš„ä¸­é—´ä»¶æ•°ç»„ï¼Œæœ€ç»ˆç”Ÿæˆäº†ä¸€ä¸ªç±»ä¼¼ä¸‹é¢çš„ä»£ç  123456789101112131415161718192021222324next = (function*()&#123; // middleware1 ... yield (function*()&#123; // middleware2 ... yield (function*()&#123; // middleware3 ... yield (function *()&#123; // noop // NO next yield ! &#125;)() // ...middleware3 &#125;) // ...middleware2 &#125;) // ...middleware1&#125;)() å…¶å®çœ‹åˆ°è¿™é‡Œå°±å·²ç»å¯ä»¥çœ‹åˆ°æ´‹è‘±æ¨¡å‹çš„æ ·å­äº†ã€‚ è€Œæœ€åå°±æ˜¯è¿™ä¸ªnextçš„è¿è¡Œï¼Œå…¶å®è¿™ä¸ªnextå°±æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ç”Ÿæˆçš„è¿­ä»£å™¨ï¼ˆiteratorï¼‰å¯¹è±¡ï¼Œç„¶åç”±coæ¥è¿è¡Œï¼Œç±»ä¼¼ä¸‹é¢ 12345co(function*()&#123; ... yield *next&#125;) coå¯ä»¥å¯¹generatorçš„è¿›è¡Œè‡ªæ‰§è¡Œã€‚åˆ°è¿™åŸºæœ¬å°±å®Œæˆå¯ä¸­é—´ä»¶çš„å®ç°ã€‚ çœ¼å°–çš„è¯»è€…å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ€åç”¨åˆ°äº†yield *è€Œéyield,å¯ä»¥æœ‰å…³äºcoçš„æ‰§è¡Œï¼Œå…¶å®å°±æ˜¯ä¸ºäº†å‡å°‘coçš„ä¸€æ¬¡è¿è¡Œï¼Œå…¶å®æ¯æ¬¡éƒ½åº”è¯¥ç”¨yield next,å¯èƒ½æ˜¯tjå¤§ç¥æ€•å¤§å®¶å¿˜è®°åŠ äº†ï¼Œå°±ç´¢æ€§åœ¨demoé‡Œé¢å°±å»ºè®®å¤§å®¶ç›´æ¥yield nextå°±å¥½äº†ã€‚å…·ä½“çš„å¯ä»¥çœ‹æˆ‘å¯¹äºcoæºç å®ç°çš„åˆ†æï¼Œæˆ‘è¿™é‡Œå°±æä¸€ä¸‹`yield å¯ä»¥è‡ªåŠ¨æ‰§è¡Œåé¢çš„è¡¨è¾¾å¼çš„è¿­ä»£å™¨å±æ€§ï¼Œè€Œyieldåªä¼šç›´æ¥è¿”å›åé¢çš„è¡¨è¾¾å¼ï¼Œæ‰€ä»¥ä¸€ä¸ªyield *å¯ä»¥ä½¿coç›´æ¥æ‹¿åˆ°åé¢è¿­ä»£å™¨ä¸­çš„æ¯ä¸€æ­¥ï¼Œè€Œyieldåªå¯ä»¥æ‹¿åˆ°è¿­ä»£å™¨ï¼Œç„¶åé€’å½’è°ƒç”¨co`æ¥æ‰§è¡Œè¿­ä»£å™¨ã€‚ æœ€åæ¬¢è¿å¤§å®¶åæ§½ï¼Œè°¢è°¢ã€‚","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"},{"name":"Koa","slug":"Koa","permalink":"http://wangyuekai.com/tags/Koa/"}]},{"title":"Bootstrapç›’æ¨¡å‹","date":"2017-02-08T13:43:26.000Z","path":"2017/02/08/bootstrap-box-sizing/","text":"å…³äºç›’æ¨¡å‹æœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œå¯ä»¥é€šè¿‡box-sizingæ¥æ§åˆ¶ï¼Œå…³äºç›’æ¨¡å‹å…¶å®ä¸¤ç§æ–¹æ¡ˆéƒ½æ˜¯è¡¨ç¤ºæœ‰margin,border,â€™paddingâ€™,â€™conentâ€™ç»„æˆï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºä¸€ä¸ªDomçš„width1åˆ°åº•æ˜¯æŒ‡é‚£éƒ¨åˆ†ã€‚ 1box-sizing: content-box; è¿™æ—¶ width = content 1box-sizing: border-box; è¿™æ—¶ width = border + padding + content ä½†æ˜¯è¿™ä¸¤ä¸ªå“ªä¸€ä¸ªæ‰æ˜¯w3cæ ‡å‡†ç›’æ¨¡å‹å‘¢ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯ç¬¬äºŒä¸ªï¼Œä¹Ÿæ˜¯å°±border-box,å› ä¸ºå¥½åƒä¸€ç›´æ˜¯è¿™ä¹ˆç”¨çš„å•Šã€‚èµ·ç çœ‹åˆ°bootstrapç¡®å®ç”¨äº†è¿™ä¸ªå•Šã€‚ ä½†æŸ¥çœ‹äº†MDNçš„æ–‡æ¡£æ‰çŸ¥é“ç¬¬ä¸€ç§æ‰æ˜¯w3cæ ‡å‡†ç›’æ¨¡å‹ é‚£ä¹ˆä¸ºä»€ä¹ˆbootstrapé€‰æ‹©äº†border-box å¯¹äºè¿™ä¸ªTwitteråœ¨å‘å¸ƒbootstrap3çš„æ—¶å€™çš„ä¸€ç¯‡è¯´æ˜æåˆ°äº†: Better box model by default. Everything in Bootstrap gets box-sizing: border-box, making for easier sizing options and an enhanced grid system. å¯ä»¥çœ‹åˆ°ä¹‹æ‰€ä»¥é€‰æ‹©border-boxæ˜¯ä¸ºäº†æ›´åŠ æ–¹ä¾¿æ§åˆ¶Domçš„å¤§å°ï¼Œä¹Ÿæ›´åŠ å®¹æ˜“å®ç°å’Œä½¿ç”¨æ …æ ¼ç³»ç»Ÿ åœ¨æ …æ ¼ç³»ç»Ÿä¸­ï¼Œbootstrap3æ˜¯é€šè¿‡ç™¾åˆ†æ¯”æ¥æ§åˆ¶Domçš„å¤§å°ï¼Œä½¿ç”¨border-boxåªéœ€è¦æ§åˆ¶å®½åº¦å³å¯ï¼Œå¦è€…éœ€è¦æ§åˆ¶å®½åº¦å’Œpaddingï¼Œå®ç°ä¸Šè¿‡äºéº»çƒ¦ï¼Œè€Œä¸”paddingå®¹æ˜“è¢«ä¿®æ”¹ï¼Œä¸€æ—¦è¢«ä¿®æ”¹å°±ä¼šå½±å“å…¶ä»–çš„å¸ƒå±€ã€‚æ‰€ä»¥bootstrapæ‰é€‰æ‹©äº†border-boxä½œä¸ºæ¡†æ¶çš„ç»Ÿä¸€çš„ç›’æ¨¡å‹ã€‚","tags":[{"name":"css","slug":"css","permalink":"http://wangyuekai.com/tags/css/"}]},{"title":"Apache Proxyå’ŒRedirect(Proxyä¸Redirectå†²çªé—®é¢˜)","date":"2017-02-08T13:40:27.000Z","path":"2017/02/08/apache-proxy-redirect/","text":"æœ€è¿‘åœ¨å›½å¤–çš„ä¸€å°æœºå™¨ä¸Šéƒ¨ç½²äº†å…¬å¸çš„ä»£ç ï¼Œä½†æ˜¯å› ä¸ºæœ‰å¾ˆå¤šçš„å›¾ç‰‡èµ„æºï¼Œæ‰€ä»¥å›½å†…è®¿é—®å¾ˆæ…¢ï¼Œè€Œå®¢æˆ·è¿™æ®µæ—¶é—´åˆšå¥½åœ¨å›½å†…ï¼Œæ‰€ä»¥æƒ³è¦æŠŠæ‰€æœ‰çš„å›¾ç‰‡èµ„æºçš„é“¾æ¥é‡å®šå‘åˆ°å›½å†…çš„ä¸€å°æœºå™¨ä¸Šã€‚ æœ¬ä»¥ä¸ºåŠ ä¸Šä¸€æ®µRedirectæˆ–è€…RedirectMatchä»€ä¹ˆçš„å°±å¯ä»¥äº†ï¼Œä½†æ˜¯åŠ ä¸Šäº†å‘ç°å¹¶æ²¡æœ‰èµ·ä½œç”¨ã€‚çœ‹äº†ä¸€ä¸‹Apacheçš„é…ç½®ï¼Œå‘ç°é…ç½®ä¸­è¿˜ç”¨åˆ°äº†proxyæ¥æŒ‡å‘nodeåº”ç”¨ã€‚ googleäº†ä¸€ä¸‹ï¼ŒçŒœæµ‹proxyä¼šä¼˜å…ˆäºRedirect/RedirectMatch,æ‰€ä»¥å¯¹äºproxyå·²ç»å‘½ä¸­çš„èµ„æºï¼ŒRedirectå’ŒRedirectMatchå°±ä¸ä¼šåœ¨èµ·ä½œç”¨ï¼Œéœ€è¦åœ¨proxyæ’é™¤è¿™äº›æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç±»ä¼¼ProxyPassMatch /static/ !æ¥ä½¿Proxyå¯¹äº/static/å¤±æ•ˆã€‚å†å¯¹/static/ä½¿ç”¨Redirect 301 /static/ http://www.other-domain.com/staticã€‚ æœ€åè´´ä¸Šå®Œæ•´ä¸€ç‚¹çš„ä¾‹å­ 123456789101112131415161718192021222324252627&lt;VirtualHost *:80&gt; ServerName www.example.com DocumentRoot /var/www/html/www.example.com ProxyRequests Off RewriteEngine On RedirectMatch /static/(.*).(png|svg) http://www.other-domain.com/static/$1.$2 &lt;Directory /&gt; Options FollowSymLinks AllowOverride None &lt;/Directory&gt; &lt;Proxy *&gt; Order deny,allow Allow from all &lt;/Proxy&gt; ProxyPassMatch /static/(.*).(png|svg) ! ProxyPass / http://127.0.0.1:7300/ ProxyPassReverse / http://127.0.0.1:7300/ ProxyPreserveHost On ...&lt;/VirtualHost&gt; é™¤äº†Redirectå’ŒRedirectMatchï¼Œä¹Ÿå¯ä»¥å…¶ä»–çš„é‡å®šå‘é…ç½®ï¼Œä¾‹å¦‚RewriteRuleç­‰","tags":[{"name":"Apache","slug":"Apache","permalink":"http://wangyuekai.com/tags/Apache/"},{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://wangyuekai.com/tags/æœåŠ¡å™¨/"}]},{"title":"å­¦ä¹ JavaScriptä¸­çš„å¼‚æ­¥Generator","date":"2017-02-02T10:21:08.000Z","path":"2017/02/02/asyncing-feeling-about-javascript-generators/","text":"åŸæ–‡ï¼šhttps://www.bignerdranch.com/blog/asyncing-feeling-about-javascript-generators/ ä½ æƒ³çœ‹ç²¾ç®€ç‰ˆæœ¬ä¹ˆ è¿™é‡Œæ˜¯æ‰€æœ‰ä¸‰ä¸ªä¾‹å­çš„è¦ç‚¹ å¼‚æ­¥çš„generatorså’Œå¼‚æ­¥iterationå·²ç»åˆ°æ¥! è¿™æ˜¯é”™è¯¯çš„, å®ƒä»¬ç°åœ¨è¿˜åœ¨é˜¶æ®µ 3ï¼Œè¿™è¡¨ç¤ºä»–ä»¬å¾ˆæœ‰å¯èƒ½åœ¨JavaScriptæœªæ¥çš„ä¸€ä¸ªç‰ˆæœ¬ä¸­å‘å¸ƒã€‚ åœ¨ä»–ä»¬å‘å¸ƒä¹‹å‰ï¼Œä½ å¯ä»¥é€šè¿‡Babelæ¥åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨è¿˜åœ¨é˜¶æ®µ3çš„å»ºè®®å†…å®¹ã€‚ ç½‘ç«™åŸºæœ¬ä¸Šè¿˜æ˜¯ä¸€äº›åˆ†æ•£è¿è¡Œçš„åº”ç”¨ï¼Œå› ä¸ºä»»ä½•åœ¨è¯­è¨€ä¸Šçš„ä¿®æ”¹éƒ½ä¼šé€ æˆæ°¸ä¹…çš„å½±å“ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æœªæ¥çš„ç‰ˆæœ¬éƒ½éœ€è¦å‘åå…¼å®¹ã€‚å› æ­¤ï¼Œè¢«åŠ å…¥åˆ°ECMAScriptæ ‡å‡†çš„ç‰¹æ€§ï¼Œå®ƒå¿…é¡»æ˜¯ååˆ†çš„å¯é ï¼Œè€Œä¸”å®ƒçš„è¯­æ³•éœ€è¦å¾ˆä¼˜é›…ã€‚ è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¸Œæœ›å¼‚æ­¥generatorå’Œè¿­ä»£å™¨å¯ä»¥æ˜¾è‘—åœ°å½±å“æˆ‘ä»¬å¦‚ä½•æ„å»ºä»Šåçš„ä»£ç ï¼ŒåŒæ—¶ä¹Ÿè§£å†³ç°åœ¨çš„é—®é¢˜ã€‚è®©æˆ‘ä»¬å¼€å§‹äº†è§£å¼‚æ­¥generatoræ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå®ƒåœ¨æˆ‘ä»¬çš„æ­£å¼å¼€å‘ä¸­åˆä¼šé‡åˆ°ä»€ä¹ˆæ ·çš„é—®é¢˜ã€‚ æ€»ç»“: å¼‚æ­¥çš„Generatorsæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ç®€è€Œè¨€ä¹‹ï¼Œå¼‚æ­¥çš„generatorså’Œæ™®é€šçš„generatorå‡½æ•°å¾ˆåƒï¼Œä½†æ˜¯å®ƒå¯ä»¥yield Promisesã€‚å¦‚æœä½ æƒ³å¾ˆäº†è§£ES2015çš„generatorå‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆå»çœ‹ä¸€ä¸‹Chris Aquinoçš„åšå®¢ï¼Œå†å»çœ‹ä¸€ä¸‹Jafar Husainçš„ä¸€ç¯‡å¼‚æ­¥ç¼–ç¨‹çš„å¾ˆæ£’çš„æ¼”è®² æ€»çš„æ¥è¯´ï¼Œæ™®é€šçš„generatorå‡½æ•°åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨å’Œè§‚å¯Ÿè€… æ¨¡å¼çš„é›†åˆã€‚generatoræ˜¯ä¸€ä¸ªå¯ä»¥ä¸­æ­¢çš„å‡½æ•°ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨.next()æ¥ä¸€æ­¥æ­¥æ‰§è¡Œã€‚å¯ä»¥åŒé€šè¿‡.next()æ¥å¤šæ¬¡ä»generatorè¾“å‡ºå†…å®¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡.next(valueToPush)æ¥å¤šæ¬¡ä¼ å…¥å‚æ•°ã€‚è¿™ç§åŒå‘çš„æ¥å£å¯ä»¥ä½¿ä½ é€šè¿‡ä¸€ç§è¯­æ³•åŒæ—¶å®Œæˆè¿­ä»£å™¨å’Œè§‚å¯Ÿè€…çš„åŠŸèƒ½! å½“ç„¶generatorsä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹:å®ƒåœ¨è°ƒç”¨.next()çš„æ—¶å€™å¿…é¡»ç«‹å³ï¼ˆåŒæ­¥ï¼‰è¿”å›æ•°æ®ã€‚æ¢å¥è¯æ¥è¯´ï¼Œå°±æ˜¯ä»£ç åœ¨è°ƒç”¨.next()çš„æ—¶å€™å°±éœ€è¦å¾—åˆ°æ•°æ®ã€‚åœ¨generatoréœ€è¦æ—¶èƒ½å¤Ÿç”Ÿæˆæ–°æ•°æ®çš„æƒ…å†µä¸‹æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•å¤„ç†è¿­ä»£ä¸€ä¸ªå¼‚æ­¥çš„ï¼ˆæˆ–è€…ä¸´æ—¶çš„ï¼‰æ•°æ®æ¥æºï¼Œå®ƒä»¬éœ€è¦è‡ªå·±æ§åˆ¶åœ¨ä¸‹ä¸€æ¬¡æ•°æ®å‡†å¤‡å¥½çš„æ—¶å€™æ‰§è¡Œä¸‹ä¸€æ¬¡ã€‚ WebSocketæ¶ˆæ¯æœºåˆ¶å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼‚æ­¥è·å–æ•°æ®çš„ä¾‹å­ã€‚å¦‚æœæˆ‘ä»¬å·²ç»æ¥æ”¶åˆ°äº†æ‰€æœ‰çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å½“ç„¶å¯ä»¥åŒæ­¥åœ°éå†å®ƒä»¬ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯èƒ½ä¼šé‡åˆ°æˆ‘ä»¬å¹¶ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ä¼šæ¥æ”¶åˆ°æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœºåˆ¶å»ç­‰å¾…æ•°æ®æ¥æ”¶å®Œæˆåå»éå†ã€‚å¼‚æ­¥generatorså’Œå¼‚æ­¥è¿­ä»£å™¨å¯ä»¥è®©æˆ‘ä»¬åšåˆ°è¿™ä¸ªã€‚ ç®€å•çš„æ¥è¯´å°±æ˜¯ï¼šgeneratorå‡½æ•°é€‚ç”¨äºæ•°æ®å¯ä»¥è¢«ä½¿ç”¨è€…æ§åˆ¶çš„æƒ…å†µï¼Œå¼‚æ­¥generatorsé€‚ç”¨äºå…è®¸æ•°æ®æºæœ¬èº«æ§åˆ¶çš„æƒ…å†µã€‚ ä¸€ä¸ªç®€å•çš„ä¾‹å­: ç”Ÿæˆå’Œä½¿ç”¨AsyncGeneratorè®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥ç»ƒä¹ æˆ‘ä»¬çš„å¼‚æ­¥æ–¹æ¡ˆã€‚æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªå¼‚æ­¥çš„generatorå‡½æ•°ï¼Œå®ƒå¯ä»¥é‡å¤çš„ç­‰å¾…ä¸€ä¸ªéšæœºçš„æ¯«ç§’æ•°åç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°å­—ã€‚åœ¨å‡ ç§’é’Ÿä¸­æ—¶é—´é‡Œï¼Œå®ƒå¯èƒ½ä¼šä»0å¼€å§‹ç”Ÿæˆ5ä¸ªå·¦å³çš„æ•°å­—ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆé€šè¿‡åˆ›å»ºä¸€ä¸ªPromiseæ¥åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼š 123456// åˆ›å»ºä¸€ä¸ªPromiseï¼Œå¹¶åœ¨msåresolvesvar timer = function(ms) &#123; return new Promise(resolve =&gt; &#123; setTimeout(resolve, ms); &#125;);&#125;; è¿è¡Œtimer(5000)ä¼šè¿”å›ä¸€ä¸ªPromiseï¼Œå¹¶ä¸”ä¼šåœ¨5ç§’åresolveã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªå¼‚æ­¥generatorï¼š 123456789// Repeatedly generate a number starting// from 0 after a random amount of timevar source = async function\\*() &#123; var i = 0; while (true) &#123; await timer(Math.random() \\* 1000); yield i++; &#125;&#125;; å¦‚æ­¤å¤æ‚çš„åŠŸèƒ½å´å¯ä»¥å†™çš„å¦‚æ­¤ä¼˜é›…ï¼æˆ‘ä»¬çš„å¼‚æ­¥generatorå‡½æ•°ç­‰å¾…ä¸€ä¸ªéšæœºçš„æ—¶é—´åyieldå¹¶å‡å°içš„å€¼ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰å¼‚æ­¥generatorï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢ä¸€æ ·ä½¿ç”¨æ™®é€šçš„generatorå‡½æ•°ï¼Œé€šè¿‡yieldPromisesæ¥å®ç°: 1234567var source = function\\*() &#123; var i = 0; while (true) &#123; yield timer(Math.random() \\* 1000) .then(() =&gt; i++); &#125;&#125;; å½“ç„¶ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µå’Œå¼•ç”¨éœ€è¦æˆ‘ä»¬å¤„ç†ï¼Œæ‰€ä»¥æœ€å¥½æœ‰ä¸€ä¸ªä¸“é—¨çš„å‡½æ•°ç±»å‹ï¼ç°åœ¨æ˜¯æ—¶å€™ç¼–å†™ä½¿ç”¨ä»£ç äº†;å› ä¸ºæˆ‘ä»¬éœ€è¦awaitæ“ä½œç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼šåˆ›å»ºä¸€ä¸ªå¼‚æ­¥çš„run()å‡½æ•°ã€‚ 1234567891011121314// æŠŠæ‰€æœ‰éƒ½é›†åˆåˆ°ä¸€èµ·var run = async function() &#123; var stream = source(); for await (let n of stream) &#123; console.log(n); &#125;&#125;;run();// =&gt; 0// =&gt; 1// =&gt; 2// =&gt; 3// ... è¿™æ˜¯å¤šä¹ˆç¥å¥‡ï¼Œåªæœ‰20è¡Œä¸åˆ°çš„ä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¿è¡Œäº†å¼‚æ­¥generatorå‡½æ•°sourceï¼Œå®ƒè¿”å›äº†ä¸€ä¸ªç‰¹æ®Šçš„AsyncGeneratorå¯¹è±¡ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè¯­æ³•ä¸Šå«â€œå¼‚æ­¥è¿­ä»£â€çš„for await...ofå¾ªç¯éå†sourceç”Ÿæˆçš„å¯¹è±¡ã€‚ ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥å†æ”¹è¿›ä¸€ä¸‹: å‡è®¾æˆ‘ä»¬æ˜¯æƒ³è¦è¾“å‡ºsourceç”Ÿæˆçš„æ•°å­—ã€‚æˆ‘ä»¬å¯ä»¥åœ¨for await...ofå¾ªç¯é‡Œé¢ç›´æ¥è¾“å‡ºå®ƒä»¬ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€å¥½åœ¨å¾ªç¯çš„å¤–é¢â€œè½¬æ¢â€stream çš„å€¼ï¼Œåƒæ˜¯ä½¿ç”¨.map()ä¸€æ ·æ¥è½¬æ¢æ•°ç»„é‡Œçš„å€¼ã€‚å®ƒæ˜¯å¦‚æ­¤çš„ç®€å•ï¼š 1234567// Return a new async iterator that applies a// transform to the values from another async generatorvar map = async function\\*(stream, transform) &#123; for await (let n of stream) &#123; yield transform(n); &#125;&#125;; æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦å†å¾€run()å‡½æ•°ä¸­åŠ ä¸€è¡Œä»£ç å°±å¥½äº†ï¼š 123456789 // Tie everything together var run = async function() &#123; var stream = source();+ // Square values generated by source() as they arrive+ stream = map(stream, n =&gt; n \\* n); for await (let n of stream) &#123; console.log(n); &#125; &#125;; å½“æˆ‘ä»¬è¿è¡Œ run()å°±ä¼šè¾“å‡ºï¼š 12345// =&gt; 0// =&gt; 1// =&gt; 4// =&gt; 9// ... å¤šä¹ˆæ„Ÿäººå•Šï¼ä½†æ˜¯åªæ˜¯ç”¨äºè®¡ç®—æ•°å­—æœ‰ä¸€ç‚¹å¤§æå°ç”¨äº†ã€‚ ä¸­çº§ä¾‹å­: åœ¨WebSocketsä¸­ä½¿ç”¨AsyncIteratorï¼ˆå¼‚æ­¥è¿­ä»£å™¨ï¼‰æˆ‘ä»¬ä¸€èˆ¬æ˜¯é€šè¿‡ç»‘å®šäº‹ä»¶æ¥ç›‘å¬WebSocketçš„æ•°æ®ï¼š 1234var ws = new WebSocket(&apos;ws://localhost:3000/&apos;);ws.addEventListener(&apos;message&apos;, event =&gt; &#123; console.log(event.data);&#125;); ä½†æ˜¯å¦‚æœå¯ä»¥æŠŠWebSocketçš„ä¿¡æ¯å½“åšstreamï¼Œè¿™æ ·å°±å¯ä»¥ç”¨æˆ‘ä»¬ä¸Šé¢çš„åŠæ³•â€œiterateâ€è¿™äº›ä¿¡æ¯ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒWebSocketsè¿˜æ²¡æœ‰å¼‚æ­¥è¿­ä»£å™¨çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬åªéœ€è¦å†™çŸ­çŸ­çš„å‡ è¡Œå°±å¯ä»¥è‡ªå·±æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚æˆ‘ä»¬çš„run()å‡½æ•°å¤§æ¦‚çš„æ ·å­å¦‚ä¸‹ï¼š 1234567// Tie everything togethervar run = async () =&gt; &#123; var ws = new WebSocket(&apos;ws://localhost:3000/&apos;); for await (let message of ws) &#123; console.log(message); &#125;&#125;; Now for that polyfill.ä½ å¯èƒ½ä¼šå›å¿†èµ·Chris Aquinoâ€™s blog seriesä¸­å†™åˆ°çš„å†…å®¹ï¼Œä¸€ä¸ªå¯¹è±¡è¦ä½¿ç”¨for...ofå¾ªç¯ï¼Œå¿…é¡»è¦æœ‰Symbol.iteratorå±æ€§ã€‚åŒæ ·çš„ï¼Œä¸€ä¸ªå¯¹è±¡è¦æƒ³ä½¿ç”¨for await...ofå¾ªç¯ï¼Œå®ƒå¿…é¡»è¦æœ‰Symbol.asyncIteratorå±æ€§ã€‚ä¸‹é¢å°±æ˜¯å…·ä½“çš„å®ç°ï¼š 123456// Add an async iterator to all WebSocketsWebSocket.prototype[Symbol.asyncIterator] = async function\\*() &#123; while(this.readyState !== 3) &#123; yield (await oncePromise(this, &apos;message&apos;)).data; &#125;&#125;; è¿™ä¸ªå¼‚æ­¥è¿­ä»£å™¨ä¼šç­‰å¾…æ¥å—ä¿¡æ¯ï¼Œç„¶åä¼šå¯¹WebSocketçš„MessageEventè¿”å›çš„æ•°æ®çš„dataå±æ€§è¿›è¡Œyieldã€‚oncePromise()å‡½æ•°æœ‰ä¸€ç‚¹é»‘ç§‘æŠ€ï¼šå®ƒè¿”å›äº†ä¸€ä¸ªPromiseï¼Œå½“äº‹ä»¶è§¦å‘æ—¶å®ƒä¼šè¢«resolvesï¼Œç„¶åç«‹å³ç§»é™¤äº‹ä»¶ç›‘å¬ã€‚ 12345678910// Generate a Promise that listens only once for an eventvar oncePromise = (emitter, event) =&gt; &#123; return new Promise(resolve =&gt; &#123; var handler = (...args) =&gt; &#123; emitter.removeEventListener(event, handler); resolve(...args); &#125;; emitter.addEventListener(event, handler); &#125;);&#125;; è¿™æ ·çœ‹ä¸Šå»æœ‰ä¸€ç‚¹ä½æ•ˆï¼Œä½†æ˜¯è¯æ˜äº†websocketçš„ä¿¡æ¯æ¥æ”¶ç¡®å®å¯ä»¥ç”¨æˆ‘ä»¬çš„å¼‚æ­¥è¿­ä»£å™¨å®ç°ã€‚å¦‚æœä½ åœ¨http://localhost:3000 æœ‰ä¸€ä¸ªè¿è¡Œçš„WebSocketæœåŠ¡ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡è°ƒç”¨run()æ¥ç›‘å¬ä¿¡æ¯æµï¼š 12345run();// =&gt; &quot;hello&quot;// =&gt; &quot;sandwich&quot;// =&gt; &quot;otters&quot;// ... é«˜çº§ä¾‹å­: é‡å†™ RxJSç°åœ¨æ˜¯æ—¶å€™é¢å¯¹æœ€åçš„æŒ‘æˆ˜äº†ã€‚ååº”å‹å‡½æ•°ç¼–ç¨‹ (FRP)åœ¨UIç¼–ç¨‹å’ŒJavaScriptä¸­è¢«å¤§é‡ä½¿ç”¨ï¼Œ RxJSæ˜¯è¿™ç§ç¼–ç¨‹æ–¹å¼ä¸­æœ€æµè¡Œçš„æ¡†æ¶ã€‚RxJSä¸­æ¨¡å‹äº‹ä»¶æ¥æºä¾‹å¦‚Observableâ€“å®ƒä»¬å¾ˆæƒ³ä¸€ä¸ªä¸€ä¸ªäº‹ä»¶æµæˆ–è€…lazy arrayï¼Œå®ƒä»¬å¯ä»¥è¢«ç±»ä¼¼æ•°ç»„è¯­æ³•ä¸­çš„map()å’Œfilter()å¤„ç†ã€‚ è‡ªä»FRPè¡¥å……äº†JavaScriptä¸­çš„éé˜»å¡å¼ç†å¿µï¼Œç±»RxJSçš„APIå¾ˆæœ‰å¯èƒ½ä¼šåŠ å…¥åˆ°JavaScriptæœªæ¥çš„ä¸€ä¸ªç‰ˆæœ¬ä¸­ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¼‚æ­¥generatorsç¼–å†™æˆ‘ä»¬è‡ªå·±çš„ç±»ä¼¼RxJSçš„åŠŸèƒ½ï¼Œè€Œè¿™ä»…ä»…åªéœ€è¦80è¡Œä»£ç ã€‚ä¸‹é¢å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„ç›®æ ‡ï¼š ç›‘å¬æ‰€æœ‰çš„ç‚¹å‡»äº‹ä»¶ è¿‡æ»¤ç‚¹å‡»äº‹ä»¶åªè·å–ç‚¹å‡»anchoræ ‡ç­¾çš„äº‹ä»¶ åªå…è®¸ä¸åŒçš„ç‚¹å‡»Only allow distinct clicks å°†ç‚¹å‡»äº‹ä»¶æ˜ å°„åˆ°ç‚¹å‡»è®¡æ•°å™¨å’Œç‚¹å‡»äº‹ä»¶ æ¯500msåªå¯ä»¥è§¦å‘ä¸€æ¬¡ç‚¹å‡» æ‰“å°ç‚¹å‡»çš„æ¬¡æ•°å’Œäº‹ä»¶ è¿™äº›é—®é¢˜éƒ½æ˜¯RxJSè§£å†³äº†çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¦å°è¯•é‡æ–°å®ç°ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬çš„å®ç°ï¼š 123456789101112131415161718// Tie everything togethervar run = async () =&gt; &#123; var i = 0; var clicks = streamify(&apos;click&apos;, document.querySelector(&apos;body&apos;)); clicks = filter(clicks, e =&gt; e.target.matches(&apos;a&apos;)); clicks = distinct(clicks, e =&gt; e.target); clicks = map(clicks, e =&gt; [i++, e]); clicks = throttle(clicks, 500); subscribe(clicks, ([ id, click ]) =&gt; &#123; console.log(id); console.log(click); click.preventDefault(); &#125;);&#125;;run(); ä¸ºäº†ä½¿ä¸Šé¢çš„å‡½æ•°æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬è¿˜éœ€è¦6ä¸ªå‡½æ•°ï¼šstreamify(), filter(), distinct(), map(), throttle() å’Œ subscribe()ã€‚ 123456// æŠŠæ‰€æœ‰çš„event emitteræ”¾å…¥ä¸€ä¸ªstreamvar streamify = async function\\*(event, element) &#123; while (true) &#123; yield await oncePromise(element, event); &#125;&#125;; streamify() åƒæ˜¯ä¸€ä¸ªWebSocketå¼‚æ­¥è¿­ä»£å™¨ï¼š oncePromise() ä½¿ç”¨ .addEventListener() å»ç›‘å¬äº‹ä»¶ä¸€æ¬¡, ç„¶åresolves Promise. é€šè¿‡while (true)å¾ªç¯ , æˆ‘ä»¬å¯ä»¥ä¸€ç›´ç›‘å¬äº‹ä»¶ã€‚ 12345678// Only pass along events that meet a conditionvar filter = async function\\*(stream, test) &#123; for await (var event of stream) &#123; if (test(event)) &#123; yield event; &#125; &#125;&#125;; filter() ä¼šåªå…è®¸é€šè¿‡testçš„äº‹ä»¶è¢« yield. map()å‡ ä¹æ˜¯ç›¸åŒçš„: 123456// Transform every event of the streamvar map = async function\\*(stream, transform) &#123; for await (var event of stream) &#123; yield transform(event); &#125;&#125;; map()å¯ä»¥ç®€å•åœ°åœ¨yieldä¹‹å‰å˜æ¢äº‹ä»¶ã€‚distinct()å±•ç¤ºäº†å¼‚æ­¥generatorçš„å…¶ä¸­ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼šå®ƒå¯ä»¥ä¿å­˜å±€éƒ¨å˜é‡! 1234567891011121314var identity = e =&gt; e;// åªå…è®¸ä¸æœ€åä¸€ä¸ªä¸ç›¸åŒçš„äº‹ä»¶é€šè¿‡var distinct = async function\\*(stream, extract = identity) &#123; var lastVal; var thisVal; for await (var event of stream) &#123; thisVal = extract(event); if (thisVal !== lastVal) &#123; lastVal = thisVal; yield event; &#125; &#125;&#125;; æœ€åï¼Œå¼ºå¤§çš„throttle()å‡½æ•°å’Œdistinct()å¾ˆåƒï¼šå®ƒè®°å½•æœ€åä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´ï¼Œä¸”åªå…è®¸è¶…è¿‡æœ€åä¸€æ¬¡yieldäº‹ä»¶ä¸€ä¸ªç¡®å®šçš„æ—¶é—´çš„äº‹ä»¶é€šè¿‡ã€‚ 123456789101112// åªå…è®¸è¶…è¿‡æœ€åä¸€æ¬¡äº‹ä»¶ç¡®å®šæ—¶é—´çš„äº‹ä»¶é€šè¿‡ã€‚var throttle = async function\\*(stream, delay) &#123; var lastTime; var thisTime; for await (var event of stream) &#123; thisTime = (new Date()).getTime(); if (!lastTime || thisTime - lastTime &gt; delay) &#123; lastTime = thisTime; yield event; &#125; &#125;&#125;; æˆ‘ä»¬åšäº†è¿™ä¹ˆå¤šï¼Œæœ€åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰“å°å‡ºæ¯æ¬¡çš„ç‚¹å‡»äº‹ä»¶å’Œå½“å‰çš„æ¬¡æ•°ã€‚subscribe()åšäº†ä¸€äº›é›¶ç¢çš„äº‹æƒ…ï¼šå®ƒåœ¨æ¯ä¸€æ¬¡äº‹ä»¶å¾ªç¯çš„æ—¶å€™è¿è¡Œï¼Œå¹¶æ‰§è¡Œcallbackï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦ä½¿ç”¨yieldã€‚ 123456// æ¯æ¬¡äº‹ä»¶åˆ°è¾¾éƒ½è°ƒç”¨ä¸€æ¬¡å›è°ƒå‡½æ•°var subscribe = async (stream, callback) =&gt; &#123; for await (var event of stream) &#123; callback(event); &#125;&#125;; åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å†™äº†ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ååº”å‹å‡½æ•°å¼ç®¡é“ï¼ ä½ å¯ä»¥åœ¨è¿™é‡Œè·å–åˆ°æ‰€æœ‰çš„ä¾‹å­çš„ä»£ç å’Œè¦ç‚¹ã€‚ æŒ‘æˆ˜å¼‚æ­¥generatorsæ˜¯å¦‚æ­¤çš„ä¼˜é›…ã€‚è€Œgeneratorå‡½æ•°å…è®¸æˆ‘ä»¬ä»è¿­ä»£å™¨ä¸­å›å»æ•°æ®ï¼Œå¼‚æ­¥generatorså¯ä»¥è®©æˆ‘ä»¬è¿­ä»£â€œæ¨é€â€è¿‡æ¥çš„æ•°æ®ã€‚è¿™æ˜¯å¤šä¹ˆå¥½çš„å¼‚æ­¥æ•°æ®ç»“æ„çš„æŠ½è±¡ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ã€‚ é¦–å…ˆï¼Œå¯¹ä¸€ä¸ªobjectså¢åŠ æ”¯æŒfor await...ofçš„åŠŸèƒ½æœ‰ä¸€äº›ç²—ç³™ï¼Œé™¤éä½ å¯ä»¥é¿å…ä½¿ç”¨yieldå’Œawaitã€‚å°¤å…¶æ˜¯ï¼Œä½¿ç”¨.addEventListenerï¼ˆï¼‰è½¬æ¢ä»»ä½•ä¸œè¥¿éƒ½å¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºä½ ä¸å¯ä»¥åœ¨ä¸€ä¸ªå›è°ƒä¸­ä½¿ç”¨yieldæ“ä½œ: 1234567var streamify = async function\\*(event, element) &#123; element.addEventListener(event, e =&gt; &#123; // è¿™é‡Œå°†æ— æ³•è¿è¡Œï¼Œå› ä¸ºyield // ä¸å¯ä»¥åœ¨ä¸€ä¸ªæ™®é€šå‡½æ•°ä¸­è¢«ä½¿ç”¨ yield e; &#125;);&#125;; åŒæ ·çš„ï¼Œä½ ä¹Ÿä¸å¯ä»¥åœ¨.forEach()å’Œå…¶ä»–å‡½æ•°å‹çš„æ–¹æ³•ä¸­ä½¿ç”¨yieldã€‚è¿™æ˜¯ä¸€ä¸ªå›ºæœ‰çš„é™åˆ¶å› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¿è¯åœ¨generatorå·²ç»å®Œæˆåä¸ä½¿ç”¨yieldã€‚ ä¸ºäº†ç»•è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªoncePromise()å‡½æ•°æ¥å¸®ç»„æˆ‘ä»¬ã€‚æ’‡å¼€ä¸€äº›æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯Promiseçš„å›è°ƒæ€»æ˜¯åœ¨å½“å‰çš„è°ƒç”¨å †æ ˆç»“æŸä¹‹åæ‰§è¡Œã€‚åœ¨æµè§ˆå™¨ç«¯ï¼Œç±»ä¼¼microtasksä¸€æ ·è¿è¡ŒPromiseçš„å›è°ƒæ˜¯ä¸ä¼šå‡ºç°é—®é¢˜çš„ï¼Œä½†æ˜¯ä¸€äº›Promiseçš„polyfillåœ¨ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯è¿è¡Œä¹‹å‰æ˜¯ä¸ä¼šè¿è¡Œcallbackã€‚å› æ­¤ï¼Œè°ƒç”¨.preventDefault()å‡½æ•°æœ‰æ—¶å€™ä¼šæ²¡æœ‰æœ‰æ•ˆæœï¼Œå› ä¸ºå¯èƒ½DOMæ—¶é—´å·²ç»å†’æ³¡åˆ°æµè§ˆå™¨äº†ã€‚ JavaScriptç°åœ¨å·²ç»æœ‰äº†å¤šä¸ªå¼‚æ­¥æµæ•°æ®ç±»å‹ï¼šStream, AsyncGeneratorå’Œæœ€åçš„Observableã€‚è™½ç„¶ä¸‰ä¸ªéƒ½æ˜¯å±äºâ€œæ¨é€â€æ•°æ®æºï¼Œä½†æ˜¯åœ¨å¤„ç†å›è°ƒå’Œæ§åˆ¶åº•å±‚èµ„æºä¸Šè¿˜æ˜¯æœ‰ä¸€äº›å¾®å¦™çš„è¯­ä¹‰ä¸Šçš„ä¸åŒã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºååº”å‡½æ•°å¼è¯­æ³•çš„ç»†èŠ‚ï¼Œå¯ä»¥æµè§ˆGeneral Theory of Reactivity. æ›´å¤šåœ¨ç¨‹åºè¯­è¨€çš„ç«èµ›ä¸­ï¼ŒJavaScriptä¸æ˜¯ä¸€ä¸ªæ‡’é¬¼ã€‚ES2015ä¸­çš„å˜é‡çš„è§£æ„èµ‹å€¼ï¼ŒES2016ä¸­çš„å¼‚æ­¥å‡½æ•°ï¼Œè€Œç°åœ¨çš„å¼‚æ­¥è¿­ä»£å™¨å¯ä»¥ä½¿JavaScriptä½¿ç”¨ä¼˜é›…çš„è§£å†³å¤æ‚UIå’ŒI/Oç¼–ç¨‹çš„é—®é¢˜è€Œä¸æ˜¯ä½¿ç”¨å……æ»¡ä¸å¯æ§çš„å¤šçº¿ç¨‹æ–¹æ¡ˆã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šçš„æ–°å†…å®¹å’Œæ–°ç‰¹æ€§ï¼æ‰€ä»¥è¯·å…³æ³¨åšå®¢å’ŒTC39 proposals repoæ¥è·å–æœ€æ–°çš„å¥½ä¸œè¥¿ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡åœ¨Babelä¸­å¼€å¯Stage 3 ææ¡ˆçš„æ–¹å¼åœ¨ä½ çš„ä»£ç ä¸­ä½¿ç”¨å¼‚æ­¥generatorå‡½æ•°ã€‚ ä½ æ˜¯å¦æœ‰å…´è¶£å­¦ä¹ ç½‘é¡µå¹³å°çš„ä¸‹ä¸€ä»£çš„JavaScript? æ¬¢è¿æ¥æˆ‘ä»¬çš„å‰ç«¯è®­ç»ƒè¥, æˆ–è€… æˆ‘ä»¬å¯ä»¥æä¾›ä¼ä¸šåŸ¹è®­!","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"Javascriptå¼‚æ­¥ç¼–ç¨‹","date":"2017-01-31T12:30:39.000Z","path":"2017/01/31/Javascript-async-programming/","text":"éšç€es6çš„å‘å¸ƒå’ŒBabelçš„å‡ºç°ï¼Œå¯¹äºå¼‚æ­¥ç¼–ç¨‹ï¼Œæˆ‘ä»¬æ…¢æ…¢å‘Šåˆ«äº†ä¹‹å‰å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œç°åœ¨çš„æˆ‘ä»¬æœ‰äº†æ›´å¤šçš„é€‰æ‹©ï¼Œä¾‹å¦‚ï¼šPromiseï¼Œ generatorï¼Œ async/awaitç­‰æ–¹æ¡ˆã€‚ä¸‹é¢æˆ‘ä»¬ä¸€ä¸€æ¥äº†è§£ä¸€ä¸‹ï¼š ###PromisePromiseåœ¨ES6å‘å¸ƒä¹‹å‰å°±å·²ç»æœ‰å¾ˆå¤šçš„åº“å’Œå·¥å…·å®ç°äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä¾‹å¦‚Jqueryï¼Œpç­‰ç­‰, Promiseåšåˆ°äº†å°†åŸæ¥çš„å›è°ƒåœ°ç‹±çš„æ–¹å¼ï¼Œæ”¹ä¸ºäº†é“¾å¼è¿”å›ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šæ”¹å–„äº†å¼‚æ­¥ç¼–ç¨‹çš„é—®é¢˜ã€‚ 123456789101112131415var p1 = new Promise(function (resolve, reject) &#123; setTimeout(function() &#123; console.log(&apos;resolve&apos;); resolve(&apos;done&apos;); &#125;, 1000);&#125;);p1.then(function(data)&#123; // success console.log(data)&#125;).catch(function(error) &#123; // å¤„ç† getJSON å’Œ å‰ä¸€ä¸ªå›è°ƒå‡½æ•°è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯ console.log(&apos;å‘ç”Ÿé”™è¯¯ï¼&apos;, error);&#125;); ###GeneratorGeneratoræ˜¯ES6ä¸­æ–°å¢çš„è¯­æ³•ï¼ŒGeneratorå¯ä»¥åšåˆ°åœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­åœæ­¢å’Œç»§ç»­è¿›è¡Œï¼Œä»è€Œä½¿å¼‚æ­¥å‡½æ•°å¯ä»¥ä»¥åŒæ­¥ç¼–ç¨‹çš„æ–¹å¼ç¼–å†™ï¼Œåœ¨å¼‚æ­¥çš„åœ°æ–¹åœæ­¢ï¼Œåœ¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œå®Œåç»§ç»­æ‰§è¡ŒGeneratorå‡½æ•°ã€‚ åœ¨è°ƒç”¨generatorå‡½æ•°æ—¶ï¼Œå¹¶ä¸ä¼šæ‰§è¡Œå‡½æ•°å†…å®¹ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆiteratorï¼‰å¯¹è±¡, åœ¨æ‰§è¡Œè¿­ä»£å™¨çš„next()å‡½æ•°(next()å‡½æ•°æ˜¯iteratorçš„å±æ€§)æ—¶å¯ä»¥é€æ­¥æ‰§è¡Œgeneratorå‡½æ•°å†…å®¹ã€‚ æ³¨ï¼šä¸€ä¸ªå¯¹è±¡è¦æƒ³å¯ä»¥ç”Ÿæˆè¿­ä»£å™¨ï¼Œè¯¥å¯¹è±¡éœ€è¦æœ‰â€œSymbol.iteratorâ€å±æ€§ 12345678910function* gen()&#123; var url = &apos;https://api.github.com/users/github&apos;; var result = yield fetch(url); console.log(result); yield 1;&#125;//åœ¨chromeæ§åˆ¶å°ä¸­è¾“å‡º&gt; gen.prototype[Symbol.iterator]//function [Symbol.iterator]() &#123; [native code] &#125; è®©æˆ‘ä»¬è¿è¡Œ gen() 12345678910111213var g = gen();var a = g.next();console.log(a);//&#123;value: Promise, done: false&#125;a = g.next();console.log(a);//&#123;value: 1, done: false&#125;a = g.next();console.log(a);//&#123;value: undefined, done: true&#125; å¯¹äºä¸Šé¢çš„ç»“æœï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å‚çœ‹babelå¯¹äºGeneratorçš„å®ç°ï¼Œä¸è¿‡è¿™å¹¶ä¸æ˜¯å®˜æ–¹çš„æ–¹æ¡ˆï¼Œåªæ˜¯å¯ä»¥ä½œä¸ºç†è§£Generatorçš„ä¸€ä¸ªå¸®åŠ© 12345678910111213141516171819202122232425function gen() &#123; var url, result; return regeneratorRuntime.wrap(function gen$(_context) &#123; while (1) &#123; switch (_context.prev = _context.next) &#123; case 0: url = &apos;https://api.github.com/users/github&apos;; _context.next = 3;//è®¾ç½®ä¸‹ä¸€ä¸ªèµ·å§‹ç‚¹ return fetch(url);//è¾“å‡ºyieldåé¢çš„è¡¨è¾¾å¼ case 3: result = _context.sent; console.log(result); _context.next = 7;//è®¾ç½®ä¸‹ä¸€ä¸ªèµ·å§‹ç‚¹ //è¾“å‡ºyieldåé¢çš„è¡¨è¾¾å¼ return 1; case 7: case &apos;end&apos;: return _context.stop(); &#125; &#125; &#125;, _marked[0], this);&#125; ç”±æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çŒœæµ‹è°ƒç”¨Generatorçš„æ—¶å€™ï¼Œè°ƒç”¨äº†gen.prototype[Symbol.iterator]ï¼Œè¯¥å‡½æ•°ç›¸å½“äºæ˜¯æŠŠæˆ‘ä»¬çš„ä»£ç æ ¹æ®æ ‡ç­¾yieldè¿›è¡Œåˆ†å‰²ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªâ€œåˆ—è¡¨â€ä¸­ï¼Œå¹¶è¿”å›äº†ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå…¶ä¸­å«æœ‰nextå±æ€§ï¼Œè™½éšç€nextçš„è°ƒç”¨ï¼Œä¸€æ­¥æ­¥åœ°æ‰§è¡Œâ€œåˆ—è¡¨â€ä¸­çš„æ¯ä¸€æ®µå‡½æ•°ã€‚ å½“æˆ‘ä»¬è¿è¡Œçš„æ—¶å€™ä¼šå‘ç°ä¸Šé¢çš„console.log(result);è¾“å‡ºäº†undefined,è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºGeneratoråªæ˜¯è´Ÿè´£ä»£ç çš„åœæ­¢å’Œæ‰§è¡Œï¼Œå®ƒå¹¶ä¸ä¼šç­‰å¾…åé¢çš„å¼‚æ­¥ç»“æŸï¼Œè€Œä¸”ä¸€æ­¥æ­¥çš„å†™nextå¤ªéº»çƒ¦äº†ï¼Œèƒ½ä¸èƒ½è®©Generatorè‡ªå·±æ‰§è¡Œåˆ°ç»“æŸå‘¢ï¼Ÿ å½“ç„¶å¯ä»¥ï¼ ä½†æ˜¯åªæœ‰Generatorå¹¶ä¸èƒ½åšåˆ°è¿™äº›ï¼Œå› ä¸ºGeneratorä¸çŸ¥é“å¼‚æ­¥ä»£ç ä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œä½†æ˜¯PromiseçŸ¥é“å•Šï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸Šé¢æ‰€è¯´çš„Promiseã€‚ ä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ï¼Œæˆ‘ä»¬å…ˆå®ç°Generatorçš„è‡ªæ‰§è¡Œ,åœ¨æ¯æ¬¡è°ƒç”¨next()æ—¶ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«yieldåé¢è¯­å¥çš„æ‰§è¡Œçš„è¿”å›å€¼å’Œä¸€ä¸ªæ˜¯å¦å®Œæˆå…¨éƒ¨Generatorå‡½æ•°çš„æ ‡è®°done,æˆ‘ä»¬å¯ä»¥ä¸æ–­è°ƒç”¨nextç›´åˆ°done === trueä¸ºæ­¢ï¼Œå°±å®Œæˆäº†Generatorçš„è‡ªæ‰§è¡Œ 123456789101112131415161718192021function* gen()&#123; yield 1; yield 2; yield 3; yield 4; yield 5;&#125;function run(fn) &#123; var gen = fn(); function next(data) &#123; var result = gen.next(data); if (result.done) return; next(result); &#125; next();&#125;run(gen); æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šå¼•å…¥Promiseï¼Œç°åœ¨æˆ‘ä»¬çš„runå‡½æ•°ä¸­ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±å†™çš„nextå‡½æ•°ï¼Œæ˜¾è€Œæ˜“è§çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ç¨å¾®æ”¹åŠ¨ä¸€ä¸‹è¿™ä¸ªå‡½æ•°å³å¯ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬è¿˜å†™äº†ä¸€ä¸ªreadFileå‡½æ•°æ¨¡ä»¿å¼‚æ­¥ä»£ç ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªPromiseå¹¶åœ¨1000msåresolveã€‚ 1234567891011121314151617181920212223242526272829303132333435var readFile = function(filename) &#123; return new Promise(function(resolve, reject) &#123; setTimeout(function() &#123; resolve(filename); &#125;, 1000); &#125;);&#125;function* gen() &#123; var a = yield readFile(&apos;1&apos;); console.log(a); a = yield readFile(&apos;2&apos;); console.log(a); a = yield readFile(&apos;3&apos;); console.log(a);&#125;var run = function(gen) &#123; var g = gen(); function next(err, data) &#123; var result = g.next(data); if (!result.done) &#123; result.value.then(function(data) &#123; next(null, data); return data; &#125;); &#125; else &#123; console.log(&apos;done&apos;); &#125; &#125; next();&#125;;run(gen); ä¸Šé¢çš„runå‡½æ•°æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬é»˜è®¤yieldåé¢ä¸€å®šæ˜¯ä¸€ä¸ªè¿”å›Promiseçš„å‡½æ•°ï¼Œé‚£å¾ˆå¤šæ—¶å€™ä¸ä¸€å®šä¼šæ˜¯è¿™æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªè½¬æ¢å™¨ï¼ŒæŠŠä¸€åˆ‡çš„å¯¹è±¡éƒ½è½¬ä¸ºPromiseï¼Œè¿™ä¸ªæˆ‘ä»¬è¿™é‡Œä¸å†å®ç°ï¼Œå…·ä½“å¯ä»¥å‚çœ‹TJå¤§ç¥å†™çš„coã€‚ async/awaitåœ¨ES6çš„åŸºç¡€ä¸Šï¼ŒES2017æä¾›äº†asyncå‡½æ•°ï¼Œè¿™å°†å¾—å¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚æˆ‘ä»¬æŠŠæˆ‘ä»¬ä¸Šé¢çš„genå‡½æ•°ç”¨async/awaitæ”¹å†™ä¸€ä¸‹ã€‚å…¶å®å°±æ˜¯å»é™¤*ï¼ŒåŠ ä¸Šasync, æ‰€æœ‰çš„yieldæ”¹ä¸ºawaitå°±å¥½äº† 1234567891011async function gen() &#123; var a = await readFile(&apos;1&apos;); console.log(a); a = await readFile(&apos;2&apos;); console.log(a); a = await readFile(&apos;3&apos;); console.log(a);&#125;gen() ä¸Šé¢çš„ä»£ç ä¼šå’Œä¸Šä¸€èŠ‚æˆ‘ä»¬æœ€åçš„ä»£ç ç»“æœä¸€æ ·ï¼Œè¿™æ˜¯å¾—ç›Šäºasyncè‡ªå¸¦æœ‰è‡ªæ‰§è¡Œå’Œå¼‚æ­¥ç­‰å¾…ã€‚æˆ‘ä»¬å°±ä¸ç”¨å†å†™è‡ªå·±çš„è‡ªæ‰§è¡Œå‡½æ•°å’Œå¼‚æ­¥ä»£ç ç­‰å¾…çš„é€»è¾‘äº†ã€‚awaitå‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯Promiseå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–åŸå§‹ç±»å‹ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œæ•°ç»„ç­‰ï¼‰ï¼Œæ˜¯ä¸æ˜¯å¾ˆé…·ç‚«ã€‚ å¦å¤–ä¸åŒGeneratorè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œasyncå‡½æ•°è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ æ‰€ä»¥ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬è¿˜å¯ä»¥åŠ ä¸Š 123gen().then(function()&#123; console.log(&apos;123&apos;)&#125;) async/awaitå¾ˆé…·ï¼Œä½†æ˜¯ç°åœ¨æµè§ˆå™¨è¿˜æ˜¯æ²¡æœ‰å®Œå…¨æ”¯æŒï¼ŒNodeç«¯åªæœ‰7.0ä»¥ä¸Šæ‰å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ä½¿ç”¨Babelã€‚ ç»“æŸï¼šéšç€ES6çš„å‘å¸ƒï¼Œæˆ‘ä»¬çš„å¼‚æ­¥ä»£ç æ–¹æ¡ˆä¹Ÿè¶Šæ¥è¶Šè¶‹äºæˆç†Ÿäº†","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"modules","date":"2017-01-28T05:38:15.000Z","path":"2017/01/28/modules/","text":"Modules è®¿é—®mainæ¨¡å— å¦å¤–ï¼šåŒ…ç®¡ç†å™¨å°æç¤º All Together ç¼“å­˜ Module Caching Caveatsï¼ˆæ¨¡å—ç¼“å­˜è­¦å‘Šï¼‰ Core Modules(æ ¸å¿ƒæ¨¡å—) Cycles(å¾ªç¯ä¾èµ–) File Modules(æ–‡ä»¶æ¨¡å—) Folders as Modules(æ–‡ä»¶å¤¹åšä¸ºæ¨¡å—) Loading from node_modules Folders(ä»node_modulesæ–‡ä»¶å¤¹ä¸­åŠ è½½æ¨¡å—) Loading from the global folders(ä»å…¨å±€æ–‡ä»¶ä¸­å¯¼å…¥æ¨¡å—) The module wrapper(åŒ…è£¹æ¨¡å—) The module Object(moduleå¯¹è±¡) module.children module.exports exports alias(exportsåˆ«å) module.filename module.id module.loaded module.parent module.require(id) Modulesç¨³å®šæ€§: 3 - locked Node.js has a simple module loading system. In Node.js, files and modules are in one-to-one correspondence. As an example, foo.js loads the module circle.js in the same directory. Node.js æœ‰ä¸€ä¸ªç®€å•çš„æ¨¡å—åŠ è½½ç³»ç»Ÿã€‚åœ¨Node.jsä¸­æ–‡ä»¶å’Œæ¨¡å—æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ä¾‹å¦‚ï¼Œfoo.jsåŠ è½½äº†åŒçº§ç›®å½•ä¸‹çš„circle.jsæ¨¡å— foo.jsçš„å†…å®¹ 12const circle = require(&apos;./circle.js&apos;);console.log(`The area of a circle of radius 4 is $&#123;circle.area(4)&#125;`); circle.jsçš„å†…å®¹ 12345const PI = Math.PI;exports.area = (r) =&gt; PI * r * r;exports.circumference = (r) =&gt; 2 * PI * r; circle.jsæ¨¡å—è¾“å‡ºäº†area()å’Œcircumference()å‡½æ•°ã€‚ä½ å¯ä»¥åœ¨ç‰¹æ®Šçš„exportså¯¹è±¡ä¸Šå¢åŠ å‡½æ•°å’Œå¯¹è±¡ï¼Œæ¥æŠŠå‡½æ•°å’Œå¯¹è±¡å¢åŠ åˆ°æ¨¡å—çš„æ ¹ä½œç”¨åŸŸä¸‹ã€‚ æœ¬åœ°å˜é‡åœ¨æ¨¡å—ä¸­æ˜¯ç§æœ‰çš„ï¼Œå› ä¸ºåœ¨Node.jsä¸­æ¨¡å—ä¼šè¢«ä¸€ä¸ªå‡½æ•°æ‰€åŒ…è£¹ï¼ˆè¯¦è§module wrapperï¼‰,ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå˜é‡PIå¯¹äºcircle.jsæ˜¯ç§æœ‰çš„ å¦‚æœä½ æƒ³è¦æ¨¡å—è¾“å‡ºä¸€ä¸ªå‡½æ•°ï¼ˆç±»ä¼¼æ„é€ å‡½æ•°ï¼‰æˆ–è€…æƒ³è¦ä¸€æ¬¡è¾“å‡ºä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡è€Œä¸æ˜¯æ¯æ¬¡åˆ›å»ºä¸€ä¸ªå±æ€§ï¼Œå°±æŠŠå®ƒç»‘å®šåœ¨module.exportsä¸Šï¼Œè€Œä¸æ˜¯exportsã€‚ ä¸‹é¢ï¼Œ bar.jsä½¿ç”¨äº†squareæ¨¡å—ï¼Œè€Œsquareæ¨¡å—åˆ™è¾“å‡ºçš„æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š 123const square = require(&apos;./square.js&apos;);var mySquare = square(2);console.log(`The area of my square is $&#123;mySquare.area()&#125;`); squareæ¨¡å—å®šä¹‰åœ¨square.jsä¸­ï¼š 123456// ç»‘å®šåœ¨exportsä¸Šä¸ä¼šä¿®æ”¹å½“å‰æ¨¡å—ï¼Œå¿…é¡»è¦ä½¿ç”¨module.exports module.exports = (width) =&gt; &#123; return &#123; area: () =&gt; width * width &#125;;&#125; æ¨¡å—ç³»ç»Ÿåœ¨requireï¼ˆâ€œmoduleâ€ï¼‰æ¨¡å—ä¸­å®ç°ã€‚ è®¿é—®mainæ¨¡å—å½“ä¸€ä¸ªæ–‡ä»¶æ˜¯ç›´æ¥è¢«Node.jsè¿è¡Œçš„ï¼Œrequire.mainè¢«è®¾ç½®ä¸ºå®ƒçš„module,è¿™å°±æ˜¯è¯´ä½ å¯ä»¥ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ–¹å¼æ¥åˆ¤æ–­ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦æ˜¯ç›´æ¥è¢«Node.jsè¿è¡Œçš„ã€‚ 1require.main === module å¯¹äºæ–‡ä»¶foo.jsï¼Œå¦‚æœæ˜¯é€šè¿‡æ‰§è¡Œnode foo.jsæ¥è¿è¡Œçš„ï¼Œä¸Šé¢çš„æµ‹è¯•å°±ä¼šè¿”å›trueï¼Œè€Œå¦‚æœæ˜¯é€šè¿‡require(&#39;./foo&#39;)çš„æ–¹å¼æ¥è¿è¡Œçš„ï¼Œåˆ™ä¼šè¿”å›falseã€‚ å› ä¸ºæ¨¡å—éƒ½æœ‰ä¸€ä¸ªfilenameå±æ€§ï¼ˆä¸€èˆ¬ç­‰åŒäº__filenameï¼‰, å½“å‰é¡¹ç›®ä¼šé€šè¿‡æ ¸å¯¹require.main.filenameæ¥è·å¾—å…¥å£ç‚¹ã€‚ å¦å¤–ï¼šåŒ…ç®¡ç†å™¨å°æç¤ºNode.jsçš„require()å‡½æ•°çš„è¯­ä¹‰è¢«è®¾è®¡ä¸ºè¶³å¤Ÿé€šç”¨ä»¥æ¥æ”¯æŒå¾ˆå¤šåˆç†çš„ç›®å½•ç»“æ„ã€‚dpkgï¼Œrpmå’Œnpmç­‰åŒ…ç®¡ç†ç³»ç»Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹çš„æƒ…å†µä¸‹ä»Nodeæ¨¡å—ä¸­æ„å»ºæœ¬åœ°åŒ…ã€‚ ä¸‹é¢æ˜¯ä¸€äº›æˆ‘ä»¬æˆ‘ä»¬å»ºè®®çš„æœ‰æ•ˆçš„ç›®å½•ç»“æ„ï¼š æˆ‘ä»¬å¸Œæœ›ä¿å­˜ä¸€ä¸ªåŒ…çš„ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬çš„å†…å®¹ä¸‹/usr/lib/node/&lt;some-package&gt;/&lt;some-version&gt;çš„æ–‡ä»¶å¤¹ä¸­ã€‚ åŒ…å¯èƒ½ä¾èµ–äºå…¶ä»–çš„åŒ…ã€‚ä¸ºäº†å®‰è£…ä¸€ä¸ªfooåŒ…ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å®‰è£…ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬baråŒ…ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œbarå¯èƒ½è¿˜æœ‰ä»–è‡ªå·±çš„ä¾èµ–ã€‚è¿™äº›ä¾èµ–æ€§ç”šè‡³å¯èƒ½ç¢°æ’æˆ–å½¢æˆå¾ªç¯ã€‚ å› æ­¤Node.jså¯»æ‰¾å®ƒåŠ è½½çš„ä»»ä½•æ¨¡å—çš„çœŸå®è·¯å¾„ï¼ˆrelapathï¼‰ï¼Œç„¶åå¯»æ‰¾æ¨¡å—çš„ä¸­node_modules æ–‡ä»¶å¤¹ä¸­çš„æ¨¡å—ä¾èµ–å…³ç³»ï¼Œè¿™ç§å½¢å¼å¯ä»¥å¾ˆç®€å•çš„è§£å†³ä»¥ä¸‹çš„æ–‡ä»¶ç»“æ„ï¼š /usr/lib/node/foo/1.2.3/ - ç‰ˆæœ¬1.2.3çš„fooçš„å†…å®¹ã€‚ /usr/lib/node/bar/4.3.2/ - fooä¾èµ–çš„baråŒ…çš„å†…å®¹ /usr/lib/node/foo/1.2.3/node_modules/bar - é“¾æ¥åˆ°çš„/usr/lib/node/bar/4.3.2/ç¬¦å· /usr/lib/node/bar/4.3.2/node_modules/* - baråŒ…çš„æ‰€æœ‰ä¾èµ–çš„é“¾æ¥ç¬¦å· å› æ­¤ï¼Œå³ä½¿é‡åˆ°ä¾èµ–å½¢æˆå¾ªç¯ï¼Œæˆ–è€…ä¾èµ–æœ‰å†²çªï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥è·å–åˆ°å¯ä»¥ç”¨çš„ç‰ˆæœ¬çš„ä¾èµ–ã€‚ å½“fooåŒ…ä»£ç ä¸­æœ‰require(&#39;bar&#39;)ï¼Œå®ƒä¼šå¾—åˆ°é“¾æ¥åˆ°/usr/lib/node/foo/1.2.3/node_modules/barçš„ç‰ˆæœ¬ã€‚å½“baråŒ…ä¸­å¼•ç”¨äº†require(&#39;quxux&#39;),å®ƒä¼šå¾—åˆ°é“¾æ¥åˆ°/usr/lib/node/bar/4.3.2/node_modules/quuxçš„ç‰ˆæœ¬ æ­¤å¤–ï¼Œä¸ºäº†ä½¿æ¨¡å—æŸ¥æ‰¾çš„è¿‡ç¨‹æ›´åŠ ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å§åŒ…æ”¾åœ¨/usr/lib/node_modules/&lt;name&gt;/&lt;version&gt;ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥æ”¾åœ¨/usr/lib/nodeã€‚è¿™æ ·Node.jså°±ä¸ç”¨éº»çƒ¦çš„åœ¨/usr/node_modulesæˆ–è€…/node_moduleså¯»æ‰¾ç¼ºå°‘çš„ä¾èµ–ã€‚ ä¸ºäº†ä½¿æ¨¡å—å¯ä»¥è¢«Node.jsçš„äº¤äº’å¼è§£æå™¨ï¼ˆREPLï¼‰ä½¿ç”¨ã€‚å¯ä»¥å°†/usr/lib/node_modulesæ–‡ä»¶å¤¹æ·»åŠ ä¸º$NODE_PATHç¯å¢ƒå˜é‡ã€‚å› æ­¤æ¨¡å—æŸ¥æ‰¾çš„node_moduleséƒ½æ˜¯ç›¸äº’å…³è”çš„ï¼Œrequire()éƒ½æ˜¯åŸºäºæ–‡ä»¶çš„ç»å¯¹åœ°å€æ¥å¼•ç”¨çš„ï¼Œæ‰€ä»¥åŒ…å¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ã€‚ All Togetherä¸ºäº†åœ¨require()çš„æ—¶å€™è·å–åˆ°ç²¾ç¡®çš„æ–‡ä»¶åå­—ï¼Œä¼šä½¿ç”¨require.resolve()å‡½æ•°ã€‚ ä¸‹é¢æ˜¯require.resolve()çš„é«˜çº§ç®—æ³•çš„ä¼ªç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041åœ¨è·¯å¾„ä¸ºYçš„æ¨¡å—ä¸­require(X)1. å¦‚æœXä¸ºæ ¸å¿ƒæ¨¡å—ï¼Œ a. è¿”å›æ ¸å¿ƒæ¨¡å— b. åœæ­¢2. å¦‚æœXæ˜¯ä»¥&apos;./&apos;,&apos;/&apos;æˆ–è€…&apos;..&apos;å¼€å¤´ a. LOAD_AS_FILE(Y + X) b. LOAD_AS_DIRECTORY(Y + X)3. LOAD_NODE_MODULES(X, dirname(Y))4. æŠ›å‡º &quot;not found&quot;LOAD_AS_FILE(X)1. å¦‚æœXæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥Javascriptæ–‡æœ¬çš„æ–¹å¼å¯¼å…¥Xã€‚åœæ­¢å¯»æ‰¾2. å¦‚æœX.jsæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥Javascriptæ–‡æœ¬çš„æ–¹å¼å¯¼å…¥X.jsã€‚åœæ­¢å¯»æ‰¾3. å¦‚æœx.jsonæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ ¼å¼åŒ–X.jsonä¸ºä¸€ä¸ªå¯¹è±¡ã€‚åœæ­¢å¯»æ‰¾4. å¦‚æœX.nodeæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥äºŒè¿›åˆ¶æ’ä»¶çš„æ–¹å¼å¯¼å…¥X.nodeã€‚åœæ­¢å¯»æ‰¾LOAD_AS_DIRECTORY(X)1. å¦‚æœX/package.jsonæ˜¯ä¸€ä¸ªæ–‡ä»¶ a. è§£æX/package.json ,ç„¶åå¯»æ‰¾â€œmainâ€å­—æ®µ b. let M = X + (json main field) c. LOAD_AS_FILE(M)2. å¦‚æœX/index.jsæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥Javascriptæ–‡æœ¬çš„æ–¹å¼å¯¼å…¥X/index.jsã€‚åœæ­¢å¯»æ‰¾3. å¦‚æœX/index.jsonæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ ¼å¼åŒ–X/index.jsonä¸ºä¸€ä¸ªå¯¹è±¡ã€‚åœæ­¢å¯»æ‰¾4. å¦‚æœX.nodeæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥äºŒè¿›åˆ¶æ’ä»¶çš„æ–¹å¼å¯¼å…¥X/index.nodeã€‚åœæ­¢å¯»æ‰¾LOAD_NODE_MODULES(X, START)1. let DIRS=NODE_MODULES_PATHS(START)2. for each DIR in DIRS: a. LOAD_AS_FILE(DIR/X) b. LOAD_AS_DIRECTORY(DIR/X) NODE_MODULES_PATHS(START)1. let PARTS = path split(START)2. let I = count of PARTS - 13. let DIRS = []4. while I &gt;= 0, a. if PARTS[I] = &quot;node_modules&quot; CONTINUE c. DIR = path join(PARTS[0 .. I] + &quot;node_modules&quot;) b. DIRS = DIRS + DIR c. let I = I - 15. return DIRS ç¼“å­˜æ¨¡å—åœ¨ç¬¬ä¸€æ¬¡è¢«åŠ è½½ä¹‹åå°±ä¼šè¢«ç¼“å­˜ã€‚è¿™å°±æ˜¯è¯´æ¯ä¸€æ¬¡è°ƒç”¨require(&#39;foo&#39;)éƒ½ä¼šè¿”å›ä¸€ä¸ªç›¸åŒçš„å¯¹è±¡ï¼Œå½“ç„¶å‰ææ˜¯æ¯ä¸€æ¬¡requireéƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ã€‚ å¤šæ¬¡è°ƒç”¨require(&#39;foo&#39;)ä¸ä¼šæ˜¯æ¨¡å—ä»£ç è¢«å¤šæ¬¡æ‰§è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§ã€‚å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œâ€œéƒ¨åˆ†å®Œæˆâ€çš„å¯¹è±¡å¯ä»¥è¢«è¿”å›ï¼Œå› æ­¤å…è®¸ä¼ é€’æ€§çš„ä¾èµ–ç”šè‡³æ˜¯å½¢æˆå¾ªç¯çš„ä¾èµ–éƒ½å¯ä»¥è¢«åŠ è½½ã€‚ å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ¨¡å—è¢«è§£æå¤šæ¬¡ï¼Œç„¶åè¾“å‡ºä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æ‰§è¡Œé‚£ä¸ªå‡½æ•°ã€‚ ##Module Caching Caveatsï¼ˆæ¨¡å—ç¼“å­˜è­¦å‘Šï¼‰æ¨¡å—æ˜¯åŸºäºä»–ä»¬çš„è§£æåçš„è·¯å¾„ï¼ˆrequire.resolve()ï¼‰æ¥ç¼“å­˜çš„ã€‚ç”±äºæ¨¡å—åŸºäºè°ƒç”¨æ¨¡å—çš„ä½ç½®ï¼ˆä»node_modulesæ–‡ä»¶ä¸­åŠ è½½ï¼‰ä¸åŒä¼šè¢«è§£æä¸ºä¸åŒçš„æ–‡ä»¶åå­—ï¼Œå¦‚æœæ¨¡å—ä¼šè¢«è§£æåˆ°ä¸åŒçš„æ–‡ä»¶ï¼Œè¿™å°±ä¸èƒ½ä¿è¯require(&#39;foo&#39;)ä¼šä¸€ç›´è¿”å›å®Œå…¨ç›¸åŒçš„å¯¹è±¡ã€‚ ##Core Modules(æ ¸å¿ƒæ¨¡å—)Node.jsæœ‰ä¸€äº›æ¨¡å—ä¼šè¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™äº›æ¨¡å—åœ¨æ–‡æ¡£çš„å…¶ä»–çš„åœ°æ–¹æœ‰æ›´åŠ è¯¦ç»†çš„è¯´æ˜ã€‚ è¿™äº›æ ¸å¿ƒæ¨¡å—è¢«å®šä¹‰åœ¨Node.jsçš„æºä»£ç ä¸­ï¼Œè¢«æ”¾ç½®åœ¨lib/æ–‡ä»¶å¤¹ä¸­ã€‚ è¿™äº›æ ¸å¿ƒæ¨¡å—åœ¨é€šè¿‡require()è°ƒç”¨æ—¶ä¼šä¸€ç›´è¢«ä¼˜å…ˆåŠ è½½ã€‚ä¾‹å¦‚ï¼Œrequire(&#39;http&#39;)ä¼šä¸€ç›´è¿”å›å†…ç½®çš„HTTPæ¨¡å—ï¼Œå³ä½¿ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶åæ˜¯httpçš„æ–‡ä»¶ã€‚ ##Cycles(å¾ªç¯ä¾èµ–)å½“require()è¢«å¾ªç¯è°ƒç”¨ï¼Œæ¨¡å—å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªæœªå®Œæˆæ‰§è¡Œçš„å¯¹è±¡ã€‚ æ¯”å¦‚ä»¥ä¸‹è¿™ç§æƒ…å†µï¼š a.js 123456console.log(&apos;a starting&apos;);exports.done = false;const b = require(&apos;./b.js&apos;);console.log(&apos;in a, b.done = %j&apos;, b.done);exports.done = true;console.log(&apos;a done&apos;); b.js 123456console.log(&apos;b starting&apos;);exports.done = false;const a = require(&apos;./a.js&apos;);console.log(&apos;in b, a.done = %j&apos;, a.done);exports.done = true;console.log(&apos;b done&apos;); main.js 1234console.log(&apos;main starting&apos;);const a = require(&apos;./a.js&apos;);const b = require(&apos;./b.js&apos;);console.log(&apos;in main, a.done=%j, b.done=%j&apos;, a.done, b.done); å½“main.jsåŠ è½½a.jsï¼Œa.jsåè¿‡æ¥éœ€è¦åŠ è½½b.jsã€‚åŒæ—¶ï¼Œb.jsè¯•å›¾åŠ è½½a.jsã€‚ä¸ºäº†é¿å…ä¸€ä¸ªæ— é™çš„å¾ªç¯ï¼Œä¸€ä¸ªæœªå®Œæˆçš„a.jsçš„exportså¯¹è±¡çš„æ‹·è´è¢«è¿”å›ç»™b.jsæ¨¡å—ã€‚ç„¶åå½“b.jsæ¨¡å—åŠ è½½å®Œæˆäº†ï¼Œå®ƒçš„exportså¯¹è±¡å†æä¾›ç»™a.jsæ¨¡å—ã€‚ å½“main.jsåŠ è½½è¿™ä¸¤ä¸ªæ¨¡å—æ—¶ï¼Œå®ƒä»¬éƒ½å·²ç»å®Œæˆäº†ã€‚ è¿™ä¸ªç¨‹åºçš„è¾“å‡ºå°†æ˜¯: 123456789$ node main.jsmain startinga startingb startingin b, a.done = falseb donein a, b.done = truea donein main, a.done=true, b.done=true å¦‚æœä½ çš„é¡¹ç›®ä¸­æœ‰å¾ªç¯çš„æ¨¡å—ä¾èµ–ï¼Œè¯·ç¡®ä¿ä»£ç æŒ‰ç…§è®¡åˆ’çš„æ‰§è¡Œã€‚ ##File Modules(æ–‡ä»¶æ¨¡å—)å¦‚æœå‡†ç¡®æ–‡ä»¶åæ²¡æœ‰æ‰¾åˆ°ï¼ŒNode.jsä¼šå°è¯•å»åŠ è½½æä¾›çš„æ–‡ä»¶ååé¢åŠ ä¸Š.js, .json, æœ€åæ˜¯.nodeçš„æ–‡ä»¶ã€‚ .jsæ–‡ä»¶ä¼šè¢«ä½œä¸ºJavascriptæ–‡æœ¬æ–‡ä»¶è¢«è§£é‡Šï¼Œ.jsonæ–‡ä»¶ä¼šè¢«å½“åšJSONæœ¬æ–‡æ–‡ä»¶è§£æï¼Œ.nodeä¼šè¢«å½“åšç¼–è¯‘å¥½çš„æ’ä»¶æ¨¡å—è¢«è§£é‡Šï¼Œå¹¶ä¸”è¢«dlopenåŠ è½½ã€‚ å¼•ç”¨çš„æ¨¡å—çš„å‰ç¼€ä¸ºâ€™/â€˜æ˜¯æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚ ä¾‹å¦‚ï¼Œrequireï¼ˆ&#39;/home/marco/foo.js&#39;å°†åŠ è½½/home/marco/foo.jsä¸‹çš„æ–‡ä»¶ã€‚ å¼•ç”¨çš„æ¨¡å—çš„å‰ç¼€ä¸ºâ€™./â€˜æ˜¯å½“å‰è°ƒç”¨require()æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚ ä¾‹å¦‚ï¼Œfoo.jsä¸­ä¾èµ–requireï¼ˆ&#39;./corcle&#39;åˆ™è¦æ±‚circle.jså¿…é¡»è¦ä¸foo.jsåœ¨ç›¸åŒçš„ç›®å½•ä¸‹ã€‚ å¦‚æœä¸æ˜¯ä»¥&#39;/&#39;, &#39;./&#39;, æˆ–è€…&#39;../&#39;æ¥è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™æ¨¡å—ä¸€å®šæ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—æˆ–è€…æ˜¯ä»node_modulesæ–‡ä»¶ä¸­åŠ è½½ å¦‚æœæä¾›çš„è·¯å¾„ä¸å­˜åœ¨ï¼Œ require()ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯&#39;MODULE_NOT_FOUND&#39;ã€‚ Folders as Modules(æ–‡ä»¶å¤¹åšä¸ºæ¨¡å—)å¯ä»¥å¾ˆæ–¹ä¾¿å°†é¡¹ç›®å’Œæˆ–è€…åº“ç»„ç»‡åœ¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®å½•ä¸­ï¼Œç„¶åå¯¹å¤–æä¾›è¿™ä¸ªåº“çš„ä¸€ä¸ªç®€å•çš„å…¥å£ã€‚æœ‰ä¸‰ç§æ–¹å¼å¯ä»¥å°†æ–‡ä»¶å¤¹ä¼ é€’ç»™require()ä½œä¸ºå‚æ•°ã€‚ ç¬¬ä¸€ç§æ–¹å¼æ˜¯åˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶åœ¨æ–‡ä»¶å¤¹çš„æ ¹ç›®å½•ä¸‹ï¼ŒåŒæ—¶æŒ‡å®šä¸€ä¸ªmainæ¨¡å—ã€‚ä¸€ä¸ªç®€å•çš„package.jsonçš„æ–‡ä»¶å¯èƒ½æ˜¯å¦‚ä¸‹çš„æ ·å­ï¼š 12&#123; &quot;name&quot; : &quot;some-library&quot;, &quot;main&quot; : &quot;./lib/some-library.js&quot; &#125; å¦‚æœè¿™ä¸ªpackage.jsonæ–‡ä»¶åœ¨./some-libraryä¸­ï¼Œé‚£ä¹ˆå½“require(&#39;./some-library&#39;)ä¼šè¯•å›¾å»åŠ è½½./some-library/lib/some-library.jsã€‚ è¿™æ˜¯Node.jså¯¹package.jsonæ–‡ä»¶çš„æ„è¯†ç¨‹åº¦ã€‚ å¤‡æ³¨ï¼šå¦‚æœpackage.jsonæ–‡ä»¶ä¸­æœªå®šä¹‰mainæ¡ç›®ï¼Œåˆ™æ— æ³•è¢«è§£æï¼ŒNode.jsä¼šæŠ¥å‘Šæ•´ä¸ªæ¨¡å—æ²¡æœ‰è¢«æŸ¥æ‰¾çš„é»˜è®¤é”™è¯¯: 1Error: Cannot find module &apos;some-library&apos; å¦‚æœç›®å½•ä¸‹é¢æ²¡æœ‰package.jsonï¼Œåˆ™Node.jsè·å–å°è¯•ä»è¯¥ç›®å½•åŠ è½½ä¸€ä¸ªindex.jsæˆ–è€…index.nodeã€‚æ¯”å¦‚ï¼Œå¦‚æœä¸Šé¢çš„ä¾‹å­ä¸­æ²¡æœ‰package.jsonæ–‡ä»¶ï¼Œé‚£ä¹ˆrequire(&#39;./some-library&#39;)ä¼šå°è¯•åŠ è½½ ./some-library/index.js ./some-library/index.node ##Loading from node_modules Folders(ä»node_modulesæ–‡ä»¶å¤¹ä¸­åŠ è½½æ¨¡å—)å¦‚æœæ¨¡å—åŠ è½½æ—¶ä¼ é€’ç»™require()çš„æ ‡è¯†ç¬¦ä¸æ˜¯åŸç”Ÿæ¨¡å—ï¼Œä¹Ÿä¸æ˜¯ä»¥â€™/â€˜, â€˜../â€˜, æˆ–è€…â€™./â€˜å¼€å¤´çš„ï¼Œé‚£ä¹ˆNode.jsä¼šä»å½“å‰æ¨¡å—çš„çˆ¶ç›®å½•å¼€å§‹ï¼Œç„¶ååœ¨æ ‡è¯†ç¬¦å‰åŠ ä¸Š/node_modulesï¼Œå¹¶ä¸”å°è¯•ä»åŠ ä¸Šä»¥åçš„è·¯å¾„ä¸‹åŠ è½½æ–‡ä»¶ã€‚Nodeä¸ä¼šå†å·²ç»æ˜¯ä»¥node__modulesç»“å°¾çš„è·¯å¾„ä¸Šå†åŠ ä¸Šnode_modulesã€‚ å¦‚æœåœ¨çˆ¶ç›®å½•ä¸‹æ‰¾ä¸åˆ°ï¼Œåˆ™å¯»æ‰¾å†ä¸Šä¸€å±‚çš„ç›®å½•ï¼Œä¸€ç›´æ‰¾åˆ°æ ¹ç›®å½•ä¸‹ã€‚ æ¯”å¦‚ï¼Œâ€™/home/ry/projects/foo.jsâ€™çš„æ–‡ä»¶è°ƒç”¨äº†require(&#39;bar.js&#39;)ï¼Œé‚£ä¹ˆNode.jsä¼šä»¥ä¸‹é¢è¿™ä¸ªé¡ºåºä¾æ¬¡å¯»æ‰¾å¯»ï¼š /home/ry/projects/node_modules/bar.js /home/ry/node_modules/bar.js /home/node_modules/bar.js /node_modules/bar.js è¿™æ ·å¯ä»¥æœ¬åœ°åŒ–é¡¹ç›®çš„ä¾èµ–ï¼Œå¹¶ä¸”ä½¿è¿™äº›ä¾èµ–ä¸å†²çªã€‚ You can require specific files or sub modules distributed with a module by including a path suffix after the module name. For instance require(â€˜example-module/path/to/fileâ€™) would resolve path/to/file relative to where example-module is located. The suffixed path follows the same module resolution semantics. ##Loading from the global folders(ä»å…¨å±€æ–‡ä»¶ä¸­å¯¼å…¥æ¨¡å—)å¦‚æœç¯å¢ƒå˜é‡NODE_PATHæ˜¯ä¸€ç³»åˆ—ç”±å†’å·åˆ†å‰²ç»å¯¹è·¯å¾„ç»„æˆçš„åˆ—è¡¨ï¼Œé‚£ä¹ˆNode.jså¦‚æœåœ¨å…¶ä»–åœ°æ–¹æ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„æ¨¡å—åˆ™ä¼šåœ¨è¿™äº›è·¯å¾„æŸ¥è¯¢æ¨¡å—ã€‚ï¼ˆå¤‡æ³¨ï¼šåœ¨windowsä¸‹ï¼ŒNODE_PATHæ˜¯ç”±åˆ†å·åˆ†å‰²çš„ï¼‰ NODE_PATHä¸€å¼€å§‹è®¾è®¡æ˜¯ä¸ºäº†æ”¯æŒåœ¨ç°åœ¨çš„æ¨¡å—è§£æç®—æ³•ç¡®å®šä¹‹å‰ä»ä¸åŒè·¯å¾„åŠ è½½æ¨¡å—ã€‚ï¼ˆè¿™é‡Œçš„æ„æ€æ˜¯è¯´Nodeå‘å±•çš„ä¸€å¼€å§‹æ¨¡å—è§£æçš„ç®—æ³•è¿˜æ²¡æœ‰å®Œæˆä¹‹å‰ï¼Œæ˜¯é€šè¿‡NODE_PATHæ¥è§£å†³ä»ä¸åŒçš„è·¯å¾„åŠ è½½æ¨¡å—çš„é—®é¢˜ï¼‰ NODE_PATHç°åœ¨ä¾æ—§æ”¯æŒä¸Šé¢è¯´çš„è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯åœ¨Node.jsç”Ÿæ€ç³»ç»Ÿä¸­æœ‰äº†å®šä½ä¾èµ–çš„çº¦å®šï¼ˆå°±æ˜¯ä¸Šé¢è¯´çš„ä¸€å¤§å †çš„æ¨¡å—æŸ¥è¯¢è§„åˆ™ï¼‰ä¹‹åå°±ä¸æ˜¯é‚£ä¹ˆæœ‰å¿…è¦ã€‚æœ‰æ—¶å€™ä¾èµ–äºNODE_PATHçš„é¡¹ç›®åœ¨éƒ¨ç½²è€Œå½“äººä»¬ä¸çŸ¥é“NODE_PATHå¿…é¡»è¦è¢«è®¾ç½®æ—¶ä¼šå‘ç”Ÿä¸€äº›å¥‡æ€ªçš„è¡¨ç°ã€‚æœ‰æ—¶å€™æ¨¡å—çš„ä¾èµ–å‘ç”Ÿæ”¹å˜ï¼Œå¼•èµ·NODE_PATHæŸ¥è¯¢æ—¶ä¼šåŠ è½½ä¸€ä¸ªç‰ˆæœ¬ä¸åŒçš„æ¨¡å—ï¼ˆç”šè‡³æ˜¯ä¸€ä¸ªä¸åŒçš„æ¨¡å—ï¼‰ã€‚ å¦å¤–ï¼ŒNode.jsä¼šæŸ¥è¯¢ä¸‹é¢çš„è·¯å¾„ $HOME/.node_modules $HOME/.node_libraries $PREFIX/lib/node å½“$HOMEæ˜¯ç”¨æˆ·çš„homeç›®å½•ï¼Œé‚£ä¹ˆNode.jsä¸­$PREFIXä¼šè¢«è®¾ç½®ä¸ºnode_prefixã€‚ è¿™ä¸ªä¸»è¦æ˜¯å‡ºäºå†å²åŸå› ã€‚ä½ æœ€å¥½å°†ä½ çš„ä¾èµ–æœ¬åœ°åŒ–åœ¨node_modulesæ–‡ä»¶å¤¹ä¸­ã€‚è¿™æ ·ä¾èµ–ä¼šè¢«æ›´åŠ å¯é ä¸”å¿«é€Ÿçš„è¢«åŠ è½½ The module wrapper(åŒ…è£¹æ¨¡å—)åœ¨æ¨¡å—ä»£ç æ‰§è¡Œä¹‹å‰ï¼ŒNode.jsä¼šå°†å®ƒåŒ…è£¹åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒä¸‹é¢è¿™ä¸ªæ ·å­ï¼š 123(function (exports, require, module, __filename, __dirname) &#123;// Your module code actually lives in here&#125;); é€šè¿‡è¿™æ ·ï¼ŒNode.jså®ç°äº†ä»¥ä¸‹äº‹æƒ… ä¿è¯äº†æ¨¡å—ä¸­å®šä¹‰çš„é¡¶çº§å˜é‡ï¼ˆé€šè¿‡var,constæˆ–è€…letå®šä¹‰çš„ï¼‰ä¼šåœ¨moduleçš„ä½œç”¨åŸŸä¸­è€Œä¸æ˜¯åœ¨å…¨å±€ã€‚ è¿™æ ·å¯ä»¥æä¾›ä¸€äº›æŒ‡å®šç»™æ¨¡å—çš„å˜é‡å»åƒæ˜¯å…¨å±€å˜é‡ï¼Œä¾‹å¦‚ï¼š å¯ä»¥ä½¿ç”¨moduleå’Œexportsæ¥åœ¨æ¨¡å—é‡Œå¯¹å¤–æš´éœ²ä¸€äº›å˜é‡ åŒ…å«äº†æ¨¡å—çš„æ–‡ä»¶åçš„ç»å¯¹è·¯å¾„å’Œæ¨¡å—æœ¬èº«çš„ç»å¯¹è·¯å¾„çš„__filenameå’Œ__dirnameå˜é‡æ–¹ä¾¿è¢«ä½¿ç”¨ ##The module Object(moduleå¯¹è±¡)Added in: v0.1.16 åœ¨æ¯ä¸ªæ¨¡å—ä¸­ï¼Œè‡ªç”±å˜é‡moduleæ˜¯å½“å‰æ¨¡å—å¯¹è±¡çš„å¼•ç”¨ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨æ¨¡å—ä¸­moduls.exportsä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡exportsæ¥ä½¿ç”¨ã€‚moduleå˜é‡å®é™…ä¸Šä¸æ˜¯å…¨å±€çš„ï¼Œè€Œæ˜¯æ¯ä¸ªæ¨¡å—å†…éƒ¨çš„ã€‚ ###module.childrenAdded in: v0.1.16 è¿™ä¸ªæ¨¡å—éœ€è¦çš„å¯¹è±¡ï¼ˆï¼Ÿï¼Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯æŒ‡è¿™ä¸ªæ¨¡å—ä¾èµ–çš„æ‰€æœ‰æ¨¡å—ï¼‰ ###module.exportsAdded in: v0.1.16 module.exportsæ˜¯ç”±æ¨¡å—ç³»ç»Ÿåˆ›é€ çš„ã€‚æœ‰æ—¶å€™è¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚å¾ˆå¤šäººå¸Œæœ›ä»–ä»¬çš„æ¨¡å—æ˜¯ä¸€äº›ç±»çš„å®ä¾‹ã€‚ä¸ºäº†åšåˆ°è¿™ä¸ªï¼Œåˆ†é…éœ€è¦exportå¯¹è±¡ç»™module.exportsã€‚è¯·æ³¨æ„ï¼Œåˆ†é…éœ€è¦exportå¯¹è±¡ç»™çš„exportsä¼šå¾ˆå®¹æ˜“è¢«ä¿®æ”¹,è€Œè¿™ä¸ªä¸æ˜¯æˆ‘ä»¬å¸Œæœ›ä½ åšçš„ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æˆ‘ä»¬å†™çš„ä¸€ä¸ªæ¨¡å—è°ƒç”¨äº†a.js 123456789const EventEmitter = require(&apos;events&apos;);module.exports = new EventEmitter();// Do some work, and after some time emit// the &apos;ready&apos; event from the module itself.setTimeout(() =&gt; &#123; module.exports.emit(&apos;ready&apos;);&#125;, 1000); æ¥ä¸‹æ¥åœ¨å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­æˆ‘ä»¬è¿™ä¹ˆåš 1234const a = require(&apos;./a&apos;);a.on(&apos;ready&apos;, () =&gt; &#123; console.log(&apos;module a is ready&apos;);&#125;); æ³¨æ„ï¼šåˆ†é…ä¸ªç»™module.exportsçš„å†…å®¹å¿…è¦ç«‹å³å®Œæˆã€‚å®ƒä¸å¯ä»¥åœ¨ä»»ä½•ä¸€ä¸ªå›è°ƒä¸­å®Œæ•´ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å°†å¤±è´¥ï¼šx.js 123setTimeout(() =&gt; &#123; module.exports = &#123; a: &apos;hello&apos; &#125;;&#125;, 0); y.js 12const x = require(&apos;./x&apos;);console.log(x.a); ####exports alias(exportsåˆ«å)Added in: v0.1.16åœ¨æ¨¡å—ä¸­exportså˜é‡å¯åœ¨ä½œä¸ºmodule.exportsçš„å¼•ç”¨ã€‚ä¸ä»»ä½•çš„å˜é‡ä¸€æ ·ï¼Œä¸€æ—¦ä½ æŒ‡å®šäº†æ–°çš„å˜é‡ç»™exportsï¼Œåˆ™ä¸åœ¨ç»‘å®šä¹‹å‰çš„å˜é‡ã€‚ä¸ºäº†è¯´æ˜è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å‡è®¾require()æ˜¯è¿™æ ·æ‰§è¡Œçš„ï¼š 12345678910function require(...) &#123; // ... ((module, exports) =&gt; &#123; // Your module code here exports = some_func; // re-assigns exports, exports is no longer // a shortcut, and nothing is exported. module.exports = some_func; // makes your module export 0 &#125;)(module, module.exports); return module;&#125; ä½œä¸ºæŒ‡å¯¼ï¼Œexportså’Œmodule.exportsçš„å…³ç³»è§†ä¹æœ‰äº›ç¥å¥‡ï¼Œå¿½ç•¥exportsä»…é€‚ç”¨module.exportsã€‚ ####module.filenameAdded in: v0.1.16 æ¨¡å—å®Œæ•´çš„è§£ææ–‡ä»¶åã€‚ ####module.idAdded in: v0.1.16 æ¨¡å—çš„æ ‡è¯†ç¬¦ï¼Œé€šå¸¸æ˜¯æ¨¡å—å®Œæ•´çš„è§£ææ–‡ä»¶åã€‚ module.loadedAdded in: v0.1.16 åˆ¤æ–­moduleæ˜¯å¦å·²ç»åŠ è½½å®Œæˆï¼Œæˆ–è€…æ­£åœ¨åŠ è½½ä¸­ã€‚ ####module.parentAdded in: v0.1.16 æ¨¡å—å¯¹è±¡ç¬¬ä¸€ä¸ªåŠ è½½æœ¬æ¨¡å—çš„çˆ¶æ¨¡å—å¯¹è±¡ã€‚ ####module.require(id)Added in: v0.5.1 id Return: è§£æåˆ°çš„æ¨¡å—çš„module.exportsmodule.requireæ–¹æ³•æä¾›äº†ä¸€ä¸ªè®°è½½æ¨¡å—çš„æ–¹å¼ï¼Œå°±åƒä»åŸå§‹æ¨¡å—è°ƒç”¨require()ä¸€æ ·ã€‚ å¤‡æ³¨ï¼šä¸ºäº†å®ç°è¿™ä¸ªï¼Œä½ å¿…é¡»æ‹¿åˆ°moduleå¯¹è±¡çš„å¼•ç”¨ã€‚ç”±äºrequire()æ˜¯è¿”å›module.exportå¯¹è±¡,ä¸”moduleé€šå¸¸æ˜¯åªåœ¨æ¨¡å—ä¸­ç‰¹å®šçš„ä»£ç ä¸­å¯ç”¨ï¼Œå› æ­¤å®ƒå¿…é¡»è¢«æ˜¾å¼åˆ°å¤„ä»¥ä¾¿ä½¿ç”¨ã€‚","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"querystring","date":"2017-01-28T05:34:08.000Z","path":"2017/01/28/querystring/","text":"ç›®å½• Query String querystring.escape(str) querystring.parse(str[, sep[, eq[, options]]]) querystring.stringify(obj[, sep[, eq[, options]]]) querystring.unescape(str) #Query String ç¨³å®šæ€§ï¼š2 - ç¨³å®šquertstring æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—ç”¨äºè§£æå’Œæ ¼å¼åŒ–urlå‚æ•°çš„å·¥å…·ï¼Œå®ƒå¯ä»¥è¢«å¦‚ä¸‹ä½¿ç”¨1const querystring = require(&apos;querystring&apos;); querystring.escape(str)åŠ å…¥ï¼šv0.1.25 str \\querystring.escape() å¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œç™¾åˆ†æ¯”ç¼–ç ï¼ŒåŒæ—¶é’ˆå¯¹urlæŸ¥è¯¢å­—ç¬¦ä¸²çš„ç‰¹å®šè¦æ±‚è¿›è¡Œäº†ä¼˜åŒ– querystring.escape()è¢«querystring.stringify()ä½¿ç”¨ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸æ¨èç›´æ¥ä½¿ç”¨ã€‚ä¸»è¦åœ¨åº”ç”¨ç¨‹åºä»£ç åœ¨å¿…è¦çš„æ—¶å€™è¢«ç”¨æ¥åˆ†é…ç»™æ›¿ä»£å‡½æ•°æ¥å®ç°ç™¾åˆ†æ¯”ç¼–ç  ï¼Ÿï¼Ÿ querystring.parse(str[, sep[, eq[, options]]])åŠ å…¥ï¼šv0.1.25 str \\ å¾…è§£æçš„urlæŸ¥è¯¢å­—ç¬¦ä¸² sep \\ ç”¨äºåˆ†ç•ŒæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­æ¯å¯¹keyä¸valueçš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º&#39;&amp;&#39;. eq \\ ç”¨äºåˆ†ç•ŒæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­keyä¸valueçš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º&#39;=&#39;. options \\ decodeURIComponent \\ è®¾ç½®ä¸€ä¸ªå‡½æ•°è§£ç ç™¾åˆ†æ¯”ç¼–ç çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä½¿ç”¨querystring.unescape(). maxKeys \\ æŒ‡å®šç¼–ç æ—¶keyæ•°é‡æœ€å¤šä¸ºå¤šå°‘ã€‚é»˜è®¤æ˜¯1000ï¼Œè®¾ç½®ä¸º0åˆ™è¡¨ç¤ºä¸é™æ•°é‡querystring.parse()å‡½æ•°å¯ä»¥è§£æä¸€ä¸ªurlçš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆstrï¼‰ä¸ºä¸€ä¸ªé”®å€¼å¯¹ï¼ˆkeyï¼švalueï¼‰çš„é›†åˆä¾‹å¦‚ï¼Œä¸€ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²ä¸º&#39;foo=bar&amp;abc=xyz&amp;abc=123&#39;å¯ä»¥è¢«è§£æä¸º1234&#123; foo: &apos;bar&apos;, abc: [&apos;xyz&apos;, &apos;123&apos;]&#125; æ³¨ï¼šquerystring.parse()è¿”å›çš„å¯¹è±¡ä¸æ˜¯åŸå‹ç»§æ‰¿äºJavascriptçš„Objectå¯¹è±¡ï¼Œæ‰€ä»¥ç±»ä¼¼obj.toString(), obj.hasOwnProperty()ç­‰å…¸å‹çš„Objectå¯¹è±¡çš„æ–¹æ³•å°†æ— æ³•ä½¿ç”¨ é»˜è®¤æƒ…å†µä¸‹ï¼Œç™¾åˆ†æ¯”ç¼–ç æŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ä¼šä½¿ç”¨UFT-8ç¼–ç ï¼Œå¦‚æœä½¿ç”¨ä»£æ›¿å­—ç¬¦ç¼–ç ï¼Œåˆ™éœ€è¦æŒ‡å®šä»£æ›¿å­—ç¬¦çš„decodeURIComponenté€‰é¡¹ï¼Œå¦‚ä¸‹ä¾‹å­12// å‡å®š gbkDecodeURIComponent å‡½æ•°å·²ç»å­˜åœ¨..querystring.parse(&apos;w=%D6%D0%CE%C4&amp;foo=bar&apos;, null, null, &#123; decodeURIComponent: gbkDecodeURIComponent &#125;) ##querystring.stringify(obj[, sep[, eq[, options]]]) åŠ å…¥ï¼šv0.1.25 obj \\ è¦è¢«åºåˆ—åŒ–ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²çš„å¯¹è±¡. sep \\ ç”¨äºåˆ†ç•ŒæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­æ¯å¯¹keyä¸valueçš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º&#39;&amp;&#39;. eq \\ ç”¨äºåˆ†ç•ŒæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­keyä¸valueçš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º&#39;=&#39;. options encodeURIComponent \\ åœ¨è½¬æ¢æŸ¥è¯¢å­—ç¬¦ä¼ æ—¶æŠŠurlä¸­ä¸å®‰å…¨çš„çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºç™¾åˆ†æ¯”ç¼–ç çš„å‡½æ•°.é»˜è®¤ä½¿ç”¨querystring.escape().querystring.stringify()å‡½æ•°æ˜¯é€šè¿‡éå†å¯¹è±¡çš„â€œown propertiesâ€œæ¥ç”ŸæˆurlæŸ¥è¯¢å­—ç¬¦ä¸²ä¾‹å­ï¼š12345querystring.stringify(&#123; foo: &apos;bar&apos;, baz: [&apos;qux&apos;, &apos;quux&apos;], corge: &apos;&apos; &#125;)// returns &apos;foo=bar&amp;baz=qux&amp;baz=quux&amp;corge=&apos;querystring.stringify(&#123;foo: &apos;bar&apos;, baz: &apos;qux&apos;&#125;, &apos;;&apos;, &apos;:&apos;)// returns &apos;foo:bar;baz:qux&apos; ä¸€èˆ¬ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­éœ€è¦ç™¾åˆ†æ¯”ç¼–ç çš„å­—ç¬¦ä¼šè¢«ç¼–ç ä¸ºUTF-8æ ¼å¼ã€‚å¦‚æœéœ€è¦ä»£æ›¿çš„ç¼–ç ï¼Œé‚£ä¹ˆå°†éœ€è¦æŒ‡å®šå¦ä¸€ä¸ªencodeURIComponenté€‰é¡¹ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤º1234// å‡å®š gbkEncodeURIComponent å‡½æ•°å·²ç»å­˜åœ¨,querystring.stringify(&#123; w: &apos;ä¸­æ–‡&apos;, foo: &apos;bar&apos; &#125;, null, null, &#123; encodeURIComponent: gbkEncodeURIComponent &#125;) ##querystring.unescape(str)åŠ å…¥ï¼šv.0.1.25 str \\querystring.unescape()æ–¹æ³•å¯ä»¥å¯¹æä¾›çš„å­—ç¬¦ä¸²è¿›è¡Œurlçš„ç™¾åˆ†æ¯”ç¼–ç .The querystring.unescape() method is used by querystring.parse() and is generally not expected to be used directly. It is exported primarily to allow application code to provide a replacement decoding implementation if necessary by assigning querystring.unescape to an alternative functionquerystring.unescape()æ–¹æ³•è¢«querystring.parse()å‡½æ•°æ‰€ä½¿ç”¨ï¼Œä¸€èˆ¬æ¥è¯´ä¹Ÿä¸æ¨èç›´æ¥ä½¿ç”¨è¯¥å‡½æ•°ã€‚ä¸»è¦åœ¨åº”ç”¨ç¨‹åºä»£ç åœ¨å¿…è¦çš„æ—¶å€™è¢«ç”¨æ¥åˆ†é…ç»™æ›¿ä»£å‡½æ•°æ¥å®ç°æ›¿æ¢è§£ç ï¼Ÿï¼Ÿé»˜è®¤æƒ…å†µä¸‹ï¼Œquerystring.unescape()å‡½æ•°ä¼šå°è¯•ä½¿ç”¨åŸºäºdecodeURIComponent()æ–¹æ³•æ¥è¿›è¡Œè§£ç ï¼Œè¿™æ ·å³ä½¿è§£ç å¤±è´¥äº†ï¼Œä¹Ÿä¼šè¾“å‡ºä¸€ä¸ªæ›´åŠ å®‰å…¨ç­‰æ•ˆçš„ç»“æœï¼Œè€Œä¸ä¼šè¾“å‡ºä¸€ä¸ªé”™è¯¯çš„url","tags":[{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"åæ€JavaScript: é€šè¿‡å‡½æ•°ä»£æ›¿break","date":"2017-01-27T11:05:17.000Z","path":"2017/01/27/rethinking-javascript-break-is-the-goto-of-loops/","text":"åŸæ–‡ï¼šhttps://hackernoon.com/rethinking-javascript-break-is-the-goto-of-loops-51b27b1c85f8#.k2oyppp5i åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç«  Death of the for Loopä¸­ï¼Œæˆ‘è¯•å›¾å»è¯´æœä½ æ”¾å¼ƒä½¿ç”¨for å¾ªç¯æ”¹ç”¨å‡½æ•°å¼çš„è§£å†³æ–¹æ¡ˆã€‚åè¿‡æ¥ï¼Œä½ æå‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼Œé‚£ä¹ˆforå¾ªç¯ä¸­breakæ€ä¹ˆåŠï¼Ÿ break ä¼šç›¸å½“äºå¾ªç¯ä¸­çš„GOTOï¼Œæˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨ã€‚ break åº”è¯¥åƒGOTOä¸€æ ·è¢«åºŸå¼ƒã€‚ ä½ å¯èƒ½ä¼šæƒ³â€œç®—äº†å§Joelï¼Œä½ è¿™åªæ˜¯è€¸äººå¬é—»ï¼Œbreakæ€ä¹ˆå¯èƒ½ä¼šåƒGOTOä¸€æ ·ï¼Ÿâ€ 1// bad code. no copy paste. 1234567outer: for (var i in outerList) &#123;inner: for (var j in innerList) &#123; break outer; &#125; &#125; æˆ‘å¯ä»¥æä¾›æ ‡è®°ä½œä¸ºè¯æ˜ã€‚åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œæ ‡è®°å’ŒGOTOæ˜¯ç›¸äº’å¯¹åº”çš„ã€‚åœ¨JavaScriptï¼Œæ ‡è®°ä¸breakå’Œcontinueä¹Ÿæ˜¯ç›¸äº’å¯¹åº”çš„ã€‚å› ä¸ºbreakå’Œcontinueæ¥è‡ªäºç›¸åŒæ ‡è®°ç»„ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†å®ƒä»¬å’ŒGOTOå¾ˆåƒã€‚ JavaScriptæ ‡ç­¾ï¼Œbreakå’Œcontinueæ˜¯GOTOå’Œéç»“æ„åŒ–ç¼–ç¨‹æ—¶ä»£çš„é—ç•™ xkcd â€œä½†æ˜¯å¦‚æœå®ƒæ²¡æœ‰ä¼¤å®³ä»»ä½•äººï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸æŠŠå®ƒç•™ä¸‹è¯­æ³•ä¸­ï¼Œè€Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å…¶ä»–çš„æ–¹æ¡ˆï¼Ÿâ€ æˆ‘ä»¬ä¸ºä»€ä¹ˆé™åˆ¶æˆ‘ä»¬å¦‚ä½•ç¼–å†™è½¯ä»¶?è¿™ä¸ªå¬ä¸Šå»æœ‰äº›è¿èƒŒç›´è§‰ï¼Œä½†æ˜¯é™åˆ¶æ˜¯ä¸€ä¸ªå¥½äº‹ã€‚é™åˆ¶æˆ‘ä»¬ä½¿ç”¨GOTOå°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚æˆ‘ä»¬ä¹Ÿå¾ˆæ¬¢è¿é™åˆ¶æˆ‘ä»¬çš„â€œuse strictâ€ï¼Œç”šè‡³æ‰¹è¯„ä¸ä½¿ç”¨å®ƒçš„äººã€‚ â€œlimitations can make things better. A lot better. â€œâ€” Charles Scalfani é™åˆ¶ï¼ˆè§„åˆ™ï¼‰å¯ä»¥ä½¿æˆ‘ä»¬å†™å‡ºæ›´å¥½çš„ä»£ç ã€‚ ä¸ºä»€ä¹ˆç¼–ç¨‹éœ€è¦é™åˆ¶_é™åˆ¶ä½¿è‰ºæœ¯ï¼Œè®¾è®¡ï¼Œç”Ÿæ´»æ›´ç¾å¥½._medium.com æˆ‘ä»¬å¯¹äºbreakçš„é€‰æ‹©æ˜¯ä»€ä¹ˆ?æˆ‘ä¸æ˜¯è¦åšä¸€ä¸ªè™šæœ‰å…¶è¡¨çš„äº‹æƒ…ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰ä¸€ä¸ªæ–¹æ¡ˆå¯ä»¥é€‚åˆæ‰€æœ‰çš„æƒ…å†µã€‚ è¿™æ˜¯ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ç¼–ç¨‹æ–¹å¼ã€‚ ä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ€è€ƒæ–¹å¼ã€‚å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚ æœ‰ä¸€ä¸ªå¥½æ¶ˆæ¯æ˜¯ï¼Œæœ‰å¾ˆå¤šçš„åº“å’Œå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬ï¼Œä¾‹å¦‚Lodash, Ramda, lazy.js, é€’å½’ç­‰ç­‰ æˆ‘ä»¬å°†ä»ä¸€ä¸ªç®€å•çš„catsé›†åˆå’Œä¸€ä¸ªisKittenå‡½æ•°å¼€å§‹ï¼Œè¿™äº›å°†åœ¨ä¸‹é¢æ‰€æœ‰çš„ä¾‹å­ä¸­è¢«ç”¨åˆ°ã€‚ 123456const cats = [ &#123; name: &apos;Mojo&apos;, months: 84 &#125;, &#123; name: &apos;Mao-Mao&apos;, months: 34 &#125;, &#123; name: &apos;Waffles&apos;, months: 4 &#125;, &#123; name: &apos;Pickles&apos;, months: 6 &#125;] 1const isKitten = cat =&gt; cat.months &lt; 7 è®©æˆ‘ä»¬ä»ä¸€ä¸ªæˆ‘ä»¬ç†Ÿæ‚‰çš„forå¾ªç¯çš„ä¾‹å­å¼€å§‹ã€‚å®ƒä¼šéå†æˆ‘ä»¬çš„catsï¼Œç„¶åå½“æ‰¾åˆ°ç¬¬ä¸€åªå°çŒ«çš„æ—¶å€™é€€å‡ºå¾ªç¯ã€‚ 1var firstKitten 123456for (var i = 0; i &lt; cats.length; i++) &#123; if (isKitten(cats[i])) &#123; firstKitten = cats[i] break &#125;&#125; ç°åœ¨ï¼Œè®©æˆ‘ä»¬å’Œlodashä¸­ä¸€ä¸ªç›¸åŒä½œç”¨çš„ä¾‹å­åšæ¯”è¾ƒã€‚ 1const firstKitten = _.find(cats, isKitten) è¿™ä¸ªä¾‹å­ç›¸å½“çš„ç®€å•ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬å°è¯•ä¸€äº›è¾¹ç¼˜æƒ…å†µå§ã€‚ç°åœ¨æˆ‘ä»¬æ”¹ä¸ºéå†caté›†åˆï¼Œç„¶åé€‰å‡ºå‰5åªå°çŒ«ï¼Œç„¶åé€€å‡ºå¾ªç¯ã€‚ 1var first5Kittens = [] 1234// old-school edge case kitty loopfor (var i = 0; i &lt; cats.length; i++) &#123; if (isKitten(cats[i])) &#123; first5Kittens.push(cats[i]) 12345 if (first4Kittens.length &gt;= 5) &#123; break &#125; &#125;&#125; ç®€å•çš„æ–¹å¼lodashæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åº“ä¹Ÿå¯ä»¥åå¾ˆå¤šçš„äº‹æƒ…ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä½ éœ€è¦ä¸€äº›å…¶ä»–æ›´åŠ ä¸“ä¸šçš„å·¥å…·ã€‚è¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€ä¸ªæ–°æœ‹å‹, lazy.js. â€œåƒUnderscoreï¼Œä½†æ˜¯æ›´åŠ å·æ‡’â€ã€‚ä½†æ˜¯å·æ‡’å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„. 123const result = Lazy(cats) .filter(isKitten) .take(5) å›°éš¾çš„æ–¹æ³•åº“éƒ½æ˜¯æœ‰è¶£çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™çœŸæ­£æœ‰è¶£çš„æ˜¯ä»å¤´å¼€å§‹åˆ›é€ ä¸œè¥¿ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªé€šç”¨çš„å‡½æ•°ï¼Œè®©å®ƒå¯ä»¥åƒfilterä¸€æ ·ä½¿ç”¨ä¹Ÿå¯ä»¥å¢åŠ é™åˆ¶çš„åŠŸèƒ½ã€‚ ç¬¬ä¸€æ­¥å°±æ˜¯æŠŠæˆ‘ä»¬ä¸Šé¢å†™çš„è¾¹ç¼˜æƒ…å†µçš„forå¾ªç¯å°è£…åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ã€‚ æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ˜¯è¿™ä¸ªå‡½æ•°æ›´åŠ é€šç”¨å¹¶ä¸”éå†æ‰€æœ‰catå…·ä½“çš„å†…å®¹ã€‚ä½¿ç”¨limitæ¥ä»£æ›¿5,predicateæ¥ä»£æ›¿isKittenï¼Œlistæ¥ä»£æ›¿catsã€‚ç„¶åæŠŠè¿™äº›ä½œä¸ºå‡½æ•°çš„å‚æ•°ã€‚ ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯ç”¨çš„ä¸”å¯é‡å¤çš„takeFirstå‡½æ•°ï¼Œè¿™ä¸ªå¯ä»¥è®©æˆ‘ä»¬å®Œå…¨ä¸ç”¨å»å…³å¿ƒæˆ‘ä»¬catçš„é€»è¾‘å®ç°ï¼ æˆ‘ä»¬çš„å‡½æ•°ç°åœ¨ä¾æ—§è¿˜æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°çš„è¾“å‡ºåªå’Œè¾“å…¥çš„å‚æ•°æœ‰å…³ã€‚å¦‚æœä¼ å…¥ç›¸åŒçš„å‚æ•°ï¼Œä¸€å®šä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœã€‚ ç°åœ¨æˆ‘ä»¬å·²ç»è¿˜æ˜¯æœ‰é‚£ä¸ªè‚®è„çš„forå¾ªç¯ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç»§ç»­é‡æ„ã€‚ä¸‹ä¸€æ­¥å°±æ˜¯æŠŠiå’ŒnewListæ”¾å…¥å‚æ•°åˆ—è¡¨ã€‚ å½“limitå˜ä¸º0çš„æ—¶å€™ (limitä¼šåœ¨é€’å½’è¿‡ç¨‹ä¸­å‡å°‘)æˆ–è€…æ˜¯éå†å®Œäº†åˆ—è¡¨ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥é€€å‡ºé€’å½’(isDone)ã€‚ å¦‚æœé€’å½’è¿˜åœ¨è¿›è¡Œï¼Œæˆ‘ä»¬å°†ä¼šæ ¸å¯¹æ˜¯å¦æœ‰ç¬¦åˆæˆ‘ä»¬çš„è¿‡æ»¤æ¡ä»¶predicateçš„å€¼ã€‚å¦‚æœå½“å‰å€¼ç¬¦åˆè¿‡æ»¤æ¡ä»¶ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨takeFirstï¼Œå‡å°‘limitå¹¶æŠŠå½“å‰å€¼ä¿å­˜åœ¨æˆ‘ä»¬çš„newListä¸­ï¼Œå¦è€…ï¼Œç§»åŠ¨åˆ°åˆ—è¡¨çš„ä¸‹ä¸€ä¸ªå€¼ã€‚ å¦‚æœä½ è¿˜æ²¡æœ‰çœ‹è¿‡Rethinking JavaScript: The if statementï¼Œå®ƒä¼šè§£é‡Šè¿™ä¸ªç”¨ä¸‰å…ƒè¡¨è¾¾å¼ä»£æ›¿ifâ€˜çš„æœ€åä¸€æ­¥ã€‚ Rethinking JavaScript: The if statement_Thinking functionally has opened my mind about programming._medium.com ç°åœ¨æˆ‘ä»¬åƒä¸‹é¢è¿™æ ·è°ƒç”¨æˆ‘ä»¬çš„æ–°æ–¹æ³•ï¼š 1const first5Kittens = takeFirst(5, isKitten, cats) ä¸ºäº†å…¼å®¹æ›´å¤šçš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æŸ¯é‡ŒåŒ–takeFirstï¼Œç„¶åä½¿ç”¨å®ƒå»åˆ›å»ºä¸€äº›å…¶ä»–çš„å‡½æ•°ï¼ˆå…³äºæŸ¯é‡ŒåŒ–çš„ä»‹ç»åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ï¼‰ 12const first5 = takeFirst(5)const getFirst5Kittens = first5(isKitten) 1const first5Kittens = getFirst5Kittens(cats) æ€»ç»“ç°åœ¨æœ‰å¾ˆå¤šä¼˜ç§€çš„åº“ä¾‹å¦‚ lodash, ramdaå’Œlazy.jsä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¶³å¤Ÿå¤§èƒ†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é€’å½’æ¥åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å‡½æ–¹æ³•ã€‚ æˆ‘å¿…é¡»è¦è­¦å‘Šè™½ç„¶takeFirstçœ‹ä¸Šå»å¾ˆé…· ä½†æ˜¯ä½¿ç”¨é€’å½’æ˜¯æœ‰å¾—ä¹Ÿæœ‰å¤±çš„. é€’å½’åœ¨Javascriptä¸­æ˜¯å¾ˆå±é™©çš„ï¼Œå®ƒå¾ˆå®¹æ˜“å°±ä¼šå¯¼è‡´è¶…å‡ºæœ€å¤§è°ƒç”¨å †æ ˆå¤§å°çš„æŠ¥é”™ã€‚ æˆ‘å°†ä¼šåœ¨æˆ‘çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­é‡å†™JavaScriptçš„é€’å½’ã€‚æ•¬è¯·å…³æ³¨ã€‚ æˆ‘çŸ¥é“è¿™åªæ˜¯ä¸€ä»¶å°äº‹ï¼Œä½†æ˜¯å½“æˆ‘æ”¶åˆ°æ¥è‡ªMediumå’ŒTwitter (@joelnet)çš„followé€šçŸ¥æ—¶ä¼šä½¿æˆ‘å¾ˆå¼€å¿ƒã€‚å½“ç„¶ï¼Œå¦‚æœä½ è§‰å¾—æˆ‘å®åœ¨èƒ¡è¯´å…«é“ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä¸‹é¢çš„è®¨è®ºåŒºå‘Šè¯‰æˆ‘ã€‚ Cheers!","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"Nodeå­¦ä¹ ä¹‹è·¯ï¼šrequire()å·¥ä½œåŸç†","date":"2017-01-27T07:23:25.000Z","path":"2017/01/27/how-require-actually-works/","text":"åŸæ–‡ï¼šhttp://thenodeway.io/posts/how-require-actually-works/ ä»‹ç» Nodeå­¦ä¹ ä¹‹è·¯ æŒæ¡çš„åŸºæœ¬çŸ¥è¯† ç†è§£å›è°ƒå‡½æ•°ä¸­çš„é”™è¯¯ä¼˜å…ˆ æµ‹è¯•è¦ç‚¹ è¿›é˜¶ å•ä¾‹æ¨¡å¼ è®¾è®¡è‡ªå®šä¹‰ç±»å‹ å·¥å‚æ¨¡å¼ é«˜çº§ require() å·¥ä½œåŸç† å±é™©çš„æ¨¡å—è®¾è®¡æ¨¡å¼ å‡ ä¹æ‰€æœ‰çš„Node.jså¼€å‘è€…éƒ½å¯ä»¥è¯´å‡ºrequire()çš„ä½œç”¨ï¼Œä½†æ˜¯åˆæœ‰å¤šå°‘äººçœŸæ­£çŸ¥é“require()æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ã€‚æˆ‘ä»¬å‡ ä¹æ¯å¤©éƒ½ä¼šä½¿ç”¨å®ƒå»åŠ è½½åº“å’Œæ¨¡å—ï¼Œä½†æ˜¯å®ƒçš„åŸç†è¿˜æ˜¯ä¸€ä¸ªè°œã€‚ å› ä¸ºå¥½å¥‡ï¼Œæˆ‘æŸ¥çœ‹äº†Nodeçš„æ ¸å¿ƒæºç å»å¯»æ‰¾ç­”æ¡ˆã€‚ä½†æ˜¯æˆ‘ä¸æ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯æ‰¾åˆ°äº†Nodeçš„æ ¸å¿ƒæ¨¡å—:module.jsã€‚è¿™ä¸ªæ–‡ä»¶æƒŠäººçš„å¼ºå¤§ï¼Œå®ƒåŒ…å«äº†æ–‡ä»¶çš„åŠ è½½ï¼Œç¼–è¯‘ï¼Œå¹¶ä¸”å¯ä»¥ç¼“å­˜æ‰€æœ‰ä½¿ç”¨è¿‡çš„æ–‡ä»¶ã€‚å¯¹å¤–ä½¿ç”¨çš„require()åªæ˜¯å†°å±±ä¸€è§’ã€‚ module.js12345function Module(id, parent) &#123; this.id = id; this.exports = &#123;&#125;; this.parent = parent; // ... module.jsé‡Œçš„æ¨¡å—ç±»å‹åœ¨Node.jsä¸­æœ‰ä¸¤ä¸ªä¸»è¦çš„ä½œç”¨ã€‚ç¬¬ä¸€ï¼Œå®ƒä¸ºæ‰€æœ‰çš„Node.jsæ¨¡å—æä¾›äº†ä¸€ä¸ªå‡½æ•°ç”¨äºç¼–è¯‘ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶åœ¨è¿™ä¸ªåŸºç¡€æ¨¡å—ä¸­è¿è¡Œåéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå³ä½¿è¿™ä¸ªæ–‡ä»¶è¿è¡Œäº†ä¹Ÿè¿˜æ˜¯ä¼šå­˜åœ¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥éšæ—¶ä½¿ç”¨ module.exportså¹¶ä¸”å¯ä»¥è¿”å›å®ƒã€‚ è¿™ä¸ªæ¨¡å—çš„ç¬¬äºŒä¸ªä¸»è¦çš„ä½œç”¨å°±æ˜¯ç®¡ç†Nodeæ¨¡å—åŠ è½½æœºåˆ¶ã€‚è¿™ä¸ªç‹¬ç«‹çš„requireå‡½æ•°å…¶å®æ˜¯module.requireçš„ä¸€ä¸ªå¼•ç”¨ï¼Œè€Œmodule.requireåªæ˜¯ä¸€ä¸ªæŠŠModule._loadç®€å•åŒ…è£¹äº†ä¸€ä¸‹ï¼ˆwapperï¼‰ã€‚è¿™ä¸ªå‡½æ•°æ‰æ˜¯çœŸæ­£æ§åˆ¶æ–‡ä»¶çš„åŠ è½½çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡è¿™ä¸ªå‡½æ•°ç»§ç»­æˆ‘ä»¬çš„æ¢ç´¢ã€‚ Module._load12345678Module._load = function(request, parent, isMain) &#123; // 1\\. æ£€æŸ¥ Module._cache æ˜¯å¦æœ‰ç¼“å­˜ // 2\\. å¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å—å®ä¾‹ // 3\\. å°†æ¨¡å—å®ä¾‹ä¿å­˜åˆ°ç¼“å­˜ä¸­ // 4\\. é€šè¿‡ç»™äºˆçš„filenameå»è°ƒç”¨module.load()ï¼Œç„¶åè°ƒç”¨module.compile()å»è¯»å–æ–‡ä»¶å†…å®¹ // 5\\. å¦‚æœæ–‡ä»¶çš„è½½å…¥å’Œè§£æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œåˆ é™¤ç¼“å­˜ä¸­çš„è¯¥æ¨¡å— // 6\\. è¿”å› module.exports&#125;; Module._loadæ˜¯ä¸€ä¸ªè´Ÿè´£æ–°æ¨¡å—çš„åŠ è½½å’Œç®¡ç†æ¨¡å—ç¼“å­˜çš„å‡½æ•°ã€‚ç¼“å­˜æ‰€æœ‰åŠ è½½è¿‡çš„æ¨¡å—å¯ä»¥å‡å°‘æ–‡ä»¶çš„é‡å¤åŠ è½½å¹¶ä¸”æ˜æ˜¾åœ°åŠ å¿«ä½ çš„åº”ç”¨ã€‚æ­¤å¤–ï¼Œå…±äº«æ¨¡å—çš„å®ä¾‹å¯ä»¥æŠŠæ¨¡å—åƒå•ä¾‹æ¥ä½¿ç”¨ï¼Œå¯ä»¥åœ¨æ•´ä¸ªé¡¹ç›®çš„è¿è¡Œä¸­éƒ½å¯ä»¥ä¿å­˜å®ƒçš„çŠ¶æ€ã€‚ å¦‚æœä¸€ä¸ªæ¨¡å—ä¸å­˜åœ¨åœ¨ç¼“å­˜ä¸­ï¼ŒModule._load ä¼šä¸ºè¿™ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ–°çš„åŸºç¡€æ¨¡å—ã€‚Module._loadä¼šé€šçŸ¥æ¨¡å—å»è¯»å–æ–°çš„æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åæŠŠå†…å®¹é€åˆ°module._compileã€‚[1] å¦‚æœä½ çœ‹äº†ä¸Šé¢çš„#6ï¼Œé‚£ä¹ˆä½ å°±ä¼šçœ‹åˆ°module.exportsä¼šè¢«è¿”å›ç»™ç”¨æˆ·ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥é€šè¿‡exportså’Œmodule.exportsåˆ›å»ºä¸€ä¸ªå¯¹å¤–çš„å…¬å…±æ¥å£ï¼Œè€Œè¿™äº›å°±æ˜¯Module._loadåšçš„äº‹æƒ…ï¼Œç„¶åé€šè¿‡requireè¿”å›å‡ºå»ã€‚æˆ‘å¾ˆæƒŠè®¶äºé™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶ä»–çš„ç¥å¥‡çš„åœ°æ–¹äº†ï¼Œä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆæ¯”å®ƒæ›´åŠ ç®€æ´æ›´åŠ å¥½çš„äº†ã€‚ module._compile123456Module.prototype._compile = function(content, filename) &#123; // 1\\. åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„requireå‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥è°ƒç”¨module.requireã€‚ // 2\\. ç»™requireåŠ ä¸Šå…¶ä»–å¸®åŠ©æ€§çš„å‡½æ•°Attach other helper methods to require. // 3\\. å°†ä»£ç åŒ…è£¹åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¹¶æä¾›äº†requireï¼Œmoduleç­‰å˜é‡åœ¨æ¨¡å—ä½œç”¨åŸŸä¸­ã€‚ // 4\\. è¿è¡Œè¿™ä¸ªå‡½æ•°&#125;; è¿™é‡Œå°±æ˜¯è§è¯å¥‡è¿¹çš„åœ°æ–¹ã€‚ç¬¬ä¸€ï¼Œä¸€ä¸ªç‰¹æ®Šçš„å•ç‹¬çš„requireå‡½æ•°è¢«åˆ›é€ ç”¨äºè¿™ä¸ªæ¨¡å—ã€‚è¿™ä¸ªrequireå‡½æ•°å°±æ˜¯æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„é‚£ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åªæ˜¯æŠŠ Module.requireåŒ…è£¹äº†ä¸€ä¸‹ï¼Œå®ƒä¹ŸåŒ…å«äº†ä¸€äº›é²œä¸ºäººçŸ¥çš„å¸®åŠ©æ€§çš„å±æ€§å’Œæ–¹æ³•ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼š require(): åŠ è½½ä¸€ä¸ªå¤–éƒ¨æ¨¡å— require.resolve(): é€šè¿‡è§£æä¸€ä¸ªæ¨¡å—ç»å¯¹è·¯å¾„æ¥ç”Ÿæˆæ¨¡å—çš„name require.main: ä¸»è¦æ¨¡å— require.cache: æ‰€æœ‰æ¨¡å—çš„ç¼“å­˜ require.extensions: æ¯ä¸€ä¸ªæœ‰æ•ˆæ–‡ä»¶çš„ç¼–è¯‘å‡½æ•°éƒ½æ˜¯åŸºäºè¿™ä¸ªæ¥åšæ‰©å±• ä¸€æ—¦requireå®Œæˆäº†ï¼Œæ•´ä¸ªåŠ è½½å¥½çš„æºç ä¼šè¢«åŒ…è£¹åœ¨ä¸€ä¸ªæ–°çš„å‡½æ•°é‡Œé¢ï¼ŒåŒæ—¶ä¼ å…¥require, module, exportså’Œå…¶å¯¹å¤–çš„å˜é‡ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ã€‚è¿™æ ·å°±åˆ›é€ äº†ä¸€ä¸ªæ–°çš„å‡½æ•°ä½œç”¨åŸŸï¼Œè¿™æ ·å¯ä»¥é¿å…æ±¡æŸ“Nodeçš„å…¨å±€ç¯å¢ƒã€‚ 123(function (exports, require, module, __filename, __dirname) &#123; // ä½ çš„ä»£ç ä¼šè¢«æ”¾åœ¨è¿™é‡Œ&#125;); æœ€åï¼Œè¿™ä¸ªåŒ…å«äº†æ¨¡å—çš„å‡½æ•°ä¼šè¢«è¿è¡Œã€‚æ•´ä¸ªModule._compileæ–¹æ³•çš„æ‰§è¡Œæ—¶åŒæ­¥çš„ï¼Œæ‰€ä»¥Module._loadä¼šç­‰å¾…Module._compileæ‰§è¡Œå®Œï¼Œç„¶åä¼šè¿”å›module.exportsç»™ç”¨æˆ·ã€‚ ç»“è®ºè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»çœ‹å®Œäº†requireçš„ä»£ç ï¼Œé€šè¿‡è¿™ä¸€åœˆçš„ä»£ç å°±åˆ›é€ å‡ºäº†æˆ‘ä»¬ä¸€å¼€å§‹æƒ³è¦å»äº†è§£çš„é‚£ä¸ªrequire å‡½æ•°ã€‚ å¦‚æœä½ äº†è§£äº†ä¸Šé¢æ‰€æœ‰çš„å†…å®¹ï¼Œé‚£ä¹ˆä½ å°†ä¼šäº†è§£åˆ°require(&#39;module&#39;)æœ€åçš„ç§˜å¯†ã€‚æ²¡é”™ï¼Œå°±æ˜¯æ¨¡å—ç³»ç»Ÿæœ¬èº«ä¹Ÿå¯ä»¥é€šè¿‡æ¨¡å—ç³»ç»ŸåŠ è½½è¿›æ¥çš„ã€‚ä¸€å¼€å§‹ï¼Œè¿™ä¸ªå¯èƒ½å¬ä¸Šå»æœ‰äº›å¥‡æ€ªï¼Œä½†æ˜¯è¿™æ ·å¯ä»¥è®©ç”¨æˆ·ä¸ç”¨äº†è§£Node.jsçš„æ ¸å¿ƒåŸç†å°±å¯ä»¥ä½¿ç”¨åŠ è½½ç³»ç»ŸåŠ è½½è‡ªå·±çš„æ¨¡å—ã€‚æµè¡Œçš„æ¨¡å—ä¾‹å¦‚mockery and rewireå°±æ˜¯è¿™æ ·æ„å»ºçš„ã€‚ å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„ç»†èŠ‚ï¼Œä½ å¯ä»¥æµè§ˆmodule.jsæºç ã€‚ä½ ä¼šå¾—åˆ°æ›´å¤šçš„ä¿¡æ¯ä¹Ÿä¼šäº†è§£çš„æ›´å¤šï¼Œæˆ‘å°†ä¼šç»™ç¬¬ä¸€ä¸ªå›ç­”å‡ºä»€ä¹ˆæ˜¯â€˜NODE_MODULE_CONTEXTSâ€™å¹¶ä¸”ä¸ºä»€ä¹ˆè¦åŠ ä¸Šè¿™ä¸ªçš„äººåŠ åˆ†ã€‚ [1] module._compileå‡½æ•°åªæ˜¯ç”¨äºè¿è¡ŒJavaScriptæ–‡ä»¶ã€‚JSONæ–‡ä»¶ä¼šç®€å•åœ°é€šè¿‡ JSON.parse()è§£æç„¶åè¿”å›ã€‚ [2] å½“ç„¶è¿™äº›æ¨¡å—éƒ½æ˜¯ç”±ä¸€äº›ç§æœ‰çš„å‡½æ•°æ–¹æ³•æ„å»ºçš„ï¼Œä¾‹å¦‚Module._resolveLookupPaths and Module._findPathã€‚ä½ å¯ä»¥æƒ³ä¸€æƒ³æ˜¯å¦å¯ä»¥æœ‰æ›´å¥½çš„åŠæ³•â€¦ è¯·å¼€å¯ä½ çš„Javascriptç„¶åæµè§ˆ comments powered by Disqus.","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"10 ä¸ªæŠ€å·§ï¼Œè®©ä½ åœ¨2017 å¹´æˆä¸ºæ›´å¥½çš„ Node å¼€å‘è€…","date":"2017-01-27T07:22:17.000Z","path":"2017/01/27/10-tips-to-become-a-better-node-developer/","text":"æœ¬æ–‡æ˜¯ç”±æˆ‘ä»¬çš„å®¢åº§ä½œè€…Azat Mardanå†™çš„ã€‚SitePointå¼•å…¥å®¢åº§å¸–å­çš„ç›®çš„æ˜¯å¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥webç¤¾åŒºé‡Œè‘—åä½œè€…å’Œæ¼”è®²è€…çš„æœ‰è¶£å†…å®¹ã€‚ åœ¨2012å¹´ï¼Œæˆ‘åŠ å…¥äº†Storifyå¹¶å¼€å§‹ä½¿ç”¨Nodeä½œä¸ºæˆ‘çš„ä¸»è¦è¯­è¨€ã€‚ä»é‚£ä»¥åï¼Œæˆ‘ä»æœªå›é¦–è¿‡å»å¹¶è§‰å¾—æˆ‘é”™è¿‡äº†Pythonï¼ŒRubyï¼ŒJavaä»¥åŠPHPï¼Œè¿™äº›åœ¨è¿‡å»10å¹´é‡Œï¼Œæˆ‘åœ¨webå¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„è¯­è¨€ã€‚ Storifyæä¾›ç»™æˆ‘ä¸€ä¸ªå¾ˆæœ‰è¶£çš„å·¥ä½œï¼Œå› ä¸ºStorifyå’Œå…¶ä»–çš„å…¬å¸ä¸å¤ªä¸€æ ·ï¼ŒStorifyä¹‹å‰ï¼ˆå¯èƒ½åˆ°ç°åœ¨ä¹Ÿæ˜¯ï¼‰æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯ç”±JavaScriptç¼–å†™çš„ã€‚è€Œå¤§å¤šæ•°å…¬å¸ï¼Œç‰¹åˆ«æ˜¯å¤§å…¬å¸ï¼Œä¾‹å¦‚PayPalï¼ŒWalmart(æ²ƒå°”ç›)æˆ–è€…Capital One(ç¬¬ä¸€èµ„æœ¬)ï¼Œåªæ˜¯åœ¨æŸä¸€äº›ç‰¹å®šçš„éƒ¨åˆ†ä½¿ç”¨äº†Nodeã€‚é€šå¸¸ï¼Œä»–ä»¬ä½¿ç”¨Nodeä½œä¸ºAPIæ¥å£æˆ–è€…ç”¨åœ¨ä¸šåŠ¡æµç¨‹å±‚ï¼Œè¿™æ ·åšæ˜¯å¾ˆå¥½çš„ã€‚ä½†æ˜¯ä½œä¸ºä¸€ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œæ²¡ä»€ä¹ˆæ¯”å¾—ä¸Šèƒ½å¤Ÿå®Œå…¨æ²‰æµ¸åœ¨Nodeç¯å¢ƒé‡Œã€‚ ä¸‹é¢æˆ‘å°†åˆ—å‡º10æ¡å»ºè®®ï¼Œè¿™äº›å»ºè®®å¯ä»¥å¸®åŠ©ä½ åœ¨2017å¹´æˆä¸ºä¸€ä¸ªæ›´å¥½çš„Nodeå¼€å‘è€…ã€‚å…¶ä¸­ä¸€äº›å»ºè®®æ˜¯æˆ‘åœ¨æ—¥å¸¸å®è·µä¸­æ‰€å­¦åˆ°çš„ï¼Œå¦ä¸€äº›æ˜¯ä»é‚£äº›å†™äº†æœ€æµè¡Œçš„Nodeå’Œnpmæ¨¡å—çš„äººä»¬èº«ä¸Šå­¦åˆ°çš„ã€‚ ä¸‹é¢æ˜¯æˆ‘ä»¬å°†è¦ä»‹ç»çš„å†…å®¹ï¼š é¿å…å¤æ‚æ€§ â€” å°½å¯èƒ½å°†ä½ çš„ä»£ç å—æ‹†åˆ°æœ€å°ï¼Œè¦å°åˆ°æè‡´ã€‚ ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ â€” åƒèº²é¿ç˜Ÿç–«èˆ¬é¿å…ä½¿ç”¨åŒæ­¥ä»£ç ã€‚ é¿å…requireé˜»å¡ â€” æŠŠä½ æ‰€æœ‰çš„requireå£°æ˜éƒ½æ”¾åœ¨æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œå› ä¸ºrequireæ˜¯åŒæ­¥çš„ï¼Œä¼šé˜»å¡ä»£ç è¿è¡Œã€‚ äº†è§£requireç¼“å­˜ â€” äº†è§£å®ƒåˆ™å¯ä»¥åˆ©ç”¨å®ƒï¼Œå¦åˆ™å®ƒå¯èƒ½ä¼šå¸¦æ¥bugã€‚ å§‹ç»ˆæ£€æŸ¥é”™è¯¯ â€” é”™è¯¯ä¸æ˜¯è¶³çƒï¼Œä»»ä½•æ—¶å€™éƒ½ä¸è¦æŠ›å‡ºé”™è¯¯æˆ–è€…è·³è¿‡é”™è¯¯æ£€æŸ¥ã€‚ åªåœ¨åŒæ­¥ä»£ç ä¸­ä½¿ç”¨tryâ€¦catch â€” åœ¨å¼‚æ­¥ä»£ç ä¸­try...catchæ˜¯æ²¡æœ‰ä½œç”¨çš„ã€‚V8å¼•æ“é’ˆå¯¹try...catchæ— æ³•è¿›è¡Œä¼˜åŒ–ã€‚ è¿”å›callbacksæˆ–è€…ä½¿ç”¨if â€¦ else â€” è¿”å›ä¸€ä¸ªcallbackåªæ˜¯ä¸ºäº†ç¡®ä¿ä¸ç»§ç»­æ‰§è¡Œã€‚ ç›‘å¬é”™è¯¯äº‹ä»¶ â€” å‡ ä¹æ‰€æœ‰çš„Nodeçš„ç±»/å¯¹è±¡éƒ½æœ‰event emitter(è§‚å¯Ÿè€…æ¨¡å¼)å¹¶ä¸”ä¼šå¹¿æ’­erroräº‹ä»¶ï¼Œç¡®ä¿ä½ ç›‘å¬äº†å®ƒä»¬ã€‚ äº†è§£ä½ çš„npm â€” ä½¿ç”¨-Sæˆ–è€…-Dæ¥å®‰è£…æ¨¡å—æ¥ä»£æ›¿--saveæˆ–è€…â€“save-dev`ã€‚ åœ¨package.jsonä¸­ä½¿ç”¨ç²¾ç¡®çš„ç‰ˆæœ¬å·: npmåœ¨ä½¿ç”¨-Sæ¥å®‰è£…æ¨¡å—æ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤çš„ç‰ˆæœ¬å·ï¼Œä½ éœ€è¦æ‰‹åŠ¨ä¿®æ”¹å»é”å®šç‰ˆæœ¬å·ã€‚é™¤éæ˜¯å¼€æºæ¨¡å—ï¼Œå¦è€…ä¸è¦ç›¸ä¿¡ä½ çš„é¡¹ç›®ä¸­çš„SemVerï¼ˆè¯­ä¹‰åŒ–ç‰ˆæœ¬æ ‡å‡†ï¼‰ã€‚ åŠ åˆ† â€” ä½¿ç”¨ä¸åŒçš„ä¾èµ–ã€‚æŠŠé¡¹ç›®åœ¨å¼€å‘é˜¶æ®µéœ€è¦çš„ä¸œè¥¿æ”¾åœ¨ devDependencies ä¸­ï¼Œè®°å¾—ä½¿ç”¨ npm i â€“productionã€‚å¤šä½™çš„ä¾èµ–è¶Šå¤šï¼Œå‡ºç°é—®é¢˜çš„é£é™©å°±è¶Šå¤§ã€‚ å¥½çš„ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¸€ä¸ªä¸ªå•ç‹¬åœ°å»äº†è§£ä¸Šé¢çš„æ¯ä¸€ç‚¹ã€‚ é¿å…å¤æ‚æ€§è®©æˆ‘çœ‹ä¸€çœ¼npmçš„åˆ›é€ è€…Isaac Z. Schlueterå†™çš„ä¸€äº›æ¨¡å—ï¼Œä¾‹å¦‚ï¼Œuse-strictï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ç”¨æ¥åœ¨Javascriptä¸­å¼ºåˆ¶ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å—ä»…ä»…åªæœ‰ä¸‰è¡Œä»£ç ï¼š 123var module = require(&apos;module&apos;)module.wrapper[0] += &apos;&quot;use strict&quot;;&apos;Object.freeze(module.wrap) æ‰€ä»¥æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦é¿å…å¤æ‚æ€§å‘¢? ä¸€ä¸ªèµ·æºäºç¾å›½æµ·å†›çš„è‘—åçŸ­è¯­:KEEP IT SIMPLE STUPID(æˆ–è€…æ˜¯â€œKeep it simple, stupidâ€)ã€‚è¿™å°±æ˜¯åŸå› ã€‚äº‹å®è¯´æ˜ï¼Œäººç±»å¤§è„‘åœ¨ä»»ä½•ä¸€ä¸ªæ—¶é—´åªèƒ½åœ¨å…¶å·¥ä½œè®°å¿†ä¸­ä¿æŒäº”åˆ°ä¸ƒä¸ªé¡¹ç›®ã€‚ æŠŠä½ çš„ä»£ç æ¨¡å—åŒ–æˆä¸€ä¸ªæ›´åŠ å°çš„éƒ¨åˆ†ï¼Œä½ å’Œå…¶ä»–çš„å¼€å‘è€…ä¼šæ›´åŠ å¥½çš„ç†è§£å®ƒã€‚ä½ ä¹Ÿå¯ä»¥æ›´åŠ å¥½çš„å»æµ‹è¯•å®ƒã€‚å¦‚ä¸‹ä¾‹å­ï¼Œ 1234567app.use(function(req, res, next) &#123; if (req.session.admin === true) return next() else return next(new Error(&apos;Not authorized&apos;))&#125;, function(req, res, next) &#123; req.db = db next()&#125;) æˆ–è€…æ˜¯ 1234const auth = require(&apos;./middleware/auth.js&apos;)const db = require(&apos;./middleware/db.js&apos;)(db)app.use(auth, db) æˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¼šå–œæ¬¢ç¬¬äºŒä¸ªä¾‹å­ï¼Œç‰¹åˆ«æ˜¯å…‰çœ‹åå­—å°±èƒ½äº†è§£å…¶ä½œç”¨ã€‚å½“æ—¥ï¼Œåœ¨ä½ ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œä½ å¯èƒ½è®¤ä¸ºä½ çŸ¥é“ä»£ç æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚ç”šè‡³ä½ æƒ³è¦å±•ç¤ºä½ æŠŠå‡ ä¸ªåŠŸèƒ½è¿æ¥åœ¨ä¸€èµ·å†™åœ¨åŒä¸€è¡Œä¸­æ˜¯å¤šä¹ˆçš„æœºæ™ºã€‚ä½†æ˜¯ï¼Œè¿™æ ·ä½ æ˜¯å†™äº†ä¸€æ®µæ„šè ¢çš„ä»£ç ã€‚å¦‚æœä½ æ€è€ƒçš„å¾ˆå¤æ‚å»å†™è¿™ä»£ç ï¼Œé‚£ä¹ˆä»Šåä½ å†å»çœ‹è¿™æ®µä»£ç å°†ä¼šå¾ˆéš¾å»ç†è§£ã€‚ä¿è¯ä½ çš„ä»£ç ç®€å•ï¼Œç‰¹åˆ«æ˜¯åœ¨Nodeçš„å¼‚æ­¥ä»£ç ä¸­ã€‚ å½“ç„¶ä¹Ÿä¼šæœ‰left-pad äº‹ä»¶ï¼Œä½†æ˜¯å…¶å®å®ƒåªæ˜¯å½±å“äº†ä¾èµ–äºleft-padæ¨¡å—çš„é¡¹ç›®è€Œä¸”11åˆ†é’Ÿåå°±å‘å¸ƒäº†æ›¿ä»£å“ã€‚ä»£ç çš„æœ€å°åŒ–å¸¦æ¥çš„å¥½å¤„è¶…è¿‡äº†å®ƒçš„ç¼ºç‚¹ã€‚npmå·²ç»æ”¹å˜äº†å‘å¸ƒç­–ç•¥,ä»»ä½•é‡è¦çš„é¡¹ç›®éƒ½åº”è¯¥ä½¿ç”¨ç¼“å­˜æˆ–ç§æœ‰çš„æºï¼ˆä½œä¸ºä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼‰ã€‚ ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹åœ¨Nodeä¸­åŒæ­¥ä»£ç åªè¦å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚è¿™äº›ä»£ç å¤§å¤šæ•°éƒ½æ˜¯ç”¨äºå‘½ä»¤è¡Œå·¥å…·æˆ–è€…å…¶ä»–ä¸webåº”ç”¨æ— å…³çš„è„šæœ¬ã€‚Nodeå¼€å‘è€…å¤§å¤šæ•°éƒ½æ˜¯ç¼–å†™webåº”ç”¨ï¼Œå› æ­¤ä½¿ç”¨å¼‚æ­¥ä»£ç å¯ä»¥é¿å…é˜»å¡ç°åœºã€‚ ä¾‹å¦‚ï¼Œå½“ä½ åœ¨ç¼–å†™ä¸€ä¸ªæ•°æ®åº“çš„è„šæœ¬æˆ–è€…æ˜¯ä¸€ä¸ªä¸éœ€è¦æ§åˆ¶å¹¶è¡Œçš„ä»»åŠ¡æ—¶ï¼Œä¸‹é¢è¿™ç§å†™æ³•å¯èƒ½æ˜¯å¯ä»¥çš„ï¼š 1234let data = fs.readFileSync(&apos;./acconts.json&apos;)db.collection(&apos;accounts&apos;).insert(data, (results))=&gt;&#123; fs.writeFileSync(&apos;./accountIDs.json&apos;, results, ()=&gt;&#123;process.exit(1)&#125;)&#125;) ä½†æ˜¯å½“ä½ åˆ›å»ºä¸€ä¸ªwebåº”ç”¨æ—¶ï¼Œä¸‹é¢è¿™ä¸ªå†™æ³•ä¼šæ›´å¥½ï¼š 1234567app.use(&apos;/seed/:name&apos;, (req, res) =&gt; &#123; let data = fs.readFile(`./$&#123;req.params.name&#125;.json`, ()=&gt;&#123; db.collection(req.params.name).insert(data, (results))=&gt;&#123; fs.writeFile(`./$&#123;req.params.name&#125;IDs.json`, results, ()=&#123;res.status(201).send()&#125;) &#125;) &#125;)&#125;) è¿™ä¸ªåŒºåˆ«åœ¨äºä½ æ˜¯å¦éœ€è¦ç¼–å†™ä¸€ä¸ªå¹¶å‘ï¼ˆé€šå¸¸æ˜¯é•¿æœŸè¿è¡Œï¼‰æˆ–è€…éå¹¶å‘ï¼ˆçŸ­æœŸè¿è¡Œï¼‰çš„ç³»ç»Ÿã€‚æ ¹æ®ç»éªŒæ¥è¯´ï¼Œæ€»æ˜¯è¦åœ¨Nodeä¸­ä½¿ç”¨å¼‚æ­¥ä»£ç ã€‚ é¿å…requireé˜»å¡Nodeæœ‰ä¸€ä¸ªä½¿ç”¨äº†CommonJSæ¨¡å—æ ¼å¼çš„ç®€å•çš„æ¨¡å—åŠ è½½ç³»ç»Ÿã€‚å®ƒæ˜¯åŸºäºrequireå‡½æ•°ï¼Œrequireå‡½æ•°å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­å¼•å…¥æ¨¡å—ã€‚å’ŒAMD/requirejsä¸åŒï¼ŒNode/CommonJSçš„æ¨¡å—åŠ è½½æ—¶åŒæ­¥çš„ã€‚requireçš„å·¥ä½œæ–¹å¼æ˜¯ï¼šå¼•å…¥ä¸€ä¸ªæ¨¡å—æˆ–è€…ä¸€ä¸ªæ–‡ä»¶exportçš„å†…å®¹: 1`const react = require(&apos;react&apos;)` ä½†æ˜¯å¤§å¤šæ•°çš„å¼€å‘è€…å¹¶ä¸çŸ¥é“requireæ˜¯ä¼šè¢«ç¼“å­˜çš„ã€‚å› æ­¤ï¼Œåªè¦è§£æçš„æ–‡ä»¶åï¼ˆresolved filenameï¼‰æ²¡æœ‰å‰§çƒˆçš„å˜åŒ–ï¼ˆæ¯”å¦‚npmæ¨¡å—ä¸å­˜åœ¨çš„æƒ…å†µï¼‰ï¼Œæ¨¡å—çš„ä»£ç åªä¼šè¢«æ‰§è¡Œå¹¶å­˜å…¥å˜é‡ä¸­ä¸€æ¬¡ï¼ˆåœ¨å½“å‰è¿›ç¨‹ä¸­ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¼˜åŒ–ã€‚å½“ç„¶ï¼Œå³ä½¿æœ‰äº†ç¼“å­˜ï¼Œä½ æœ€å¥½è¿˜æ˜¯æŠŠä½ çš„requireå£°æ˜å†™åœ¨å¼€å¤´ã€‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œå®ƒåœ¨è·¯ç”±ä¸­çœŸæ­£ä½¿ç”¨åˆ°äº†axiosæ¨¡å—çš„æ—¶å€™æ‰åŠ è½½ã€‚å½“è¯·æ±‚å‘é€çš„æ—¶å€™/connectä¼šå› ä¸ºéœ€è¦åŠ è½½æ¨¡å—æ‰€ä»¥ä¼šå˜å¾—æ…¢ã€‚ 12345app.post(&apos;/connect&apos;, (req, res) =&gt; &#123; const axios = require(&apos;axios&apos;) axios.post(&apos;/api/authorize&apos;, req.body.auth) .then((response)=&gt;res.send(response))&#125;) ä¸€ä¸ªæ›´å¥½ï¼Œæ€§èƒ½æ›´ä¼˜çš„æ–¹å¼æ˜¯åœ¨æœåŠ¡å®šä¹‰ä¹‹å‰å°±å¼•å…¥æ¨¡å—è€Œä¸æ˜¯åœ¨è·¯ç”±ä¸­: 1234567const axios = require(&apos;axios&apos;)const express = require(&apos;express&apos;)app = express()app.post(&apos;/connect&apos;, (req, res) =&gt; &#123; axios.post(&apos;/api/authorize&apos;, req.body.auth) .then((response)=&gt;res.send(response))&#125;) çŸ¥é“requireä¼šè¢«ç¼“å­˜æˆ‘åœ¨ä¸Šé¢ä¸€èŠ‚å·²ç»æåˆ°äº†requireä¼šè¢«ç¼“å­˜ï¼Œä½†æ˜¯æœ‰è¶£çš„æ˜¯æˆ‘ä»¬åœ¨module.exportsä¹‹å¤–ä¹Ÿä¼šæœ‰ä»£ç ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š 12345console.log(&apos;I will not be cached and only run once, the first time&apos;)module.exports = () =&gt; &#123; console.log(&apos;I will be cached and will run every time this module is invoked&apos;)&#125; ä»ä¸­æˆ‘ä»¬äº†è§£åˆ°æœ‰ä¸€äº›ä»£ç åªä¼šè¿è¡Œä¸€æ¬¡ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§æ¥ä¼˜åŒ–ä½ çš„ä»£ç ã€‚ å§‹ç»ˆæ£€æŸ¥é”™è¯¯Nodeä¸æ˜¯Javaã€‚åœ¨Javaä¸­ï¼Œä½ å¯ä»¥æŠ›å‡ºé”™è¯¯ï¼Œå› ä¸ºå¦‚æœå‘ç”Ÿäº†é”™è¯¯é‚£ä¹ˆä½ ä¼šå¸Œæœ›åº”ç”¨ä¸åœ¨ç»§ç»­æ‰§è¡Œã€‚åœ¨Javaä¸­ï¼Œä½ å¯ä»¥åœ¨å¤–å±‚ä»…ä»…ä½¿ç”¨ä¸€ä¸ªç®€å•çš„try...catchå°±å¯ä»¥å¤„ç†å¤šä¸ªé”™è¯¯ã€‚ ä½†æ˜¯åœ¨Nodeä¸­å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚è‡ªä»Nodeä½¿ç”¨äº†äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥æ‰§è¡Œåï¼Œä»»ä½•çš„é”™è¯¯å‘ç”Ÿæ—¶éƒ½ä¼šä¸é”™è¯¯å¤„ç†å™¨ï¼ˆä¾‹å¦‚try...catchï¼‰çš„ä¸Šä¸‹æ–‡åˆ†ç¦»ï¼Œä¸‹é¢è¿™æ ·åšåœ¨Nodeä¸­æ˜¯æ²¡æœ‰ç”¨çš„ï¼š 12345678try &#123; request.get(&apos;/accounts&apos;, (error, response)=&gt;&#123; data = JSON.parse(response) &#125;)&#125; catch(error) &#123; // Will NOT be called console.error(error)&#125; ä½†æ˜¯try...catchåœ¨åŒæ­¥ä»£ç ä¸­æ˜¯å¯ä»¥è¢«ç”¨çš„ã€‚å‰é¢çš„ä»£ç ç‰‡æ®µå¯ä»¥è¢«æ›´å¥½çš„é‡æ„ä¸ºï¼š 12345678request.get(&apos;/accounts&apos;, (error, response)=&gt;&#123; try &#123; data = JSON.parse(response) &#125; catch(error) &#123; // Will be called console.error(error) &#125;&#125;) å¦‚æœæˆ‘ä»¬æ— æ³•å°†requestçš„è¿”å›å†…å®¹åŒ…è£¹åœ¨try...catchä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ²¡æœ‰åŠæ³•å»å¤„ç†è¯·æ±‚çš„é”™è¯¯ã€‚Nodeçš„å¼€å‘è€…é€šè¿‡åœ¨è¿”å›çš„å‚æ•°é‡Œé¢åŠ ä¸Šerroræ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸€ä¸ªå›è°ƒä¸­æ‰‹åŠ¨å»å¤„ç†é”™è¯¯ã€‚ä½ å¯ä»¥å»æ£€æŸ¥è¿™äº›é”™è¯¯ï¼ˆåˆ¤æ–­errorä¸æ˜¯nullï¼‰,ç„¶åå±•ç¤ºé”™è¯¯ä¿¡æ¯ç»™ç”¨æˆ·æˆ–è€…å±•ç¤ºåœ¨å®¢æˆ·ç«¯ä¸Šå¹¶ä¸”è®°å½•å®ƒï¼Œ æˆ–è€…ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ callback ï¼Œç»™å®ƒä¼  error å‚æ•°ï¼Œå°†é”™è¯¯ä¼ å›ç»™ä¸Šä¸€çº§è°ƒç”¨æ ˆï¼ˆå¦‚æœä½ åœ¨è°ƒç”¨æ ˆä¹‹ä¸Šæœ‰å¦ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼‰ã€‚ 12345678request.get(&apos;/accounts&apos;, (error, response)=&gt;&#123; if (error) return console.error(error) try &#123; data = JSON.parse(response) &#125; catch(error) &#123; console.error(error) &#125;&#125;) ä¸€ä¸ªå°æŠ€å·§æ˜¯ä½ å¯ä»¥ä½¿ç”¨okayåº“ã€‚ä½ å¯ä»¥åƒä¸‹é¢çš„ä¾‹å­ä¸€æ ·ä½¿ç”¨å®ƒå»é¿å…åœ¨å›è°ƒåœ°ç‹±ä¸­æ‰‹åŠ¨å»æ£€æŸ¥é”™è¯¯(ä½ å¥½, å›è°ƒåœ°ç‹±). 123456789var ok = require(&apos;okay&apos;)request.get(&apos;/accounts&apos;, ok(console.error, (response)=&gt;&#123; try &#123; data = JSON.parse(response) &#125; catch(error) &#123; console.error(error) &#125;&#125;)) è¿”å›å›è°ƒæˆ–è€…ä½¿ç”¨if â€¦ elseNodeæ˜¯å¹¶è¡Œçš„ã€‚ä½†æ˜¯å¦‚æœä½ ä¸å¤Ÿç»†å¿ƒä¹Ÿä¼šå› ä¸ºè¿™ä¸ªç‰¹æ€§äº§ç”Ÿbugã€‚ ä¸ºäº†å®‰å…¨èµ·è§ï¼Œåº”è¯¥è¦ä½¿ç”¨returnæ¥ç»ˆæ­¢ä»£ç çš„ç»§ç»­æ‰§è¡Œï¼š 123let error = trueif (error) return callback(error)console.log(&apos;I will never run - good.&apos;) è¿™æ ·å¯ä»¥é¿å…ä¸€äº›å› ä¸ºä»£ç é€»è¾‘çš„å¤„ç†ä¸å½“å¯¼è‡´ä¸€äº›ä¸åº”è¯¥æ‰§è¡Œçš„å†…å®¹ï¼ˆæˆ–è€…é”™è¯¯ï¼‰è¢«æ‰§è¡Œã€‚ 123let error = trueif (error) callback(error)console.log(&apos;I will run. Not good!&apos;) è¯·ç¡®ä¿ä½¿ç”¨returnå»é˜»æ­¢ä»£ç çš„ç»§ç»­æ‰§è¡Œã€‚ ç›‘å¬ error äº‹ä»¶Nodeä¸­å‡ ä¹æ‰€æœ‰çš„ç±»/å¯¹è±¡éƒ½æœ‰äº‹ä»¶åˆ†å‘å™¨ï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰å¹¶ä¸”ä¼šå¹¿æ’­ error äº‹ä»¶ã€‚ è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œå¯ä»¥ä½¿å¼€å‘è€…åœ¨è¿™äº›è®¨åŒçš„é”™è¯¯é€ æˆå·¨å¤§åæœä¹‹å‰æ•æ‰åˆ°å®ƒä»¬ã€‚ å…»æˆä¸€ä¸ªé€šè¿‡.on()æ¥åˆ›å»ºerroräº‹ä»¶ç›‘å¬çš„å¥½ä¹ æƒ¯ï¼š 123456789101112var req = http.request(options, (res) =&gt; &#123; if ((&apos;&apos; + res.statusCode).match(/^2\\d\\d$/)) &#123; // Success, process response &#125; else if ((&apos;&apos; + res.statusCode).match(/^5\\d\\d$/)) // Server error, not the same as req error. Req was ok. &#125;&#125;)req.on(&apos;error&apos;, (error) =&gt; &#123; // Can&apos;t even make a request: general error, e.g. ECONNRESET, ECONNREFUSED, HPE_INVALID_VERSION console.log(error)&#125;) äº†è§£ä½ çš„npmå¾ˆå¤šçš„Nodeå’Œå‰ç«¯çš„å¼€å‘è€…çŸ¥é“åœ¨å®‰è£…æ¨¡å—çš„æ—¶å€™ä½¿ç”¨--saveä¼šåœ¨å®‰è£…æ¨¡å—çš„åŒæ—¶ï¼Œä¼šåœ¨package.jsonä¿å­˜ä¸€æ¡å«æœ‰æ¨¡å—ç‰ˆæœ¬ä¿¡æ¯çš„æ¡ç›®ã€‚å½“ç„¶ï¼Œè¿˜æœ‰--save-devå¯ä»¥ç”¨äºå®‰è£…devDependencies(åœ¨ç”Ÿæˆç¯å¢ƒä¸­ä¸éœ€è¦çš„æ¨¡å—)ã€‚ä½†æ˜¯ä½ çŸ¥é“ç”¨-Så’Œ-Dæ˜¯å¦å¯ä»¥ä»£æ›¿--save å’Œ--save-devä¹ˆï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚ å½“ä½ å®‰è£…æ¨¡å—çš„æ—¶å€™ï¼Œä½ éœ€è¦åˆ é™¤-Så’Œ-Dè‡ªåŠ¨ä¸ºä½ æ¨¡å—çš„ç‰ˆæœ¬å·æ·»åŠ çš„^æ ‡ç­¾ã€‚å¦è€…å½“ä½ ä½¿ç”¨npm installï¼ˆæˆ–è€…npm iï¼‰å®‰è£…æ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨æ‹‰å–æœ€æ–°çš„é•œåƒï¼ˆç‰ˆæœ¬å·çš„ç¬¬äºŒä½æ•°å­—ï¼‰ã€‚ä¾‹å¦‚v6.1.0å°±æ˜¯v6.2.0çš„ä¸€ä¸ªé•œåƒåˆ†æ”¯ã€‚ npmå›¢é˜Ÿæ¨èä½¿ç”¨semverï¼Œä½†æ˜¯ä½ æœ€å¥½ä¸è¦è¿™æ ·ã€‚npmå›¢é˜Ÿè®¤ä¸ºå¼€æºå¼€å‘è€…ä¼šéµå®ˆsemveræ‰€ä»¥ä»–ä»¬åœ¨npmå®‰è£…æ—¶è‡ªåŠ¨åŠ ä¸Šäº†^ã€‚æ²¡æœ‰äººå¯ä»¥å»ä¿è¯ï¼Œæ‰€ä»¥æœ€å¥½æ˜¯é”å®šä½ çš„ç‰ˆæœ¬å·ã€‚æ›´å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨shrinkwrapï¼šnpm shrinkwrapä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«ä¾èµ–çš„å…·ä½“ç‰ˆæœ¬çš„æ–‡ä»¶ã€‚ ç»“æŸè¯­è¿™ç¯‡æ–‡ç« æ˜¯ä¸¤éƒ¨åˆ†çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»æåˆ°äº†å¾ˆå¤šæ–¹é¢ï¼Œä»ä½¿ç”¨callbackså’Œå¼‚æ­¥ä»£ç ï¼Œåˆ°æ ¸æŸ¥é”™è¯¯å’Œé”å®šä¾èµ–ã€‚å¸Œæœ›ä½ ä»¬å¯ä»¥ä»ä¸­å­¦ä¹ åˆ°ä¸€äº›æ–°çš„ï¼Œæˆ–è€…æœ‰ç”¨çš„ä¿¡æ¯ã€‚æ•¬è¯·æœŸå¾…å³å°†æ¨å‡ºçš„ç¬¬äºŒéƒ¨åˆ†ã€‚ åŒæ—¶ï¼Œå‘Šè¯‰æˆ‘ä½ çš„æƒ³æ³•ã€‚æˆ‘æ˜¯å¦é—æ¼äº†ä»€ä¹ˆï¼Ÿä½ æ˜¯å¦æœ‰ä¸ä¸€æ ·çš„åšæ³•ï¼Ÿåœ¨ä¸‹é¢çš„è¯„è®ºåŒºå‘Šè¯‰æˆ‘ä½ çš„æƒ³æ³•å§ã€‚","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"newåˆ°åº•åšäº†ä»€ä¹ˆ","date":"2017-01-27T07:20:49.000Z","path":"2017/01/27/new-working/","text":"åœ¨Javscriptä¸­ï¼Œæˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™éƒ½ä¼šä½¿ç”¨ç±»ä¼¼çš„ä»£ç  1var coder = new Man() é‚£ä¹ˆåœ¨newçš„æ—¶å€™ï¼Œnewåˆ°åº•åšäº†ä»€ä¹ˆå‘¢ï¼Œå…¶å®å¾ˆç®€å•ï¼Œnewçš„ä½œç”¨ï¼Œå°±æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç„¶åå°†æ–°å¯¹è±¡çš„protoé“¾æ¥åˆ°ç±»çš„prototypeï¼Œæœ€åé€šè¿‡å°†æ–°å¯¹è±¡ä½œä¸ºä¸Šä¸‹æ–‡ï¼ˆthisï¼‰ï¼Œè°ƒç”¨callæ¥æ‰§è¡Œç±»çš„æ„é€ å‡½æ•°ã€‚å®ç°ä»£ç å¦‚ä¸‹ 123var coder = &#123;&#125;;coder.__proto__ = Man.prototypeMan.call(coder) å…·ä½“å¯ä»¥æŸ¥çœ‹MDNçš„æ–‡æ¡£newè¿ç®—ç¬¦","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"å¼€å‘æ¨è macä¸­å¥½ç”¨çš„è½¯ä»¶","date":"2017-01-27T07:19:30.000Z","path":"2017/01/27/mac-software/","text":"è¿™é‡Œåªæ˜¯æˆ‘ä¸ªäººç”¨åˆ°çš„ä¸€äº›æ¯”è¾ƒå¥½ç”¨çš„è½¯ä»¶ï¼Œæœ¬äººæ˜¯å‰ç«¯å¼€å‘ï¼Œæ‰€ä»¥åå‰ç«¯çš„è½¯ä»¶å¯èƒ½å¤šä¸€äº›ï¼Œä¸å–œå‹¿å–·å“¦ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶å¯ä»¥æ¨èå¥½çš„è½¯ä»¶ç»™æˆ‘ã€‚ sublimeä¸çŸ¥é“è¯¥ä»å“ªä¸ªè½¯ä»¶å¼€å§‹å†™èµ·ï¼Œåæ¥ä¸€æƒ³è¿˜æ˜¯ä»è‡ªå·±æœ€å¸¸ç”¨çš„è½¯ä»¶å¼€å§‹å§ sublimeä½œä¸ºä¸€ä¸ªè½»é‡çº§çš„ideï¼Œæ€§èƒ½å¾ˆä¼˜ç§€ï¼ŒåŸºæœ¬ä»€ä¹ˆé…ç½®çš„ç”µè„‘éƒ½å¯ä»¥æµç•…ä½¿ç”¨ï¼Œéšç€sublime2åˆ°sublime3ï¼Œä¸ç®¡ä½ éœ€è¦ä»€ä¹ˆæ ·çš„æ’ä»¶éƒ½å¯ä»¥æ‰¾çš„åˆ°ã€‚ Parallers Desktop ä¸ªäººè®¤ä¸ºmacä¸Šæœ€å¥½çš„è™šæ‹Ÿæœºï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚ç¬¬ä¸€æ¬¡ä½¿ç”¨Parallersçš„èåˆæ¨¡å¼ï¼Œç¡®å®æ˜¯æƒŠè‰³åˆ°æˆ‘äº†ï¼Œè™šæ‹Ÿæœºå±…ç„¶å¯ä»¥è¿™ç§åœ°æ­¥ï¼Œä¸€ç›´ä»¥ä¸ºè™šæ‹Ÿæœºå°±æ˜¯åœ¨ä¸€ä¸ªçª—å£ä¸­ï¼Œç„¶ååœ¨è¿™ä¸ªçª—å£å†…ä½¿ç”¨ã€‚Parallerså¯ä»¥ä½¿ä½ ä½¿ç”¨å…¶ä»–å¹³å°çš„è½¯ä»¶åƒæ˜¯åœ¨ä½¿ç”¨macä¸Šè½¯ä»¶ï¼Œå”¯ä¸€çš„é—®é¢˜å°±æ˜¯windowä¸Šçš„å¹¿å‘Šå’Œé€šçŸ¥ä¹Ÿæ˜¾ç¤ºåœ¨macä¸Šäº†ï¼Œæ„Ÿè§‰æ€ªæ€ªçš„,å¦å¤–Parallersç°åœ¨å¥½åƒéƒ½è¦æ”¶è´¹äº†ï¼Œè€Œä¸”è¿˜æŒºè´µçš„ï¼Œä¸è¿‡ç¡®å®ç‰©è¶…æ‰€å€¼ã€‚ Dashå¼€å‘å¾€å¾€ä¼šé‡åˆ°å¾ˆå¤šçš„ç±»åº“ï¼Œç”¨åˆ°çš„æ—¶å€™æ€»ä¼šéœ€è¦æŸ¥è¯¢ä¸€äº›æ–‡æ¡£ï¼Œä¸€ä¸ªä¸ªå»æ‰¾å¤ªéº»çƒ¦äº†ï¼Œdashå¯ä»¥æŠŠæ–‡æ¡£ä¸‹è½½ä¸‹æ¥ï¼Œè€Œä¸”å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŸ¥è¯¢æ–‡æ¡£ï¼Œè€Œä¸”dashå¯ä»¥å’Œå¤§å¤šæ•°ideå¯¹æ¥ï¼Œåªéœ€è¦é€‰ä¸­ä½ æƒ³è¦æŸ¥è¯¢çš„å‡½æ•°ï¼ŒåŠ ä¸Šå¿«æ·é”®å°±å¯ä»¥ç›´æ¥åœ¨dashä¸­æŸ¥è¯¢åˆ°å¯¹åº”å‡½æ•°çš„è¯´æ˜ï¼Œå¯ä»¥æäº¤å¼€å‘çš„æ•ˆç‡ã€‚å¦å¤–ç½‘è·¯ä¸å¥½çš„æƒ…å†µä¸‹ï¼Œç¦»çº¿çš„æ–‡æ¡£æœ‰æ—¶å€™å¯ä»¥å¸®ä½ è§£å†³å¾ˆå¤šé—®é¢˜ã€‚ *","tags":[{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"http://wangyuekai.com/tags/è½¯ä»¶/"}]},{"title":"class in ES6","date":"2017-01-27T07:18:42.000Z","path":"2017/01/27/class-in-ES6/","text":"åœ¨es6å‡ºæ¥ä¹‹åï¼Œæˆ‘ä»¬çœ‹åˆ°jsç»ˆäºæœ‰classè¿™ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºæˆ‘ä»¬ç»ˆäºå¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ç±»äº†ã€‚é‚£ä¹ˆes6çš„ç±»å’Œä¹‹å‰çš„æˆ‘ä»¬ä½¿ç”¨åŸå‹é“¾ç»§æ‰¿å®ç°çš„ç±»æœ‰ä»€ä¹ˆè”ç³»ä¹ˆã€‚ ç­”æ¡ˆæ˜¯ä¸€æ¨¡ä¸€æ · JavaScript classes introduced in ECMAScript 2015 are syntactical sugar over JavaScriptâ€™s existing prototype-based inheritance. (åœ¨ ECMAScript 6 å¼•å…¥çš„ JavaScript ç±»ï¼ˆclassï¼‰æ˜¯ JavaScript ç°æœ‰çš„åŸå‹ç»§æ‰¿çš„è¯­æ³•ç³–ã€‚) â€”â€” MDN Classes å¥½å§ï¼Œé‚£ä¹ˆä¸ºäº†ä½¿æˆ‘ä»¬æ›´å¥½çš„ç†è§£es6çš„classï¼Œä¹Ÿæ˜¯å€’è¿‡æ¥æ›´å¥½çš„ç†è§£jsçš„åŸå‹é“¾ï¼Œä¸‹é¢æˆ‘ä»¬æŠŠç±»çš„es6å†™æ³•å’ŒåŸå‹é“¾å®ç°çš„å†™æ³•ä¸€ä¸€åˆ—å‡º ###ç±»çš„åˆ›å»ºï¼Œç±»çš„æ„é€ å™¨å’ŒåŸå‹æ–¹æ³•ES61234567891011121314class Polygon &#123; constructor(height, width) &#123; this.height = height; this.width = width; &#125; calcArea() &#123; return this.height * this.width; &#125;&#125;const square = new Polygon(10, 10);// 100console.log(square.area); åŸå‹é“¾12345678var Polygon = function(height, width)&#123; this.height = height; this.width = width;&#125;Polygon.prototype.calcArea = function() &#123; return this.height * this.width;&#125; ###ç±»çš„é™æ€æ–¹æ³•staticå…³é”®å­—ç”¨æ¥å®šä¹‰ç±»çš„é™æ€æ–¹æ³•ã€‚é™æ€æ–¹æ³•æ˜¯æŒ‡é‚£äº›ä¸éœ€è¦å¯¹ç±»è¿›è¡Œå®ä¾‹åŒ–)ï¼Œä½¿ç”¨ç±»åå°±å¯ä»¥ç›´æ¥è®¿é—®çš„æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é™æ€æ–¹æ³•ä¸èƒ½è¢«å®ä¾‹åŒ–çš„å¯¹è±¡è°ƒç”¨ã€‚é™æ€æ–¹æ³•ç»å¸¸ç”¨æ¥ä½œä¸ºå·¥å…·å‡½æ•°ã€‚ES6123456789101112131415161718class Point &#123; constructor(x, y) &#123; this.x = x; this.y = y; &#125; static distance(a, b) &#123; const dx = a.x - b.x; const dy = a.y - b.y; return Math.sqrt(dx*dx + dy*dy); &#125;&#125;const p1 = new Point(5, 5);const p2 = new Point(10, 10);console.log(Point.distance(p1, p2)); åŸå‹é“¾1234567891011var Point = function(x, y)&#123; this.x = x; this.y = y;&#125;Point.distance = function(a, b) &#123; const dx = a.x - b.x; const dy = a.y - b.y; return Math.sqrt(dx*dx + dy*dy);&#125; è‡³æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜ç™½äº†å¦‚ä½•ç”¨åŸå‹é“¾å»æ„å»ºä¸€ä¸ªç±» å…¶å®å½“æˆ‘ä»¬å»æŸ¥çœ‹babelå¯¹äºç±»çš„å®ç°ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„ 123456789101112131415161718var _createClass = function() &#123; function defineProperties(target, props) &#123; for (var i = 0; i &lt; props.length; i++) &#123; var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (&quot;value&quot; in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); &#125; &#125; return function(Constructor, protoProps, staticProps) &#123; //å®ä¾‹æ–¹æ³•ï¼ˆåŸå‹æ–¹æ³•ï¼‰çš„å®ç° if (protoProps) defineProperties(Constructor.prototype, protoProps); //é™æ€å‡½æ•°çš„å®ç° if (staticProps) defineProperties(Constructor, staticProps); return Constructor; &#125;;&#125;(); ###ç±»çš„ç»§æ‰¿ æœªå®Œ å‚è€ƒæ–‡æ¡£JavascriptåŸå‹é“¾MDN Classes","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"semver","date":"2017-01-27T07:17:50.000Z","path":"2017/01/27/semver/","text":"semverè§„åˆ™","tags":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://wangyuekai.com/tags/ç¼–ç¨‹/"}]},{"title":"node-js-best-practices-how-to-become-a-better-developer-in-2017","date":"2017-01-27T07:16:45.000Z","path":"2017/01/27/node-js-best-practices-how-to-become-a-better-developer-in-2017/","text":"ä¸€å¹´å‰ï¼Œæˆ‘ä»¬å†™äº†ä¸€ç¯‡æ–‡ç« How to Become a Better Node.js Developer in 2016 ï¼Œè¿™ç¯‡æ–‡ç« æˆåŠŸåœ°è·å–äº†ä¸é”™çš„åå“ï¼Œæ‰€ä»¥æˆ‘æƒ³ç°åœ¨æ˜¯æ—¶å€™å›é¡¾è¿™ä¸ªä¸»é¢˜ä¸º2017å¹´åšå‡†å¤‡äº†ã€‚ ###2017å¹´æœ€å¥½çš„Node.jså®è·µ ä½¿ç”¨ES2015å»å¹´æˆ‘ä»¬å»ºè®®äº†ä½ ä½¿ç”¨ES2015ï¼Œå½“å‰ç°åœ¨çš„æƒ…å†µå·²ç»å¤§æœ‰ä¸åŒäº† å›åˆ°é‚£ä¸ªæ—¶å€™ï¼ŒNode.js v4æ˜¯å½“æ—¶çš„ç¨³å®šç‰ˆæœ¬(LTS)ï¼Œæ”¯æŒäº†ES2015ä¸­57%çš„åŠŸèƒ½ã€‚ä¸€å¹´è¿‡å»äº†ï¼Œç°åœ¨Node v6å·²ç»å¢é•¿åˆ°æ”¯æŒES2015ä¸­99%çš„åŠŸèƒ½äº†ã€‚ å¦‚æœä½ ç°åœ¨åœ¨ä½¿ç”¨æœ€æ–°çš„LTS Node.jsç‰ˆæœ¬ï¼Œä½ ç”šè‡³å¯ä»¥ä¸å†éœ€è¦babelå°±å¯ä»¥ä½¿ç”¨æ‰€æœ‰ES2015çš„ç‰¹æ€§ã€‚ä½†æ˜¯å³ä½¿å¦‚æ­¤ï¼Œåœ¨æµè§ˆå™¨ç«¯ä½ å¯èƒ½è¿˜æ˜¯éœ€è¦babelã€‚ å¦‚æœä½ éœ€è¦å…³äºNode.jsç‰ˆæœ¬å¯¹äºES2015æ”¯æŒæƒ…å†µçš„æ›´å¤šçš„ä¿¡æ¯ï¼Œæˆ‘æ¨èä½ å¯ä»¥æŸ¥è¯¢node.green ####ä½¿ç”¨Promises åœ¨80å¹´ä»£ç¬¬ä¸€æ¬¡æå‡ºPromisesçš„æ¦‚å¿µã€‚ç°åœ¨å¤šæ•°ç°ä»£ç¼–ç¨‹è¯­è¨€å·²ç»æ”¯æŒè¿™ä¸€ç‰¹æ€§äº†ï¼Œä½¿æˆ‘ä»¬çš„ç¼–ç å˜å¾—æ›´åŠ ç®€å•ã€‚ æƒ³è±¡ä¸€ä¸ªå¦‚ä¸‹çš„åŠŸèƒ½ï¼Œå®ƒéœ€è¦è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åè§£æå®ƒï¼Œç„¶åæ‰“å°å‡ºå…¶ä¸­çš„nameå­—æ®µã€‚å¦‚æœä½¿ç”¨å›è°ƒï¼Œå®ƒå¯èƒ½æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼š 123456789101112fs.readFile(&apos;./package.json&apos;, &apos;utf-8&apos;, function (err, data) &#123; if (err) &#123; return console.log(err) &#125; try &#123; JSON.parse(data) &#125; catch (ex) &#123; return console.log(ex) &#125; console.log(data.name)&#125;) Promiseså¯ä»¥ä½¿å¾—è¿™æ®µä»£ç å˜çš„æ›´åŠ æœ‰å¯è¯»æ€§ï¼š123456fs.readFileAsync(&apos;./package.json&apos;).then(JSON.parse).then((data) =&gt; &#123; console.log(data.name)&#125;).catch((e) =&gt; &#123; console.error(&apos;error reading/parsing file&apos;, e)&#125;) å½“å‰ï¼Œç°åœ¨çš„fsçš„å¹¶æ²¡æœ‰ä¸€ä¸ªè¿”å›ä¸€ä¸ªPromiseçš„readFileAsyncapiã€‚ä¸ºäº†åšåˆ°è¿™ä¸ªï¼Œæˆ‘ä»¬ä½¿ç”¨å¯ä»¥ä¸€ä¸ªç±»ä¼¼promisifyAllçš„æ¨¡å—ã€‚ ####ä½¿ç”¨æ ‡å‡†çš„JavaScriptæ ¼å¼ å½“æˆ‘ä»¬è°ˆåˆ°ä»£ç é£æ ¼çš„æ—¶å€™ï¼Œä¸€ä¸ªå…¬å¸æœ‰ç»Ÿä¸€çš„ä»£ç é£æ ¼æ˜¯è‡³å…³é‡è¦çš„ã€‚åªæœ‰è¿™æ ·ï¼Œå½“ä½ éœ€è¦æ”¹å˜ä½ çš„é¡¹ç›®çš„æ—¶å€™ï¼Œä½ æ‰å¯ä»¥é«˜æ•ˆçš„ä»é›¶å¼€å§‹ï¼Œè€Œä¸ç”¨æ‹…å¿ƒåŸºç¡€çš„æ¶æ„ä¸ä¸€æ ·ã€‚ åœ¨RisingStackï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰çš„é¡¹ç›®ä¸­éƒ½ä½¿ç”¨äº†JavaScript Standard Styleã€‚ ä½¿ç”¨ Standardåï¼Œåœ¨ä½ å®‰è£…ä¹‹åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½ ä¸éœ€è¦å†åšå…¶ä»–çš„äº‹æƒ…ï¼Œä¹Ÿä¸éœ€è¦ç®¡ç†.eslintrc, .jshintrc, æˆ–è€… .jscsrcæ–‡ä»¶ã€‚å…·ä½“çš„Standardçš„è§„åˆ™å¯ä»¥æŸ¥çœ‹Standard rulesã€‚ ###ä½¿ç”¨dockerâ€”å®¹å™¨å°†åœ¨2017å¹´è¢«å¤§é‡ä½¿ç”¨åœ¨ç”Ÿæˆç¯å¢ƒ ä½ å¯ä»¥æŠŠdockeré•œåƒå½“åšéƒ¨ç½²çš„å·¥å…·ã€‚dockerå®¹å™¨å¯ä»¥å°†ä¸€ä¸ªè½¯ä»¶æ‰“åŒ…åœ¨ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå®¹å™¨å¯ä»¥åŒ…å«ä½ åœ¨æœåŠ¡å™¨ä¸Šéœ€è¦çš„ä¸€åˆ‡ï¼Œä¾‹å¦‚ä»£ç ï¼Œè¿è¡Œç¯å¢ƒï¼Œç³»ç»Ÿå·¥å…·ï¼Œç³»ç»Ÿç¨‹åºåº“ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å¼€å§‹ä½¿ç”¨å®¹å™¨å‘¢? å®¹å™¨å¯ä»¥ä½¿ä½ çš„åº”ç”¨è¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒä¸­ ä½œä¸ºä¸€ä¸ªå®‰å…¨å·¥å…·ï¼Œå¯ä»¥ä½¿ä½ çš„ä»£ç æ›´åŠ çš„å®‰å…¨ è½»é‡çº§çš„dockeré•œåƒ ä½¿å¾—ä½ çš„éƒ¨ç½²å˜å¾—ç¨³å®š ä½ å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œæ¨¡æ‹Ÿçº¿ä¸Šçš„è¿è¡Œç¯å¢ƒ ä½ å¯ä»¥ä»official getting started tutorialå¼€å§‹å­¦ä¹ dockerã€‚å¦å¤–ä¹Ÿæ¨èKubernetes best practices ####ç›‘æ§ä½ çš„é¡¹ç›® å½“ä½ çš„åº”ç”¨å‘ç”Ÿé”™è¯¯çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªçŸ¥é“çš„äººä¸åº”è¯¥æ˜¯ç”¨æˆ·è€Œåº”è¯¥æ˜¯å¼€å‘è€…ã€‚ æœ€æ–°çš„ä¸€ä¸ªå¼€æºè§£å†³æ–¹æ¡ˆPrometheuså¯ä»¥å¸®åŠ©ä½ å®ç°é¡¹ç›®çš„ç›‘æ§ã€‚Prometheusæ˜¯ä¸€ä¸ªåŸºäºSoundCloudçš„å¼€æºå·¥å…·ç®±ï¼Œå®ƒå¯ä»¥ç›‘æ§ä½ çš„é¡¹ç›®å¹¶æŠ¥è­¦ã€‚Prometheuså”¯ä¸€çš„ç¼ºç‚¹æ˜¯ä½ éœ€è¦è®¾ç½®ä¸€äº›é…ç½®å¹¶ä¸”éœ€è¦éœ€è¦è‡ªå·±ç®¡ç†ã€‚ å¦‚æœä½ åœ¨å¯»æ‰¾ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±å¼€å‘çš„Trace by RisingStack Traceå¯ä»¥å¸®åŠ©ä½ åšåˆ°ä»¥ä¸‹çš„äº‹æƒ… æŠ¥è­¦ ç”Ÿäº§ç¯å¢ƒä¸‹çš„å†…å­˜å’Œcpuåˆ†æ åˆ†å¸ƒå¼è¿½è¸ªå’Œé”™è¯¯å¯»æ‰¾ æ€§èƒ½ç›‘æ§ ä¿æŠ¤ä½ çš„npmåŒ…çš„å®‰å…¨ ####åœ¨åå°è¿›ç¨‹ä¸­ä½¿ç”¨æ¶ˆæ¯æœåŠ¡ å¦‚æœä½ ä½¿ç”¨httpè¯·æ±‚å‘é€æ¶ˆæ¯ï¼Œå½“ä½ çš„æ¥æ”¶æœåŠ¡å™¨å®•æœºäº†ï¼Œä½ æ‰€æœ‰çš„æ¶ˆæ¯éƒ½ä¼šä¸¢å¤±ã€‚å¦‚æœä½ çš„ä¼ è¾“å±‚æ”¯æŒæŒä¹…åŒ–ï¼Œç±»ä¼¼ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥å‘é€æ¶ˆæ¯ï¼Œä½ å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚ ä½ çš„æ¥æ”¶æœåŠ¡å™¨å™¨å®•æœºäº†ï¼Œæ¶ˆæ¯å°†ä¼šè¢«ä¿å­˜ä¸‹æ¥ï¼Œåœ¨æœåŠ¡é‡å¯åä¼šç»§ç»­å‘é€ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨æœªå®•æœºä½†æ˜¯å‘é€äº†é”™è¯¯ï¼Œæ¶ˆæ¯ä¼šè¢«é‡æ–°å‘é€ä¸€æ¬¡ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä½ çš„æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šä½ éœ€è¦å‘é€æ•°åƒä»½é‚®ä»¶ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œä½ åªéœ€è¦è·å–åˆ°ä¸€äº›ç±»ä¼¼é‚®ä»¶åœ°å€å’Œç”¨æˆ·çš„å§“åç­‰åŸºç¡€ä¿¡æ¯ï¼Œåå°å°±å¯ä»¥å¾ˆè½»æ¾åœ°å°†è¿™äº›ä¿¡æ¯å’Œé‚®ä»¶ä¿¡æ¯æ•´åˆåå‘é€å‡ºå»ã€‚ è¿™ç§æ–¹å¼æœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥ä½ éœ€è¦çš„æ—¶å€™æ¨ªå‘æ‰©å±•ä½ çš„æœåŠ¡ï¼Œè€Œä¸ä¼šæœ‰é‚®ä»¶è¢«ä¸¢å¤±ã€‚å¦‚æœä½ éœ€è¦å‘é€æ•°ç™¾ä¸‡çš„é‚®ä»¶ï¼Œä½ å¯ä»¥ç”¨ç›¸åŒçš„æ–¹å¼æ¥å¢åŠ ä½ çš„æœåŠ¡ã€‚ å¯¹äºæ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©æœ‰å¾ˆå¤š RabbitMQ Kafka NSQ AWS SQS ####ä½¿ç”¨æœ€æ–°çš„LTSç‰ˆæœ¬çš„Node.js ä¸ºäº†å¹³è¡¡ç¨³å®šæ€§å’Œæ–°ç‰¹æ€§ï¼Œæˆ‘æ¨èä½ ä½¿ç”¨æœ€æ–°çš„LTSç‰ˆæœ¬çš„Node.jsã€‚å½“æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæœ€æ–°çš„LTSç‰ˆæœ¬æ˜¯6.9.2ã€‚ ä½ å¯ä»¥ä½¿ç”¨nvmæ¥åˆ‡æ¢ä½ çš„nodeç‰ˆæœ¬ï¼Œä½ åªéœ€è¦ä¸¤ä¸ªæŒ‡ä»¤å°±å¯ç®¡ç†å’Œåˆ‡æ¢ä½ çš„nodeç‰ˆæœ¬ 12nvm install 6.9.2nvm use 6.9.2 ####ä½¿ç”¨è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬ç®¡ç† å‡ ä¸ªæœˆå‰ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸€ä¸ªNode.jså¼€å‘è€…è°ƒæŸ¥ï¼Œæˆ‘ä»¬ä»ä¸­è·å–äº†å¼€å‘è€…å¯¹äºä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬çš„ä½¿ç”¨æƒ…å†µã€‚ ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°è°ƒæŸ¥è€…åªæœ‰71%çš„äººåœ¨ä»–ä»¬æäº¤å’Œä½¿ç”¨æ¨¡å—æ—¶ä½¿ç”¨è¯­ä¹‰åŒ–çš„ç‰ˆæœ¬ç®¡ç†ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªæ•°å­—åº”è¯¥è¦æ›´é«˜ - æ¯ä¸€ä¸ªéƒ½åº”è¯¥ä½¿ç”¨è¯­ä¹‰ç‰ˆæœ¬!ï¼Œå› ä¸ºä¸æ ¹æ®semverè§„åˆ™æ¥æäº¤packageï¼Œä¼šå¾ˆå®¹æ˜“æ‘§æ¯ä½ çš„Node.jsåº”ç”¨ã€‚ é€šè¿‡ç‰ˆæœ¬å·æ¥ç®¡ä½ çš„é¡¹ç›®æˆ–è€…æ¨¡å—æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½ çš„ç”¨æˆ·åº”è¯¥è¦çŸ¥é“ä¸€ä¸ªæ¨¡å—æ˜¯å¦æ›´æ–°äº†ï¼Œåœ¨ä½¿ç”¨æ–°ç‰ˆæœ¬å‰ä»–ä»¬è¦åšä»€ä¹ˆã€‚ è¿™å°±æ˜¯è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶çš„æ¥å†ã€‚ä¸€ä¸ªç‰ˆæœ¬å·åº”è¯¥è¦æœ‰ä¸»ç‰ˆæœ¬å·ã€å‰¯ç‰ˆæœ¬å·ã€è¡¥ä¸ç‰ˆæœ¬å·ï¼Œæ›´æ–°ä¸åŒä½ç½®çš„ç‰ˆæœ¬å·ä»£è¡¨ä¸åŒçš„æ„æ€ï¼š ä¸»ç‰ˆæœ¬å·:è¡¨ç¤ºæ›´æ–°ä¼šæœ‰ä¸å…¼å®¹çš„API å‰¯ç‰ˆæœ¬å·:è¡¨ç¤ºæ›´æ–°ä¼šæœ‰æ–°çš„åŠŸèƒ½ï¼ˆä¸ç ´åç°æœ‰çš„apiï¼‰ è¡¥ä¸ç‰ˆæœ¬å·:è¡¨ç¤ºæ›´æ–°æ˜¯æ¨¡å—åšäº†å‘åå…¼å®¹çš„bugä¿®å¤ npmæ˜¯æ ¹æ®semverè§„åˆ™æ¥å®‰è£…ä¾èµ–çš„ï¼Œå› æ­¤å½“ä½ å‘å¸ƒä¸€ä¸ªæ¨¡å—ä¹‹å‰ï¼Œè¯·ç¡®è®¤æ˜¯å¦éµå¾ªäº†semverè§„åˆ™ï¼Œå¦åˆ™ä½ ä¼šç ´åäº†å…¶ä»–ä½¿ç”¨äº†ä½ çš„ä¾èµ–çš„åº”ç”¨ã€‚ ####ä¿è¯ä½ çš„åº”ç”¨å®‰å…¨ ä¿è¯ä½ çš„ç”¨æˆ·æ•°æ®çš„å®‰å…¨å°†æ˜¯ä½ 2017å¹´çš„å¤´ç­‰å¤§äº‹ã€‚ä»…åœ¨2016å¹´ä¸€å¹´ï¼Œå› ä¸ºç¼ºå°‘ä¸€äº›å®‰å…¨çš„æªæ–½å°±æœ‰æ•°ç™¾ä¸‡çš„ç”¨æˆ·è´¦æˆ·è¢«æ³„æ¼ã€‚ ä½ å¯ä»¥é€šè¿‡é˜…è¯»æˆ‘ä»¬çš„åšå®¢Node.js Security Checklistæ¥å…¥é—¨Node.jsçš„å®‰å…¨ï¼Œåšå®¢é‡ŒåŒ…å«äº†ä»¥ä¸‹çš„è¯é¢˜ï¼š å®‰å…¨çš„HTTP Headers å¼ºåˆ¶ä¿æŠ¤ Sessionç®¡ç† ä¸å®‰å…¨çš„ä¾èµ– æ•°æ®éªŒè¯ å½“ä½ æŒæ¡äº†è¿™äº›åŸºç¡€ï¼Œä½ å¯ä»¥æ¥è§‚çœ‹æˆ‘å…³äºNodeçš„äº’åŠ¨è®¨è®ºSurviving Web Security with Node.js å­¦ä¹ ServerlessServerless started with the introduction of AWS Lambda. Since then it is growing fast, with a blooming open-source community.In the next years, serverless will become a major factor for building new applications. If youâ€™d like to stay on the edge, you should start learning it today.One of the most popular solutions is the , which helps in deploying AWS Lambda functions. Serverlessæ˜¯AWS Lambdaç¬¬ä¸€ä¸ªæå‡ºæ¥çš„ï¼Œä¹‹åå®ƒå‘å±•çš„å¾ˆå¿«ï¼Œå¹¶å»ºç«‹äº†ä¸€ä¸ªå¼€æºçš„ç¤¾åŒºã€‚ æ¥ä¸‹æ¥çš„ä¸€å¹´ï¼Œæ„å»ºæ–°åº”ç”¨æ—¶serverlessä¼šæˆä¸ºä¸€ä¸ªæ ‡å‡†ã€‚å¦‚æœä½ æƒ³è¦ç•™åœ¨è¿™ä¸ªé¢†åŸŸï¼Œä½ éœ€è¦é‡ç°åœ¨å¼€å§‹å°±å­¦ä¹ å®ƒã€‚ Serverless Frameworkæ˜¯å½“å‰æœ€æµè¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œåœ¨éƒ¨ç½²AWS Lambda functionså¯ä»¥å¸®åŠ©ä½ ã€‚ ####å‚åŠ ä¼šè®®ä¸èšä¼šå¹¶å‘è¨€ å‚åŠ ä¼šè®®å’Œèšä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½åœ°æ–¹å¼å»äº†è§£å’Œå­¦ä¹ æ–°çš„è¶‹åŠ¿ï¼Œå¼€å‘æŠ€å·§å’Œæœ€ä½³å®è·µã€‚å½“æ—¥ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªåœºåˆå»è®¤è¯†æ›´å¤šæ–°çš„äººã€‚ To take it one step forward, Iâ€™d like to encourage you to speak at one of these events as well!As public speaking is tough, and â€œimagine everyoneâ€™s nakedâ€ is the worst advice, Iâ€™d recommend checking out speaking.io for tips on public speaking! åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä¹Ÿé¼“åŠ±ä½ åœ¨ä¸€äº›ä¼šè®®ä¸Šå‘è¨€ã€‚ åœ¨å…¬å…±åœºåˆå‘è¨€æ˜¯ä¸€ä¸ªä¸å®¹æ˜“çš„äº‹æƒ…ï¼Œâ€œimagine everyoneâ€™s nakedâ€æ˜¯æœ€åçš„å»ºè®®ã€‚æˆ‘å»ºè®®ä½ å¯ä»¥å»speaking.ioå­¦ä¹ ä¸€äº›æŠ€å·§ã€‚ ####Become a better Node.js developer in 2017 åŸæ–‡é“¾æ¥","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"Closures","date":"2017-01-27T07:16:02.000Z","path":"2017/01/27/Closures/","text":"Closures are functions that refer to independent (free) variables (variables that are used locally, but defined in an enclosing scope). In other words, these functions â€˜rememberâ€™ the environment in which they were created. â€” MDN çœ‹ä¸æ‡‚ä¸Šé¢çš„è‹±æ–‡è¿™ä¹ˆåŠï¼Œä¸‹é¢æ˜¯ä¸­æ–‡ç¿»è¯‘ é—­åŒ…æ˜¯æŒ‡é‚£äº›èƒ½å¤Ÿè®¿é—®ç‹¬ç«‹(è‡ªç”±)å˜é‡çš„å‡½æ•° (å˜é‡åœ¨æœ¬åœ°ä½¿ç”¨ï¼Œä½†å®šä¹‰åœ¨ä¸€ä¸ªå°é—­çš„ä½œç”¨åŸŸä¸­)ã€‚æ¢å¥è¯è¯´ï¼Œè¿™äº›å‡½æ•°å¯ä»¥â€œè®°å¿†â€å®ƒè¢«åˆ›å»ºæ—¶å€™çš„ç¯å¢ƒã€‚ å…³äºé—­åŒ…å·²ç»æœ‰å¾ˆå¤šå¾ˆå¤šçš„æ–‡ç« äº†ï¼Œæ–‡ç« çš„æœ€åä¼šæ”¾ä¸€äº›é“¾æ¥ï¼Œåœ¨è¿™é‡Œæˆ‘åªå†™ä»¥ä¸‹å‡ ç‚¹ é—­åŒ…çš„å®ç°æ˜¯å› ä¸ºJsä¸­æœ‰å‡½æ•°ä½œç”¨åŸŸï¼Œå˜é‡æŸ¥è¯¢æ˜¯ä¸€çº§ä¸€çº§æŸ¥è¯¢ä¸Šå»ï¼Œç›´åˆ°æ ¹ä½œç”¨åŸŸä¹Ÿå°±æ˜¯è¯´åœ¨ä»»ä½•ä¸€çº§çš„ä½œç”¨åŸŸä¸­éƒ½å¯ä»¥è®¿é—®ä¹‹å‰æ‰€æœ‰ä½œç”¨åŸŸè¿çš„å˜é‡ï¼ŒåŒæ—¶å†…å­˜å›æ”¶æœºåˆ¶æ˜¯ä¸ä¼šå›æ”¶è¿˜è¢«å¼•ç”¨çš„å˜é‡ã€‚ é—­åŒ…ä¸æ˜¯å®ç°Jsç±»çš„åŸºç¡€ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡é—­åŒ…å®ç°ç±»çš„ç§æœ‰å˜é‡å’Œç§æœ‰å‡½æ•° é—­åŒ…çš„æ€§èƒ½å¾ˆå·®ï¼Œæœ‰æ—¶å€™å¯ä»¥ç»‘å®šåœ¨prototypeä¸­ï¼ˆåªå¯ä»¥è®¿é—®thisä¸‹çš„å˜é‡ï¼‰ 123456789101112131415161718//åœ¨è¿™ä¸ªä¾‹å­ä¸­firstNameå’ŒLastNameä¸æƒ³ç›´æ¥è¢«å¤–ç•Œè®¿é—®ï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨é—­åŒ…ä½¿å¤–ç•Œè·å–åˆ°å€¼ï¼Œ//åŒæ—¶å‡½æ•°å°½é‡ç»‘å®šåœ¨prototypeä¸Šï¼Œæ‰€ä»¥getFullNameç»‘å®šåœ¨prototypeä¸Šï¼Œ//æ‰€ä»¥æˆ‘ä¸ªäººè®¤ä¸ºåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œä¸€äº›ç”¨äºè®¿é—®ç§æœ‰å˜é‡çš„åŸºç¡€å‡½æ•°å¯ä»¥ä½¿ç”¨é—­åŒ…ï¼Œ//å¤§å¤šæ•°ç±»å‡½æ•°å¯ä»¥ç»‘å®šåœ¨prototypeä¸­ï¼Œé€šè¿‡å¯ä»¥è®¿é—®ç§æœ‰å˜é‡çš„åŸºç¡€å‡½æ•°æ¥å®ç°è®¿é—®ç§æœ‰å˜é‡var Man = function()&#123; var firstName = &apos;wang&apos;; var LastName = &apos;yuekai&apos;; this.getFirstName = function()&#123; return firstName; &#125; this.getLastName = function()&#123; return LastName; &#125;&#125;Man.prototype.getFullName = function()&#123; return this.getFirstName() + this.getLastName()&#125; å…¶ä»–æ–‡çŒ®å­¦ä¹ Javascripté—­åŒ…ï¼ˆClosureï¼‰é—­åŒ…","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"JavascriptåŸå‹é“¾","date":"2017-01-27T07:15:21.000Z","path":"2017/01/27/prototype-chain/","text":"åŸå‹é“¾çš„ç»§æ‰¿å°±æ˜¯å°†å­ç±»çš„prototype.__proto__é“¾æ¥åˆ°çˆ¶ç±»çš„prototypeï¼Œå€Ÿæ­¤å®ŒæˆåŸå‹é“¾1child.prototype.__proto__.= parent.prototype å®ä¾‹åŒ–çš„å¯¹è±¡æ²¡æœ‰prototype,prototypeæ˜¯å‡½æ•°ç‰¹æœ‰çš„å±æ€§ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰__proto__, è¿™æ˜¯æŒ‡å‘å®ä¾‹åŒ–è¿™ä¸ªå¯¹è±¡çš„ç±»çš„prototype,æ‰€æœ‰å¯¹è±¡çš„åŸå‹é“¾æœ€åæ˜¯null ä¸‹é¢æ˜¯ç»å…¸çš„åŸå‹é“¾ç»§æ‰¿çš„ä¾‹å­ï¼Œæˆ‘å€Ÿæ­¤è§£é‡Šä¸€ä¸‹12345678910111213141516171819 function extend(Child, Parent) &#123; var F = function()&#123;&#125;; //å°†çˆ¶ç±»çš„prototypeå¤åˆ¶åˆ°Få‡½æ•°ä¸­ F.prototype = Parent.prototype; /*new F()å®ä¾‹åŒ–F()å®é™…çš„ä½œç”¨æ˜¯ç”Ÿæˆäº†ä¸€ä¸ªä¸‹é¢è¿™ä¸ªå¯¹è±¡ &#123; __proto__: &#123; //Parent.prototype &#125; &#125; è¿™æ ·å°±å®Œæˆäº† Child.prototype.__proto__ = Parent.prototypeè¿™ä¸ªåŸå‹é“¾ç»§æ‰¿çš„æ ¸å¿ƒå†…å®¹ */ Child.prototype = new F(); //Parent.prototypeçš„constructoræ˜¯Parentï¼Œä¸ºäº†å‡†ç¡®è¿™é‡Œè¦æ‰‹åŠ¨å°†Child.prototype.constructoræ”¹ä¸ºChild Child.prototype.constructor = Child; //è¿™é‡Œæ˜¯ä¸ºäº†ä»£ç å®é™…å¼€å‘æ—¶æ–¹ä¾¿è°ƒç”¨çˆ¶ç±»ï¼Œä¸ç”¨ä½¿ç”¨__proto__ Child.uber = Parent.prototype; &#125; æ¶‰åŠåˆ°ç»§æ‰¿è¿™ä¸€å—ï¼ŒJavascript åªæœ‰ä¸€ç§ç»“æ„ï¼Œé‚£å°±æ˜¯ï¼šå¯¹è±¡ã€‚åœ¨ javaScript ä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘å®ƒçš„åŸå‹ï¼ˆprototypeï¼‰å¯¹è±¡çš„å†…éƒ¨é“¾æ¥ã€‚è¿™ä¸ªåŸå‹å¯¹è±¡åˆæœ‰è‡ªå·±çš„åŸå‹ï¼Œç›´åˆ°æŸä¸ªå¯¹è±¡çš„åŸå‹ä¸º null ä¸ºæ­¢ï¼ˆä¹Ÿå°±æ˜¯ä¸å†æœ‰åŸå‹æŒ‡å‘ï¼‰ï¼Œç»„æˆè¿™æ¡é“¾çš„æœ€åä¸€ç¯ã€‚è¿™ç§ä¸€çº§ä¸€çº§çš„é“¾ç»“æ„å°±ç§°ä¸ºåŸå‹é“¾ï¼ˆprototype chainï¼‰ã€‚â€”MDNåŸå‹é“¾æè¿° ä¸Šé¢è¿™å¥è¯æœ‰äº›é•¿ï¼Œçœ‹ä»£ç è·å–ä¼šç›´è§‚ä¸€ç‚¹ 12345childClass.prototype.__proto__ == parantClass.prototypechildInstance.__proto__ == childClass.prototypechildInstance.__proto__.__proto__ == childClass.prototype.prototype == parantClass.prototype å¯¹äºè¿™é‡Œçš„childInstance.__proto__ == childClass.prototypeï¼Œæ˜¯ç”±å…³é”®å­—newå®ç°çš„ï¼Œå…·ä½“å¯ä»¥çœ‹æˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç« newåˆ°åº•åšäº†ä»€ä¹ˆ å‚è€ƒæ–‡çŒ®Javascriptç»§æ‰¿æœºåˆ¶çš„è®¾è®¡æ€æƒ³Javascripté¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆäºŒï¼‰ï¼šæ„é€ å‡½æ•°çš„ç»§æ‰¿ç»§æ‰¿ä¸åŸå‹é“¾","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"Javascript ä»£ç ä¼˜åŒ–","date":"2017-01-27T07:13:35.000Z","path":"2017/01/27/optimizing-javascript/","text":"å®¢æˆ·ç«¯çš„è„šæœ¬å¯ä»¥ä½¿ä½ çš„åº”ç”¨å˜å¾—åŠ¨æ€å’Œç”ŸåŠ¨ï¼Œä½†æ˜¯æµè§ˆå™¨å¯¹äºJavaScriptçš„è§£é‡Šå¯èƒ½ä¼šå¯¼è‡´æ•ˆç‡çš„åº•ä¸‹ï¼Œè€Œä¸”éšç€å®¢æˆ·ç«¯æœ¬èº«çš„ä¸åŒä¹Ÿä¼šå¯¼è‡´æ€§èƒ½çš„ä¸åŒã€‚æˆ‘ä»¬æ•´ç†äº†ä¸€äº›å»ºè®®å’Œæœ€å¥½çš„å®è·µæ¥ä¼˜åŒ–ä½ çš„Javascript ä»£ç ã€‚ ###å®šä¹‰classçš„æ–¹æ³• ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯ä½æ•ˆçš„ï¼Œæ¯ä¸€æ¬¡å®ä¾‹åŒ–baz.Barï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°fooçš„é—­åŒ…å‡½æ•°ã€‚ 123456baz.Bar = function() &#123; // constructor body this.foo = function() &#123; // method body &#125;;&#125; æ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯ 1234567baz.Bar = function() &#123; // constructor body&#125;;baz.Bar.prototype.foo = function() &#123; // method body&#125;; è¿™ç§æ–¹å¼ï¼Œæ— è®ºåˆ›å»ºå¤šå°‘ä¸ªbaz.Barçš„ç¤ºä¾‹ï¼Œéƒ½åªä¼šåˆ›å»ºä¸€ä¸ªfooå‡½æ•°ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰é—­åŒ…å‡½æ•°äº§ç”Ÿã€‚ ###åˆå§‹åŒ–å®ä¾‹å˜é‡Place instance variable declaration/initialization on the prototype for instance variables with value type (rather than reference type) initialization values (i.e. values of type number, Boolean, null, undefined, or string).è¿™ä¸ªå¯ä»¥é¿å…æ¯æ¬¡æ„å»ºå‡½æ•°è¢«è°ƒç”¨æ—¶ä¸å¿…è¦åœ°æ¯æ¬¡éƒ½è¿è¡Œåˆå§‹åŒ–ä»£ç ï¼ˆä½†æ˜¯å¦‚æœä½ çš„å®ä¾‹å˜é‡æ˜¯ä¾èµ–äºæ„å»ºå‡½æ•°çš„ä¼ å…¥å‚æ•°ï¼Œæˆ–è€…ä¾èµ–äºæ„å»ºæ—¶çš„ä¸€äº›çŠ¶æ€åˆ™ä¸é€‚ç”¨äºè¯¥å»ºè®®ï¼‰ ä¾‹å­ 123456foo.Bar = function() &#123; this.prop1_ = 4; this.prop2_ = true; this.prop3_ = []; this.prop4_ = &apos;blah&apos;;&#125;; åº”è¯¥æ”¹ä¸ºä¸‹é¢è¿™ç§å½¢å¼ 123456789foo.Bar = function() &#123; this.prop3_ = [];&#125;;foo.Bar.prototype.prop1_ = 4;foo.Bar.prototype.prop2_ = true;foo.Bar.prototype.prop4_ = &apos;blah&apos;; ###é¿å…è½å…¥é—­åŒ…çš„é™·è¿› é—­åŒ…æ˜¯Javascriptä¸­ä¸€ä¸ªå¾ˆå¼ºå¤§ä¹Ÿå¾ˆæœ‰ç”¨çš„ä¸€ä¸ªç‰¹æ€§ï¼›åŒæ—¶ï¼Œå®ƒä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼š é—­åŒ…æ˜¯æœ€å¸¸è§çš„å¯¼è‡´å†…å­˜æ³„æ¼çš„åŸå›  åˆ›å»ºä¸€ä¸ªé—­åŒ…æ¯”èµ·ä¸ä½¿ç”¨é—­åŒ…æ¥åˆ›å»ºä¸€ä¸ªå†…åœ¨çš„å‡½æ•°æ¥è¯´æ…¢å¾—å¤šï¼Œå’Œé‡ç”¨ä¸€ä¸ªé™æ€çš„å‡½æ•°æ¥æ¯”è¦æ›´åŠ æ…¢ã€‚å¦‚ä¸‹ä¾‹å­ 1234function setupAlertTimeout() &#123; var msg = &apos;Message to alert&apos;; window.setTimeout(function() &#123; alert(msg); &#125;, 100);&#125; è¾ƒå¿«çš„ï¼š123456function setupAlertTimeout() &#123; window.setTimeout(function() &#123; var msg = &apos;Message to alert&apos;; alert(msg); &#125;, 100);&#125; æ›´å¿«çš„12345678function alertMsg() &#123; var msg = &apos;Message to alert&apos;; alert(msg);&#125;function setupAlertTimeout() &#123; window.setTimeout(alertMsg, 100);&#125; é—­åŒ…ä¼šå¢åŠ ä½œç”¨åŸŸçš„é•¿åº¦ã€‚å½“æµè§ˆå™¨è§£æå±æ€§çš„æ—¶å€™ï¼Œä½œç”¨åŸŸçš„æ¯ä¸€çº§éƒ½å¿…é¡»è¢«æŸ¥è¯¢ã€‚å¦‚ä¸‹ä¾‹å­ 1234567891011121314var a = &apos;a&apos;;function createFunctionWithClosure() &#123; var b = &apos;b&apos;; return function () &#123; var c = &apos;c&apos;; a; b; c; &#125;;&#125;var f = createFunctionWithClosure();f(); å½“fè¢«æ‰§è¡Œï¼Œå¼•ç”¨cå¿«äºb,å¿«äºaã€‚åœ¨ieä¸­ä½¿ç”¨é—­åŒ…çš„ä¿¡æ¯å¯ä»¥æµè§ˆIE+JScript Performance Recommendations Part 3: JavaScript Code inefficiencies ###é¿å…ä½¿ç”¨withåœ¨ä½ çš„ä»£ç ä¸­è¦é¿å…è§†åŒwithã€‚å®ƒçš„æ€§èƒ½å¾ˆå·®ï¼Œå› ä¸ºå®ƒä¼šä¿®æ”¹ä½œç”¨åŸŸé“¾ï¼Œä½¿å¾—å…¶ä»–çš„ä½œç”¨åŸŸè¿ä¸­æŸ¥æ‰¾å˜é‡å˜å¾—å›°éš¾ã€‚ç½‘ç«™åº”ç”¨ä¸­æœ€å¸¸è§çš„å†…å­˜æ³„æ¼æ˜¯å› ä¸ºJavaScriptè„šæœ¬å¼•æ“å’Œæµè§ˆå™¨çš„C ++å¯¹è±¡å®ç°DOMä¸€ä»¶çš„å¾ªç¯å¼•ç”¨ï¼ˆä¾‹å¦‚ï¼šbetween the JavaScript script engine and Internet Explorerâ€™s COM infrastructure, or between the JavaScript engine and Firefox XPCOM infrastructureï¼‰ ###é¿å…æµè§ˆå™¨å†…å­˜æ³„æ¼ åœ¨webåº”ç”¨ä¸­å†…å­˜æ³„æ¼æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜ï¼Œå®ƒä¼šå¯¼è‡´å·¨å¤§çš„æ€§èƒ½é—®é¢˜ã€‚å½“ä½ çš„ç½‘ç«™åº”ç”¨å¯¼è‡´æµè§ˆå™¨ä½¿ç”¨çš„çš„å†…å­˜å¢åŠ ï¼Œä¼šå½±å“åˆ°ç”¨æˆ·çš„ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†å˜å¾—ç¼“æ…¢ã€‚ è¿™é‡Œæœ‰ä¸€äº›ç»éªŒçš„æ³•åˆ™æ¥é¿å…å†…å­˜æ³„æ¼ï¼š æŠŠäº‹ä»¶å¤„ç†ç»‘å®šåœ¨äº‹ä»¶ç®¡ç†ç³»ç»Ÿä¸Š æœ€å¸¸è§çš„å¾ªç¯å¼•ç”¨ç±»å‹å°±æ˜¯ [ DOM element â€“&gt; event handler â€“&gt; closure scope â€“&gt; DOM ]ï¼Œä¸ºäº†é¿å…è¿™ç§é—®é¢˜ï¼Œåº”è¯¥é€‰æ‹©ä¸€ä¸ªç»è¿‡è‰¯å¥½æµ‹è¯•çš„äº‹ä»¶ç®¡ç†ç³»ç»Ÿæ¥ç»‘å®šäº‹ä»¶å¤„ç†ï¼Œä¾‹å¦‚Google doctypeï¼ŒDojoæˆ–è€…Jqueryã€‚ æœªå®Œ åŸæ–‡é“¾æ¥â€œ","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"About this and prototype","date":"2017-01-27T07:12:03.000Z","path":"2017/01/27/About-this-and-prototype/","text":"å¯¹äºjsä¸­thisåˆ›å»ºçš„å¯¹è±¡ï¼Œç›¸å½“äºæ”¹å˜äº†è‡ªèº«çš„å­—é¢é‡ï¼Œè€Œæœ¬èº«æœ‰ä¸€ä¸ªè‡ªå¸¦çš„å±æ€§ä¸ºprototypeï¼Œè¿™ä¸ªä¸å±äºå­—é¢é‡çš„å†…å®¹123456789101112131415function Person () &#123; this.name = &quot;wang&quot;; this.age = 15;&#125;Person.prototype.name = &apos;lala&apos;;var john = new Person();console.log(JSON.stringify(john));//&#123;name:&quot;wang&quot;, age:15&#125;//è¿™é‡Œè¯´æ˜äº†thisç­‰åŒäºçš„æ˜¯å¯¹è±¡å­—é¢é‡console.log(john.name) //â€œwangâ€ï¼Œè¿™é‡Œè¯´æ˜äº†ï¼Œjsä¼šä¼˜å…ˆå¯»æ‰¾å­—é¢é‡é‡Œé¢æ˜¯å¦æœ‰è¿™ä¸ªå¯¹è±¡ï¼Œå…¶æ¬¡æ‰ä¼šå»prototypeé‡Œé¢å¯»æ‰¾ å¯¹è±¡çš„æ ·å­å¦‚ä¸‹12345678&#123; name:&apos;wang&apos;, age: 15, prototype:&#123; constructor:[Function], name: &apos;lala&apos; &#125;&#125;","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"}]},{"title":"require()","date":"2017-01-26T07:05:17.000Z","path":"2017/01/26/require/","text":"1module = new Module() //module ä¸º Moduleç±»çš„å®ä¾‹ 12345678var Module = function(id, parent) &#123; this.id = id; this.exports = &#123;&#125;; this.parent = parent; this.filename = null; this.loaded = false; this.children = [];&#125; 123var require = function()&#123; return module.exports&#125; æ¨¡å—çš„åŠ è½½å®è´¨ä¸Šå°±æ˜¯ï¼Œæ³¨å…¥exportsã€requireã€moduleä¸‰ä¸ªå…¨å±€å˜é‡ï¼Œç„¶åæ‰§è¡Œæ¨¡å—çš„æºç ï¼Œç„¶åå°†æ¨¡å—çš„ exports å˜é‡çš„å€¼è¾“å‡ºã€‚â€”â€” require() æºç è§£è¯» æ‰€ä»¥è¯´æ¯ä¸€ä¸ªrequireçš„æ–‡ä»¶æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œéƒ½æ˜¯å…ˆè¯»å–æ–‡ä»¶ï¼Œæ³¨å…¥å˜é‡ï¼Œå†æ‰§è¡Œä»£ç ï¼Œæ‰€ä»¥nodeæ–‡ä»¶ä¸éœ€è¦è‡ªå·±å®ä¾‹åŒ–Module,åœ¨requireçš„æ—¶å€™ä¼šè‡ªåŠ¨å®ä¾‹åŒ–çš„ï¼Œæ‰€ä»¥ä»å¦ä¸€ä¸ªè§’åº¦è¯´ï¼Œæ–‡ä»¶å¹¶ä¸ä¼šç›´æ¥æ‰§è¡Œï¼Œæ‰€ä»¥çœ‹ä¸Šå»æ–‡ä»¶ä¸­çš„requireï¼Œmoduleç­‰å˜é‡éƒ½ä¸ºåˆ›å»ºè€Œå¯ä»¥æ‰§è¡Œã€‚1234567891011121314151617//a.jsexports.multiply = function(n) &#123; return n * 1000 &#125;;//index.jsrequire(&apos;./a.js&apos;)//require(&apos;./a.js&apos;)å®é™…çš„å˜ä¸ºäº† var module = &#123; exports: &#123;&#125; &#125;;(function(module, exports) &#123; exports.multiply = function(n) &#123; return n * 1000 &#125;; &#125;(module, module.exports)) return module.exports; ####Demo requireåŸç† è¯»å–jsæ–‡ä»¶å¹¶è¿è¡Œ","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"Node","slug":"Node","permalink":"http://wangyuekai.com/tags/Node/"}]},{"title":"use generator and co in mocha","date":"2017-01-25T07:05:17.000Z","path":"2017/01/25/use-generator-and-co-in-mocha/","text":"ä¸»è¦çš„ç‚¹åœ¨äºå½“ it() å‡½æ•°çš„å›è°ƒå‡½æ•°å¸¦æœ‰doneå‚æ•°ï¼Œmochaä¼šç­‰åˆ°å›è°ƒå‡½æ•°é‡Œé¢å‡º done æˆ–è€…æˆ–è€…è¶…æ—¶æ‰å®Œæˆä¸€æ¡æµ‹è¯•ã€‚åŒæ—¶å› ä¸ºæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æœ€å¤šæ‰§è¡Œ2000æ¯«ç§’ï¼Œæ‰€ä»¥è¦é¢å¯¹éœ€è¦å¾ˆé•¿æ—¶é—´çš„æµ‹è¯•ï¼Œéœ€è¦é€šè¿‡è®¾ç½® -t æ¥ä¿®æ”¹æœ€é•¿æ—¶é—´ï¼ˆæš‚æ—¶æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼‰1234it(&apos;option is empty&apos;, function(done) &#123; ... done()//ç»“æŸä¸€æ¡æµ‹è¯•&#125;); ä¾‹å­12345678910111213describe(&apos;runBash&apos;, function() &#123; it(&apos;option is Sync&apos;, function(done) &#123; var instructionList = [&apos;echo &quot;one&quot;&apos;, &apos;echo &quot;two&quot;&apos;]; var option = &#123; webRoot: &apos;../fake-natoo&apos; &#125;; co(function*(done) &#123; var errCode = yield runBash(instructionList, option); expect(errCode).to.be.equal(null); done();//å®Œæˆæµ‹è¯• &#125;.call(this, done));//ä¼ å…¥done &#125;);&#125;); ps Mochaé»˜è®¤æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æœ€å¤šæ‰§è¡Œ2000æ¯«ç§’(å¯ä»¥é€šè¿‡-tæ¥è°ƒæ•´)Mochaé»˜è®¤ä¼šé«˜äº®æ˜¾ç¤ºè¶…è¿‡75æ¯«ç§’çš„æµ‹è¯•ç”¨ä¾‹ï¼ˆå¯ä»¥é€šè¿‡-sæ¥è°ƒæ•´ï¼‰&lt;&lt;æµ‹è¯•æ¡†æ¶ Mocha å®ä¾‹æ•™ç¨‹&gt;&gt;(é˜®ä¸€å³°)","tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://wangyuekai.com/tags/Javascript/"},{"name":"Test","slug":"Test","permalink":"http://wangyuekai.com/tags/Test/"}]}]